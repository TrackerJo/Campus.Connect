import{r as n,j as e,c as T,i as w}from"./index-BrfWEQze.js";import{B as k,C as S,D as E,E as F,F as I,e as D}from"./db-D_7SZOlL.js";import{n as O,o as R,L as G,G as M,p as U,q as p}from"./constants-BaAdZBoe.js";import{g as P}from"./distance-Dq5bV3Z3.js";function Q({addRehearsalLocation:d,close:x,dialogRef:a}){const[h,A]=n.useState(""),[m,c]=n.useState("#000000");return e.jsxs("dialog",{ref:a,children:[e.jsx("h2",{children:"Add Rehearsal Location"}),e.jsxs("div",{className:"location-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:h,onChange:r=>{A(r.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:m,onChange:r=>{c(r.target.value)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{d(O.fromBlank(h,R(m)))},children:"Add Rehearsal Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{x()},children:"Close"})]})]})}const C="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAgCAYAAADqgqNBAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAH6ADAAQAAAABAAAAIAAAAABT9vqhAAABMUlEQVRIDe2WO07DQBBAbSsFJE1OQEmgTUGJRDgAxyC5SAo6OAiKUkcK5Ax0IKUDpBSpSOnNG/CKkWVHsr3rRIpXevb6s/N2xlM4CI5hGGNO4BE+YAxRLXkjOoUZ6PHkXY4tgrRYNhF7Tz0Mw5gMn8GkMl2mrt1dklkbrmxE5iPJFmSsoW+fOT0TWMRz2MDABmd+DyvwLsbxO3443qgNdO3c6RmJzfhP+3+UDVw7lelgO8SyhW+41O87mx+q+GtfGYv4wll5dSACd+AFskYj1sWqNqe+Tal1k3lvrldtU/O9invVuihnddJceRl/8rwR59Su4O2jLLX8Vy8ga/hrLvkyGIdZVu75FSfytwx5LeLbHPF5wX4t/jriiZLLj94DnBWPVGIFoneYwh20SoQovWQLokOD66GvfLEAAAAASUVORK5CYII=";function V({addLocation:d,close:x,dialogRef:a,savedLocations:h}){const[A,m]=n.useState(""),[c,r]=n.useState(""),[i,f]=n.useState(void 0),[g,j]=n.useState(!1);return e.jsxs("dialog",{ref:a,children:[e.jsx("h2",{children:"Add Location"}),e.jsxs("div",{className:"location-info",children:[e.jsx("h3",{children:"Select from saved locations"}),e.jsxs("select",{name:"",id:"saved-locations",onChange:o=>{f(h.find(v=>v.name==o.target.value))},children:[e.jsx("option",{value:"",selected:!0,children:"Select a location"}),h.map((o,v)=>e.jsxs("option",{value:o.name,children:[o.name," (",o.address,")"]},v))]}),e.jsx("h3",{children:"Or add a new location"}),e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:A,onChange:o=>{m(o.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Address: "}),e.jsx("input",{type:"text",value:c,onChange:o=>{r(o.target.value)}}),e.jsx("br",{}),g?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(j(!0),(A==""||c=="")&&i==null){alert("Please fill out all fields"),j(!1);return}if(i){d(i);return}const o=await P(c);d(G.fromBlank(A,c,new M(o.lat,o.lon))),j(!1)},children:"Add Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{x()},children:"Close"})]})]})}function W({addEventType:d,close:x,dialogRef:a,eventTypes:h}){const[A,m]=n.useState(""),[c,r]=n.useState("#000000");return e.jsxs("dialog",{ref:a,children:[e.jsx("h2",{children:"Add Event Type"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:A,onChange:i=>{m(i.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:c,onChange:i=>{r(i.target.value)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{if(A==""){alert("Please fill out all fields");return}if(h.find(i=>i.name==A)){alert("Event type with that name already exists");return}d(U.fromBlank(A,R(c)))},children:"Add Event Type"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{x()},children:"Close"})]})]})}T(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Y,{})}));function Y(){const[d,x]=n.useState(""),[a,h]=n.useState(null),[A,m]=n.useState("student"),c=n.useRef(null),r=n.useRef(null),i=n.useRef(null),[f,g]=n.useState([]),[j,o]=n.useState([]),[v,y]=n.useState([]),[b,L]=n.useState(!0);return n.useEffect(()=>{async function t(){L(!0),w(()=>{});const l=new URLSearchParams(window.location.search).get("activityId");if(l){x(l);const B=await I();y(B)}const u=await D(l);u&&(h(u),u instanceof p&&g(u.rehearsalLocations),o(u.eventTypes));const N=localStorage.getItem("accountType");N&&m(N),L(!1)}t()},[]),e.jsx(e.Fragment,{children:b?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"title",children:[e.jsxs("h1",{children:["Activity: ",a==null?void 0:a.name]}),e.jsxs("h3",{children:["Join Code: ",a==null?void 0:a.joinCode]}),e.jsx("h2",{children:"Saved Locations"}),e.jsx("div",{className:"saved-locations",children:a==null?void 0:a.locations.map((t,s)=>(console.log(t),e.jsx("div",{className:"saved-location",children:e.jsxs("label",{htmlFor:"",className:"saved-location-name",children:[t.name," (",t.address,")"]})})))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var s;(s=r.current)==null||s.showModal()},children:"Add Location"}),a instanceof p&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Rehearsal Locations"}),e.jsx("div",{className:"rehearsal-locations",children:f.map((t,s)=>(console.log(t.color),e.jsxs("div",{className:"rehearsal-location",children:[e.jsx("label",{htmlFor:"",className:"rehearsal-location-name",children:t.name}),e.jsxs("div",{className:"rehearsal-location-right",children:[e.jsx("div",{className:"rehearsal-location-color",style:{backgroundColor:t.color.toRBGAString()}}),e.jsx("img",{src:C,alt:""})]})]})))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var s;(s=c.current)==null||s.showModal()},children:"Add Rehearsal Location"})," "]}),e.jsx("h2",{children:"Event Types"}),e.jsx("div",{className:"event-types",children:j.map((t,s)=>e.jsxs("div",{className:"event-type",children:[e.jsx("label",{htmlFor:"",className:"event-type-name",children:t.name}),e.jsxs("div",{className:"event-type-right",children:[e.jsx("div",{className:"event-type-color",style:{backgroundColor:t.color.toRBGAString()}}),e.jsx("img",{src:C,alt:""})]})]}))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var s;(s=i.current)==null||s.showModal()},children:"Add Event Type"}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Activity/?activityId="+d},children:"Back"})]}),e.jsx(Q,{dialogRef:c,addRehearsalLocation:async t=>{var s;if(a instanceof p){const l=[...a.rehearsalLocations];l.push(t),a.rehearsalLocations=l,console.log(l),g(l),await k(d,l),(s=c.current)==null||s.close()}},close:()=>{var t;(t=c.current)==null||t.close()}}),e.jsx(V,{dialogRef:r,close:()=>{var t;(t=r.current)==null||t.close()},addLocation:async function(t){var s,l;if(v.find(u=>u.name==t.name)){await S(d,t),(s=r.current)==null||s.close();return}await S(d,t),await E(t),y(u=>[...u,t]),(l=r.current)==null||l.close()},savedLocations:v.filter(t=>!a.locations.find(s=>t.name==s.name))}),e.jsx(W,{dialogRef:i,close:()=>{var t;(t=i.current)==null||t.close()},addEventType:async t=>{var l;const s=[...a.eventTypes];s.push(t),o(s),await F(d,t),(l=i.current)==null||l.close()},eventTypes:a.eventTypes})]})})}
