import{c as j,j as t,r as s,i as F}from"./index-C75OlIaX.js";import{i as E}from"./constants-BV3XiQhG.js";import{B as M,C as A}from"./db-eXCPZu_2.js";import{B as L,C as T}from"./Calendar-gTfWJb_b.js";j(document.getElementById("root")).render(t.jsx(s.StrictMode,{children:t.jsx(k,{})}));function k(){const[R,S]=s.useState("student"),[w,x]=s.useState([]),[I,D]=s.useState([]);s.useState(null);const[y,m]=s.useState(!1);return s.useEffect(()=>{F(()=>{});async function d(){m(!0);const l=await M(),v=[];console.log(l),x(l);const u=[];for(const e of l){const h=e instanceof E;let c=null;if(e instanceof E){const a=v.find(n=>n.activityId===e.activityId&&n.showId===e.showId);if(a)c=a;else{const n=await A(e.activityId,e.showId);n&&(v.push(n),c=n)}}console.log(e);const o=e.date.from;console.log(e.date.date),o.setDate(e.date.date.getDate()),o.setMonth(e.date.date.getMonth()),o.setFullYear(e.date.date.getFullYear());const r=e.date.to;r.setDate(e.date.date.getDate()),r.setMonth(e.date.date.getMonth()),r.setFullYear(e.date.date.getFullYear()),console.log(o),console.log(r);let f=!1,g=!1,p=null,C=null;if(console.log(c),c)for(const a of c.dates){const n=new Date(a.date);n.getDate()===o.getDate()&&n.getMonth()===o.getMonth()&&n.getFullYear()===o.getFullYear()&&(f=!0,a.canAttend&&(g=!0,p=new Date(a.from),C=new Date(a.to)))}u.push({title:e.name,start:o.toISOString(),end:r.toISOString(),isAllDay:!1,interactive:!0,description:e.info+(g?` 
(Excused from ${p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} to ${C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:f&&!g?` 
(Fully Excused)`:""),color:f&&!g?"black":f?"grey":h?e.rehearsalLocation.color.setAlpha(.8).toRBGAString():"blue",id:e.id,location:h?`${e.rehearsalLocation.name}`:""})}D(u),console.log(l),console.log(u),m(!1)}d();const i=localStorage.getItem("accountType");i&&S(i)},[]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:L,alt:"back arrow",onClick:()=>{window.location.href="/"}}),t.jsx("h1",{children:"Calendar"})]}),y?t.jsx("div",{className:"center",children:t.jsx("div",{className:"loader"})}):t.jsx("div",{className:"center",children:t.jsx(T,{viewEvent:d=>{},events:I,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventIdClick:d=>{const i=w.find(l=>l.id===d);i&&(localStorage.setItem("event",JSON.stringify(i.toMap())),localStorage.removeItem("back"),window.location.href="/Calendar/Event/")}})})]})}
