import{r as a,j as e,d as w,c as N,i as b}from"./index-U3pxML4x.js";import{a1 as A,i as I}from"./db-BIpCAzhs.js";import{S as L,L as P,G as k,i as R}from"./constants-CZ2ZrUdU.js";import{S as B}from"./Student_Display_Tile-Baz9R7gj.js";function T({close:o,created:d,dialogRef:m,activityId:f}){const[h,i]=a.useState(""),[c,u]=a.useState(""),[n,t]=a.useState(""),[s,x]=a.useState(""),[p,j]=a.useState(""),[S,r]=a.useState(!1);return e.jsx("dialog",{ref:m,children:e.jsxs("div",{className:"CreateCustomUserDialog",children:[e.jsx("h2",{children:"Create Student Account"}),e.jsx("input",{type:"text",placeholder:"Full Name",onChange:l=>{i(l.target.value)}}),e.jsx("input",{type:"text",placeholder:"Email",onChange:l=>{u(l.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:l=>{t(l.target.value)}}),e.jsx("input",{type:"text",placeholder:"Phone Number",onChange:l=>{x(l.target.value)}}),e.jsxs("select",{onChange:l=>{j(l.target.value)},children:[e.jsx("option",{value:"",selected:!0,children:"Select your Sex"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]}),S?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(r(!0),h==""){alert("Please enter your full name"),r(!1);return}if(c==""){alert("Please enter your email"),r(!1);return}if(!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(c)){alert("Invalid email"),r(!1);return}if(s==""){alert("Please enter your phone number, if you don't have one, type none"),r(!1);return}x(s.replace(/-/g,"")),x(s.replace(/ /g,"")),x(s.replace(/\(/g,"")),x(s.replace(/\)/g,""));const v=/^\d{10}$/;if(s!="none"&&!v.test(s)){alert("Invalid phone number (Only include numbers or type none)"),r(!1);return}if(n==""){alert("Please enter a password"),r(!1);return}if(n.length<6){alert("Password must be at least 6 characters"),r(!1);return}if(p==""){alert("Please select your sex"),r(!1);return}const y=localStorage.getItem("schoolId"),g=await w(c,n);if(g==""){r(!1);return}const C=L.fromBlank(g,y,"unknown",0,"","student",s,p,"unknown",h.toLowerCase().trim(),h.trim(),c.trim(),{},P.fromBlank("","",new k(0,0),!1));await A(C,f),d()},children:"Create Account"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{o()},children:"Close"})]})})}function E({students:o,activityId:d,isTeacher:m}){const[f,h]=a.useState(0),i=a.createRef(),[c,u]=a.useState(o);function n(t){if(t==""){u(o);return}u(o.filter(s=>s instanceof R?s.name.toLowerCase().includes(t.toLowerCase()):!1))}return a.useEffect(()=>{n("")},[o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"StudentListTile",children:[e.jsx("div",{className:"header",children:e.jsx("div",{className:"StudentListNameDiv",children:e.jsx("label",{htmlFor:"StudentList",children:"Students "})})}),e.jsx("br",{}),e.jsxs("div",{className:"students-section",children:[e.jsx("input",{type:"text",placeholder:"Search",className:"search",onChange:t=>{n(t.target.value)}}),e.jsx("div",{className:"students",id:"students-"+f,children:c.map((t,s)=>e.jsx(B,{activityId:d,student:t},s))})]}),m&&e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=i.current)==null||t.showModal()},children:"Create Student"})]}),e.jsx(T,{close:()=>{var t;(t=i.current)==null||t.close()},created:()=>{var t;(t=i.current)==null||t.close(),window.location.reload()},dialogRef:i,activityId:d})]})}N(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(F,{})}));function F(){const[o,d]=a.useState(""),[m,f]=a.useState(null),[h,i]=a.useState("student");a.useEffect(()=>{b(()=>{});const n=new URLSearchParams(window.location.search).get("activityId");n&&d(n),I(n).then(s=>{s&&f(s)});const t=localStorage.getItem("accountType");t&&i(t)},[]);function c(u){return u.sort((n,t)=>n.name.localeCompare(t.name))}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",children:e.jsx("h1",{children:"Members"})}),e.jsxs("div",{className:"center",children:[e.jsx(E,{activityId:o,students:m?c(m.students):[],isTeacher:h=="teacher"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Activity/?activityId="+o},children:"Back"})]})]})}
