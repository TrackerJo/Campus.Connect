import{r as t,j as e,c as j,i as g}from"./index-DUWJYJoQ.js";import{j as m,u as y,a as f,b as A,d as C}from"./db-Bth3z0iE.js";import"./constants-DQ2WKrIa.js";function p({dialogRef:r,close:d}){const[c,u]=t.useState(""),[s,o]=t.useState(!1),[n,l]=t.useState(!1),[i,v]=t.useState(""),[h,x]=t.useState("male");return e.jsx("dialog",{ref:r,className:"JoinActivityDialog",children:e.jsxs("div",{className:"dialogContents",children:[!n||!s?e.jsxs(e.Fragment,{children:[" ",e.jsx("h2",{children:"Join Activity"}),e.jsx("label",{htmlFor:"",children:"Activity Code"}),e.jsx("input",{type:"text",value:c,onChange:a=>{u(a.target.value)}}),e.jsx("button",{className:"ActionBtn",onClick:async()=>{console.log("Joining activity"),localStorage.setItem("needsPhoneNumber","false"),localStorage.setItem("needsGender","false");const a=await m(c);if(o(localStorage.getItem("needsPhoneNumber")=="true"),l(localStorage.getItem("needsGender")=="true"),!(localStorage.getItem("needsPhoneNumber")=="true"||localStorage.getItem("needsGender")=="true")){if(!a){alert("Invalid activity code");return}window.location.href=`/Campus.Connect/Activity/?activityId=${a.id}`}},children:"Join"})," "]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Activity requires some more information"}),s?e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"",children:"Phone Number"}),e.jsx("input",{type:"text",value:i,onChange:a=>{v(a.target.value)}}),e.jsx("br",{})]}):e.jsx(e.Fragment,{}),n?e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"",children:"Gender"}),e.jsxs("select",{name:"",id:"",value:h,onChange:a=>{x(a.target.value)},children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}):e.jsx(e.Fragment,{}),e.jsx("button",{className:"ActionBtn",onClick:async()=>{console.log("Joining activity"),s&&(await y(i),localStorage.setItem("needsPhoneNumber","false")),n&&(await f(h),localStorage.setItem("needsGender","false"));const a=await m(c);if(!a){alert("Invalid activity code");return}window.location.href=`/Campus.Connect/Activity/?activityId=${a.id}`},children:"Join"})]}),e.jsx("button",{className:"ActionBtn",onClick:()=>{d()},children:"Close"})]})})}function N({dialogRef:r,close:d}){const[c,u]=t.useState(""),[s,o]=t.useState("activity"),[n,l]=t.useState(!1);return e.jsx("dialog",{ref:r,className:"CreateActivityDialog",children:e.jsxs("div",{className:"dialogContents",children:[e.jsx("h2",{children:"Join Activity"}),e.jsx("label",{htmlFor:"",children:"Activity Name"}),e.jsx("input",{type:"text",value:c,onChange:i=>{u(i.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Activity Type"}),e.jsxs("select",{value:s,onChange:i=>{o(i.target.value)},children:[e.jsx("option",{value:"activity",children:"Basic"}),e.jsx("option",{value:"theater",children:"Theater"})]}),n?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{l(!0);const i=await A(c,s);if(i===null){alert("Failed to create activity");return}window.location.href=`/Campus.Connect/Activity/?activityId=${i.id}`},children:"Create"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{d()},children:"Close"})]})})}j(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx(b,{})}));function b(){const[r,d]=t.useState([]),[c,u]=t.useState("student"),s=t.useRef(null),o=t.useRef(null);return t.useEffect(()=>{g(()=>{});async function n(){const i=await C();d(i),console.log(i)}n();const l=localStorage.getItem("accountType");l&&u(l)},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",children:e.jsx("h1",{children:"Activities"})}),e.jsxs("div",{className:"center",children:[e.jsx("div",{className:"activities",children:r.map(n=>e.jsx("div",{className:"activity",onClick:()=>{window.location.href=`/Campus.Connect/Activity/?activityId=${n.id}`},children:e.jsx("h1",{children:n.name})},n.id))}),e.jsx("br",{}),c=="teacher"&&e.jsx("button",{className:"ActionBtn",onClick:()=>{o.current.showModal()},children:"Create Activity"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{s.current.showModal()},children:"Join Activity"}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Campus.Connect/"},children:"Back"})]}),e.jsx(p,{dialogRef:s,close:()=>{s.current.close()}}),e.jsx(N,{dialogRef:o,close:()=>{o.current.close()}})]})}
