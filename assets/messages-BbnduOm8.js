import{j as s,r as l,c as se,i as O}from"./index-C75OlIaX.js";import{E as k,C as y,b as E,F as P,q as L,r as te,M as z,s as Q}from"./constants-DuVVuktt.js";import{h as re,f as T,J as ne,K as W,L as ae,M as ce,N as oe,O as le}from"./db-DdwSPomz.js";import{A as K}from"./Add_User_Dialog-CIHwzO9s.js";import{a as ie,A as ue,S as de,D as fe}from"./Show_Group_Display_Tile-zLimLfpy.js";import{E as me}from"./Ensemble_Section_Tile-DblsEPLE.js";import"./trash-BnpXJPEK.js";function he({message:f,isSender:g}){return s.jsx("div",{className:"message",children:s.jsx("div",{className:"message__outer",children:s.jsxs("div",{className:"message__inner",children:[g?s.jsx(s.Fragment,{}):s.jsx("div",{className:"message__spacer"}),s.jsxs("div",{className:"message__bubble "+(g?"isSender":"notSender"),children:[s.jsx("h1",{className:"message-sender",children:f.senderName}),s.jsxs("div",{className:"message-body",children:[s.jsx("p",{className:"message-text",children:f.message}),s.jsx("p",{className:"message-time-sent",children:f.timeSent.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),g?s.jsx("div",{className:"message__spacer"}):s.jsx(s.Fragment,{})]})})})}function pe({sendMessage:f}){const g=l.useRef(null);return s.jsxs("div",{className:"message-send-bar",onKeyDown:d=>{d.key==="Enter"&&g.current.value.trim()!==""&&(f(g.current.value.trim()),g.current.value="")},children:[s.jsx("input",{type:"text",placeholder:"Type a message...",className:"message-input",ref:g}),s.jsx("button",{onClick:()=>{f(g.current.value.trim()),g.current.value=""},className:"message-send-btn",children:"Send"})]})}function V({dialogRef:f,close:g,addMembers:d,activityId:b,setName:j}){const[M,m]=l.useState([]),[c,v]=l.useState(null),[C,I]=l.useState(null);return l.useEffect(()=>{b&&re(b).then(u=>{u=u.filter(i=>i.canCreateSchedule),m(u)})},[b]),s.jsx("dialog",{ref:f,className:"AddFromPlayDialog",children:s.jsxs("div",{className:"AddFromPlayDiv",children:[s.jsx("h2",{children:"Select Play"}),s.jsxs("select",{className:"SelectPlay",onChange:u=>{v(M.find(i=>i.id==u.target.value)||null),I(k.fromBlank(!0,!1,!1,!1,[],333))},children:[s.jsx("option",{value:"",children:"Select a Play"}),M.map((u,i)=>s.jsx("option",{value:u.id,children:u.name},i))]}),c&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("button",{className:"ActionBtn",onClick:()=>{const u=[],i=[];for(const n of c.ensemble.actors)i.includes(n.userId)||(u.push(n),i.push(n.userId));for(const n of c.characters)i.includes(n.actor.userId)||(u.push(n.actor),i.push(n.actor.userId));d(u)},children:"Add Full Cast"}),s.jsx("h2",{className:"title",children:"Ensemble"}),s.jsx("div",{className:"ensemble",children:s.jsx(me,{ensembleSection:C,isAssign:!1,actors:[],isCustom:!1,isCreate:!0,isGroupChatCreate:!0,setEnsembleSection:u=>{I(u)},onAddEnsemble:()=>{const u=[],i=[];if(C.includeAll)for(const n of c.ensemble.actors)i.includes(n.userId)||(u.push(n),i.push(n.userId));else if(C.includeMale)for(const n of c.ensemble.actors)n.gender=="male"&&(i.includes(n.userId)||(u.push(n),i.push(n.userId)));else if(C.includeFemale)for(const n of c.ensemble.actors)n.gender=="female"&&(i.includes(n.userId)||(u.push(n),i.push(n.userId)));d(u)},removeEnsembleSection:()=>{}})}),s.jsx("h2",{className:"title",children:"Show Groups"}),s.jsx("div",{className:"show-groups",children:c==null?void 0:c.showGroups.map((u,i)=>s.jsx(ie,{showGroup:u,canDelete:!1,onDelete:()=>{},canClick:!0,showCharacters:!1,onClick:()=>{j(u.name);const n=[],r=[];for(const a of u.characters)if(a instanceof y)r.includes(a.actor.userId)||(n.push(a.actor),r.push(a.actor.userId));else if(a instanceof E){for(const e of a.characters)if(e instanceof y)r.includes(e.actor.userId)||(n.push(e.actor),r.push(e.actor.userId));else if(e instanceof k){if(e.includeAll)for(const t of c.ensemble.actors)r.includes(t.userId)||(n.push(t),r.push(t.userId));else if(e.includeMale)for(const t of c.ensemble.actors)t.gender=="male"&&(r.includes(t.userId)||(n.push(t),r.push(t.userId)));else if(e.includeFemale)for(const t of c.ensemble.actors)t.gender=="female"&&(r.includes(t.userId)||(n.push(t),r.push(t.userId)));else if(e.includeCustom)for(const t of e.customActors)r.includes(t.userId)||(n.push(t),r.push(t.userId))}}else if(a instanceof k){if(a.includeAll)for(const e of c.ensemble.actors)r.includes(e.userId)||(n.push(e),r.push(e.userId));else if(a.includeMale)for(const e of c.ensemble.actors)e.gender=="male"&&(r.includes(e.userId)||(n.push(e),r.push(e.userId)));else if(a.includeFemale)for(const e of c.ensemble.actors)e.gender=="female"&&(r.includes(e.userId)||(n.push(e),r.push(e.userId)));else if(a.includeCustom)for(const e of a.customActors)r.includes(e.userId)||(n.push(e),r.push(e.userId))}d(n)}},i))}),s.jsx("h2",{className:"title",children:"Show Layout"}),s.jsx("div",{className:"layout",children:c==null?void 0:c.layout.map((u,i)=>s.jsx(ue,{act:u,onClick:n=>{j(n.name+" - "+u.name);const r=[],a=[];console.log(n);for(const e of n.characters)if(e instanceof y)a.includes(e.actor.userId)||(r.push(e.actor),a.push(e.actor.userId));else if(e instanceof E){for(const t of e.characters)if(t instanceof y)a.includes(t.actor.userId)||(r.push(t.actor),a.push(t.actor.userId));else if(t instanceof k){if(t.includeAll)for(const o of c.ensemble.actors)a.includes(o.userId)||(r.push(o),a.push(o.userId));else if(t.includeMale)for(const o of c.ensemble.actors)o.gender=="male"&&(a.includes(o.userId)||(r.push(o),a.push(o.userId)));else if(t.includeFemale)for(const o of c.ensemble.actors)o.gender=="female"&&(a.includes(o.userId)||(r.push(o),a.push(o.userId)));else if(t.includeCustom)for(const o of t.customActors)a.includes(o.userId)||(r.push(o),a.push(o.userId))}}else if(e instanceof k){if(e.includeAll)for(const t of c.ensemble.actors)a.includes(t.userId)||(r.push(t),a.push(t.userId));else if(e.includeMale)for(const t of c.ensemble.actors)t.gender=="male"&&(a.includes(t.userId)||(r.push(t),a.push(t.userId)));else if(e.includeFemale)for(const t of c.ensemble.actors)t.gender=="female"&&(a.includes(t.userId)||(r.push(t),a.push(t.userId)));else if(e.includeCustom)for(const t of e.customActors)a.includes(t.userId)||(r.push(t),a.push(t.userId))}else if(e instanceof P){for(const t of c.ensemble.actors)a.includes(t.userId)||(r.push(t),a.push(t.userId));for(const t of c.characters)a.includes(t.actor.userId)||(r.push(t.actor),a.push(t.actor.userId))}d(r)}},i))}),s.jsx("h2",{className:"title",children:"Songs"}),s.jsx("div",{className:"songs",children:c==null?void 0:c.songs.map((u,i)=>s.jsx(de,{song:u,onClick:()=>{j(u.name);const n=[],r=[];for(const a of u.characters)if(a instanceof y)r.includes(a.actor.userId)||(n.push(a.actor),r.push(a.actor.userId));else if(a instanceof E){for(const e of a.characters)if(e instanceof y)r.includes(e.actor.userId)||(n.push(e.actor),r.push(e.actor.userId));else if(e instanceof k){if(e.includeAll)for(const t of c.ensemble.actors)r.includes(t.userId)||(n.push(t),r.push(t.userId));else if(e.includeMale)for(const t of c.ensemble.actors)t.gender=="male"&&(r.includes(t.userId)||(n.push(t),r.push(t.userId)));else if(e.includeFemale)for(const t of c.ensemble.actors)t.gender=="female"&&(r.includes(t.userId)||(n.push(t),r.push(t.userId)));else if(e.includeCustom)for(const t of e.customActors)r.includes(t.userId)||(n.push(t),r.push(t.userId))}}else if(a instanceof k){if(a.includeAll)for(const e of c.ensemble.actors)r.includes(e.userId)||(n.push(e),r.push(e.userId));else if(a.includeMale)for(const e of c.ensemble.actors)e.gender=="male"&&(r.includes(e.userId)||(n.push(e),r.push(e.userId)));else if(a.includeFemale)for(const e of c.ensemble.actors)e.gender=="female"&&(r.includes(e.userId)||(n.push(e),r.push(e.userId)));else if(a.includeCustom)for(const e of a.customActors)r.includes(e.userId)||(n.push(e),r.push(e.userId))}else if(a instanceof P){for(const e of c.ensemble.actors)r.includes(e.userId)||(n.push(e),r.push(e.userId));for(const e of c.characters)r.includes(e.actor.userId)||(n.push(e.actor),r.push(e.actor.userId))}d(n)}},i))}),s.jsx("h2",{className:"title",children:"Dances"}),s.jsx("div",{className:"dances",children:c==null?void 0:c.dances.map((u,i)=>s.jsx(fe,{dance:u,onClick:()=>{j(u.name);const n=[],r=[];for(const a of u.characters)if(a instanceof y)r.includes(a.actor.userId)||(n.push(a.actor),r.push(a.actor.userId));else if(a instanceof E){for(const e of a.characters)if(e instanceof y)r.includes(e.actor.userId)||(n.push(e.actor),r.push(e.actor.userId));else if(e instanceof k){if(e.includeAll)for(const t of c.ensemble.actors)r.includes(t.userId)||(n.push(t),r.push(t.userId));else if(e.includeMale)for(const t of c.ensemble.actors)t.gender=="male"&&(r.includes(t.userId)||(n.push(t),r.push(t.userId)));else if(e.includeFemale)for(const t of c.ensemble.actors)t.gender=="female"&&(r.includes(t.userId)||(n.push(t),r.push(t.userId)));else if(e.includeCustom)for(const t of e.customActors)r.includes(t.userId)||(n.push(t),r.push(t.userId))}}else if(a instanceof k){if(a.includeAll)for(const e of c.ensemble.actors)r.includes(e.userId)||(n.push(e),r.push(e.userId));else if(a.includeMale)for(const e of c.ensemble.actors)e.gender=="male"&&(r.includes(e.userId)||(n.push(e),r.push(e.userId)));else if(a.includeFemale)for(const e of c.ensemble.actors)e.gender=="female"&&(r.includes(e.userId)||(n.push(e),r.push(e.userId)));else if(a.includeCustom)for(const e of a.customActors)r.includes(e.userId)||(n.push(e),r.push(e.userId))}else if(a instanceof P){for(const e of c.ensemble.actors)r.includes(e.userId)||(n.push(e),r.push(e.userId));for(const e of c.characters)r.includes(e.actor.userId)||(n.push(e.actor),r.push(e.actor.userId))}d(n)}},i))})]}),s.jsx("button",{className:"ActionBtn",onClick:()=>{g()},children:"Close"}),s.jsx("br",{})]})})}function Z({dialogRef:f,close:g,addMembers:d,activityGroups:b}){const[j,M]=l.useState(null);return s.jsx("dialog",{ref:f,className:"AddFromGroupDialog",children:s.jsxs("div",{className:"AddFromGroupDiv",children:[s.jsx("h2",{children:"Select Group"}),s.jsxs("select",{className:"SelectPlay",onChange:m=>{M(b.find(c=>c.groupName==m.target.value)||null)},children:[s.jsx("option",{value:"",children:"Select a Group"}),b.map((m,c)=>s.jsx("option",{value:m.groupName,children:m.groupName},c))]}),s.jsx("br",{}),s.jsx("button",{className:"ActionBtn",onClick:()=>{j&&d(j.groupMembers),g()},children:"Add Group"}),s.jsx("button",{className:"ActionBtn",onClick:()=>{g()},children:"Close"}),s.jsx("br",{})]})})}function ge({close:f,dialogRef:g,activityId:d,refresh:b}){const j=l.useRef(null),M=l.useRef(null),m=l.useRef(null),c=l.useRef(null),[v,C]=l.useState(null),[I,u]=l.useState([]),[i,n]=l.useState([]),[r,a]=l.useState([]);return l.useEffect(()=>{d&&T(d).then(e=>{C(e),e!=null&&(e instanceof L?(u([...e.parents,...e.students]),a(e.groups)):(u([...e.parents,...e.students]),a(e.groups)))})},[d]),s.jsxs(s.Fragment,{children:[s.jsx("dialog",{className:"create-group-chat-dialog",ref:g,children:s.jsxs("div",{className:"create-group-chat-dialog-inner",children:[s.jsx("h1",{className:"create-group-chat-dialog-title",children:"Create Group Chat"}),s.jsx("input",{type:"text",placeholder:"Group Chat Name",className:"create-group-chat-dialog-input",ref:j}),i.length>0&&s.jsxs(s.Fragment,{children:[" ",s.jsx("h2",{className:"create-group-chat-dialog-members-title",children:"Members: "}),s.jsx("div",{className:"create-group-chat-dialog-members",children:i.map((e,t)=>s.jsxs("div",{className:"create-group-chat-dialog-member",children:[s.jsx("label",{htmlFor:"",children:e.name}),s.jsx("button",{className:"ActionBtn",onClick:()=>{n(i.filter(o=>o!=e))},children:"Remove"})]},t))})," "]}),s.jsx("button",{className:"ActionBtn",onClick:()=>{M.current.showModal()},children:"Add Member"}),r.length>0&&s.jsx("button",{className:"ActionBtn",onClick:()=>{c.current.showModal()},children:"Add from Group"}),v instanceof L?s.jsx("button",{className:"ActionBtn",onClick:()=>{m.current.showModal()},children:"Add from Play"}):null,s.jsx("button",{className:"ActionBtn",onClick:async()=>{if(j.current.value==""){alert("Please enter a name for the group chat");return}if(i.length==0){alert("Please add at least one member to the group chat");return}const e=te.fromBlank(j.current.value,"",i,"custom",d,Date.now());await ne(e),b(),f()},children:"Create"}),s.jsx("button",{onClick:f,className:"ActionBtn",children:"Close"})]})}),s.jsx(K,{members:I,dialogRef:M,addedMembers:i,close:()=>{M.current.close()},addUser:e=>{const t=[...i,e],o=[],A=t.filter(h=>o.includes(h.name)?!1:(o.push(h.name),!0));n(A)}}),s.jsx(Z,{dialogRef:c,close:()=>{c.current.close()},addMembers:e=>{const t=[...i,...e],o=[],A=t.filter(h=>o.includes(h.name)?!1:(o.push(h.name),!0));n(A),c.current.close()},activityGroups:r}),s.jsx(V,{dialogRef:m,close:()=>{m.current.close()},addMembers:e=>{const t=[...i,...e],o=[],A=t.filter(h=>o.includes(h.name)?!1:(o.push(h.name),!0));n(A),m.current.close()},setName:e=>{},activityId:d})]})}function Ae({groupChat:f,onClick:g}){return s.jsxs("div",{className:"group-chat-display-tile",onClick:g,children:[s.jsx("h1",{children:f.name}),s.jsx("div",{className:"divider"}),s.jsxs("div",{className:"recent-message-div",children:[s.jsx("h3",{children:f.lastMessage!=null?f.lastMessage.senderName+": "+f.lastMessage.message:"No messages"}),s.jsx("h4",{children:f.lastMessage!=null?new Date(f.lastMessage.timeSent).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]})]})}function Ie({close:f,dialogRef:g,activityId:d,userData:b,refresh:j,activityName:M}){const m=l.useRef(null),c=l.useRef(null),v=l.useRef(null),C=l.useRef(null),[I,u]=l.useState(null),[i,n]=l.useState([]),[r,a]=l.useState([]),[e,t]=l.useState([]);return l.useEffect(()=>{d&&T(d).then(o=>{u(o),o!=null&&(o instanceof L?(n([...o.parents,...o.students]),t(o.groups)):(n([...o.parents,...o.students]),t(o.groups)))})},[d]),s.jsxs(s.Fragment,{children:[s.jsx("dialog",{className:"broadcast-message-dialog",ref:g,children:s.jsxs("div",{className:"broadcast-message-dialog-inner",children:[s.jsx("h1",{className:"broadcast-message-dialog-title",children:"Broadcast message"}),s.jsx("input",{type:"text",placeholder:"Message",className:"broadcast-message-dialog-input",ref:m}),r.length>0&&s.jsxs(s.Fragment,{children:[" ",s.jsx("h2",{className:"broadcast-message-dialog-members-title",children:"Recipient: "}),s.jsx("div",{className:"broadcast-message-dialog-members",children:r.map((o,A)=>s.jsxs("div",{className:"broadcast-message-dialog-member",children:[s.jsx("label",{htmlFor:"",children:o.name}),s.jsx("button",{className:"ActionBtn",onClick:()=>{a(r.filter(h=>h!=o))},children:"Remove"})]},A))})," "]}),s.jsx("button",{className:"ActionBtn",onClick:()=>{c.current.showModal()},children:"Add Recipient"}),e.length>0&&s.jsx("button",{className:"ActionBtn",onClick:()=>{C.current.showModal()},children:"Add from Group"}),I instanceof L?s.jsx("button",{className:"ActionBtn",onClick:()=>{v.current.showModal()},children:"Add from Play"}):null,s.jsx("button",{className:"ActionBtn",onClick:async()=>{if(m.current.value==""){alert("Please enter a message to broadcast");return}if(r.length==0){alert("Please add at least one recipient");return}const o=z.fromBlank(m.current.value,b.uid,b.fullname,b.FCMToken,"",d,"",new Date,[b.uid]);for(let A=0;A<r.length;A++){const h=r[A];o.gcId=h.userId,console.log("Sending message to "+h.userId),console.log(o.toMap()),await W(d,h.userId,o,M,h)}j(),f()},children:"Send"}),s.jsx("button",{onClick:f,className:"ActionBtn",children:"Close"})]})}),s.jsx(K,{members:i,dialogRef:c,addedMembers:r,close:()=>{c.current.close()},addUser:o=>{const A=[...r,o],h=[],G=A.filter(w=>h.includes(w.userId)?!1:(h.push(w.userId),!0));a(G)}}),s.jsx(Z,{dialogRef:C,close:()=>{C.current.close()},addMembers:o=>{const A=[...r,...o],h=[],G=A.filter(w=>h.includes(w.userId)?!1:(h.push(w.userId),!0));a(G),C.current.close()},activityGroups:e}),s.jsx(V,{dialogRef:v,close:()=>{v.current.close()},addMembers:o=>{const A=[...r,...o],h=[],G=A.filter(w=>h.includes(w.userId)?!1:(h.push(w.userId),!0));a(G),v.current.close()},setName:o=>{},activityId:d})]})}const xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAiCAYAAAC9duLEAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAE6ADAAQAAAABAAAAIgAAAAC8LsGQAAACaUlEQVRIDaWV24oTQRCGd6I3inhWFnURA+sBURQUfBfXI3rhM3jvlQ8g7srO7voa3nnvhQiKx3hcj6uiIKLG7wvToUwmmUks+KmuTtWX6unumWziP6zdbm+k/Araj+aycVmANlO7gPYWjN+NcWCAtlK3FEBiVkbuDNB2ChfRHgmFfcdfHAkGaJIiQbsLiO4bupBl2Z3aMEA7KHJpu1CyrwzOA7rrxKo0O8wDmuL3m2hnyPvM+Cyge2musjNALsmlucRknxgIepAm9ENhgJrkCNpmcmEf8IIeponkB8IATZOUI49BsncMTgN6miaiL4UB2kdSjjyYyZYZCGqliV7fBwN0kKR5tCEkv2Z8CtDLMNc3bMQZQIeIcxRBL4hPVoHImejCAB0lztF6lMwlzQCys0rrwAAdI/MGWhcqnjC2I59VLcsAHSdzFq0JFW77GUAfw1zlUNgtsuIVuU/sOVqprO5JcJmre+Z+EP/qmasVCruMfobsI4zn6ThuRPh58LDBcm7z8yVkR8k8IgsAfS3Xtu6hpfAEVddQ3Agvss/Pi11pXZiZAN3Z62itcWGP8O6sF3yo/QMzE6CHdw7FM+fF9l560QdaH8xMgIdxHuK4CS1iO3yDL7VSmJkAyy68F90OX5XRBsIKoB/XHG0yLsx7aofP00TyQ2Em0eE0LkfxJfmW2A6f4btWCTMTYBO3iOLr+z2xHT7Gd6wWzEyAZR8WXwQCO98Dr1Mto6BF4gyK77YtxEv80QEhtTszWaPQj7FLnjIu7Av+3MgwiwFO4gS69GTLY8GsBuhmCGwaY3/GhlkN0ONyFfnMZv8Ctza9toJqQLkAAAAASUVORK5CYII=";se(document.getElementById("root")).render(s.jsx(l.StrictMode,{children:s.jsx(je,{})}));function je(){const[f,g]=l.useState(""),[d,b]=l.useState([]),[j,M]=l.useState("student"),[m,c]=l.useState(null),[v,C]=l.useState([]);l.useState([]);const[I,u]=l.useState(null),[i,n]=l.useState(!1),[r,a]=l.useState(!1),e=l.useRef(null),t=l.useRef(null),o=l.useRef(null),[A,h]=l.useState([]),[G,w]=l.useState(""),[H,J]=l.useState(!1);function Y(p){C(p),setTimeout(()=>{e.current.scrollTop=e.current.scrollHeight},100)}l.useEffect(()=>{m&&ae(m.activityId,m.id,Y)},[m]),l.useEffect(()=>{O(()=>{});const p=()=>{window.innerWidth<800?n(!0):n(!1)};return window.addEventListener("resize",p),p(),()=>window.removeEventListener("resize",p)},[]);function _(p){const x={weekday:"long",year:"numeric",month:"long",day:"numeric"};return p.toLocaleDateString("en-US",x)}function X(p){const x=[];let S=new Date(0);return p.forEach(N=>{N.timeSent.toDateString()!=S.toDateString()&&(x.push({time:_(N.timeSent)}),S=N.timeSent),x.push(N)}),x}l.useEffect(()=>{a(!0),O(()=>{});const x=new URLSearchParams(window.location.search).get("activityId");x&&(g(x),T(x).then(N=>{N&&w(N.name)})),ce(x,b).then(()=>{oe().then(N=>{u(N)})});const S=localStorage.getItem("accountType");S&&M(S)},[]),l.useEffect(()=>{async function p(){if(H||!d||d.length==0)return;a(!1);const x=new URLSearchParams(window.location.search),S=x.get("groupChatId");if(console.log(S),S){const R=d.find(B=>B.id==S);R&&c(R)}const N=x.get("studentId");if(console.log(N),N){const R=d.find(B=>B.id==N);if(R)c(R);else{const B=Q.fromBlank(I.fullname,I.email,I.phoneNumber,I.FCMToken,I.uid),U=localStorage.getItem("viewingUser");if(U){const D=JSON.parse(U),ee=Q.fromBlank(D.fullname,D.email,D.phoneNumber,D.FCMToken,D.uid);le(B,ee,f).then(F=>{console.log(F==null?void 0:F.toMap()),c(F),localStorage.removeItem("viewingUser")})}}}J(!0)}p()},[d]);function q(p){const x=p.toLowerCase(),S=d.filter(N=>N.name.toLowerCase().includes(x));h(S)}l.useEffect(()=>{h(d)},[d]);async function $(p){if(!I||!m)return;const x=z.fromBlank(p,I.uid,I.fullname,I.FCMToken,m.id,f,"",new Date,[I.uid]);await W(f,m.id,x,G)}return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"title",children:s.jsx("h1",{children:"Messages"})}),s.jsxs("div",{className:"center",children:[s.jsxs("div",{className:"window",children:[(!i||i&&!m)&&s.jsxs("div",{className:"left",children:[s.jsx("div",{className:"search-div",children:s.jsx("input",{type:"text",className:"search-input",placeholder:"Enter group chat name...",onChange:p=>{q(p.target.value)}})}),s.jsx("div",{className:"groupChats",children:r?s.jsx("div",{className:"loader"}):A.map(p=>s.jsx(Ae,{groupChat:p,onClick:()=>{c(p)}}))}),s.jsxs("div",{className:"GCOptions "+j,children:[s.jsx("button",{className:"ActionBtn",onClick:()=>{t.current.showModal()},children:"Create Group Chat"}),j=="teacher"&&s.jsx("button",{className:"ActionBtn",onClick:()=>{o.current.showModal()},children:"Broadcast Message"})]})]}),(!i||i&&m)&&s.jsx("div",{className:"right",children:m?s.jsxs("div",{className:"selectedGroupChat",children:[s.jsxs("div",{className:"back-div",children:[i&&s.jsx("img",{src:xe,alt:"",onClick:()=>c(null)}),s.jsx("h2",{children:m.name})]}),s.jsx("div",{className:"messages",ref:e,children:X(v).map(p=>Object.prototype.hasOwnProperty.call(p,"time")?s.jsx("div",{className:"timeSeparator",children:p.time}):s.jsx(he,{message:p,isSender:p.senderUid==localStorage.getItem("userId")}))}),s.jsx(pe,{sendMessage:$})]}):s.jsx("div",{className:"noSelectedGroupChat",children:s.jsx("h1",{children:"No Group Chat Selected"})})})]}),s.jsx("br",{}),s.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Activity/?activityId="+f},children:"Back"})]}),s.jsx(ge,{dialogRef:t,refresh:()=>{},close:()=>{t.current.close()},activityId:f}),s.jsx(Ie,{activityName:G,dialogRef:o,refresh:()=>{},close:()=>{o.current.close()},activityId:f,userData:I})]})}
