import{c as $,j as e,r as a,a as J,b as P}from"./index-DUWJYJoQ.js";import{c as F,g as z}from"./db-Bth3z0iE.js";import{T as X,L as _,G as Q,S as ee}from"./constants-DQ2WKrIa.js";function C(o){return o*(Math.PI/180)}function te(o){return o*.621371}async function ae(o){const i=`https://geocode.maps.co/search?q=${o}&api_key=667ef1741c1fc644172402icg005d42`;try{const n=await fetch(i,{method:"POST"});if(n.ok){const l=await n.json(),h={lat:parseFloat(l[0].lat),lon:parseFloat(l[0].lon)};return console.log(h),h}else return console.error(`Request failed with status: ${n.status}`),{lat:0,lon:0}}catch(n){return console.error(`Request failed: ${n}`),{lat:0,lon:0}}}function oe(o,i,n,l){const r=C(n-o),d=C(l-i),g=Math.sin(r/2)*Math.sin(r/2)+Math.cos(C(o))*Math.cos(C(n))*Math.sin(d/2)*Math.sin(d/2),m=6371*(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)));return te(m)}$(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(ne,{})}));function ne(){const[o,i]=a.useState(""),[n,l]=a.useState(""),[h,r]=a.useState(!1),[d,g]=a.useState([]),[f,m]=a.useState(""),[N,S]=a.useState("accountType"),[v,y]=a.useState("student"),[A,I]=a.useState("LoginInfo"),[p,M]=a.useState(""),[b,E]=a.useState(""),[se,R]=a.useState(""),[x,L]=a.useState(""),[k,D]=a.useState(""),[H,O]=a.useState(""),[B,W]=a.useState(""),[K,V]=a.useState(""),[U,q]=a.useState(""),G=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],Y=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"];return a.useEffect(()=>{async function t(){const s=await z();g(s),m(s[0].schoolId)}t()},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"center",children:e.jsx("div",{className:"Login",children:N=="accountType"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Account Type"}),e.jsx("button",{className:"actionBtn",onClick:()=>{y("student"),S("login")},children:"Student"}),e.jsx("button",{className:"actionBtn",onClick:()=>{y("teacher"),S("login")},children:"Teacher"})]}):N=="login"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Login"}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{i(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{l(t.target.value)}}),e.jsx("select",{onChange:t=>{m(t.target.value)},children:d.map(t=>e.jsx("option",{value:t.schoolId,children:t.schoolName}))}),h?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"actionBtn",onClick:async()=>{if(r(!0),!await J(o,n,f)){r(!1),alert("Wrong email or password");return}localStorage.setItem("accountType",v),r(!1);const c=new URLSearchParams(window.location.search).get("redirect");c?window.location.href=c:window.location.href="/Campus.Connect/"},children:"Login"}),e.jsx("button",{className:"actionBtn",onClick:()=>{S("createAccount")},children:"Create an Account"})]}):v=="teacher"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),e.jsx("input",{type:"text",placeholder:"Full Name",onChange:t=>{M(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{i(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{l(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"School Code",onChange:t=>{L(t.target.value)}}),h?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"actionBtn",onClick:async()=>{r(!0);const t=d.find(j=>j.schoolTeacherCode==x);if(!t){alert("Invalid School Code");return}localStorage.setItem("schoolId",t.schoolId);const s=X.fromBlank("",t.schoolId,"","teacher",p.toLowerCase(),p,o),c=await P(o,n);if(!c){alert("Error creating account");return}s.uid=c,await F("teacher",s),localStorage.setItem("accountType","teacher");const u=new URLSearchParams(window.location.search).get("redirect");u?window.location.href=u:window.location.href="/Campus.Connect/",r(!1)},children:"Create Account"})]}):A=="LoginInfo"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),e.jsx("input",{type:"text",placeholder:"Full Name",onChange:t=>{M(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{i(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{l(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Phone Number",onChange:t=>{E(t.target.value)}}),e.jsxs("select",{onChange:t=>{R(t.target.value)},children:[e.jsx("option",{value:"null",selected:!0,children:"Select your Sex"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]}),e.jsx("button",{onClick:()=>{I("SchoolCode")},children:"Next"})]}):A=="SchoolCode"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),e.jsx("input",{type:"text",placeholder:"School Code",value:x,onChange:t=>{L(t.target.value)}}),e.jsx("p",{children:"Or"}),e.jsx("input",{type:"text",placeholder:"School Email",value:k,onChange:t=>{D(t.target.value)}}),e.jsx("button",{onClick:()=>{I("HomeAddress")},children:"Next"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),e.jsx("input",{type:"text",placeholder:"Home Address",onChange:t=>{O(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"City",onChange:t=>{W(t.target.value)}}),e.jsxs("select",{onChange:t=>{V(t.target.value)},children:[e.jsx("option",{value:"null",selected:!0,children:"Select your State"}),G.map((t,s)=>e.jsx("option",{value:t,children:Y[s]}))]}),e.jsx("input",{type:"text",placeholder:"Zip Code",onChange:t=>{q(t.target.value)}}),h?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{onClick:async()=>{r(!0);let t;if(x!=""?t=d.find(w=>w.schoolCode==x):t=d.find(w=>w.schoolDomain==k.split("@")[1]),t==null){alert("Invalid School Code");return}const s=H+", "+B+", "+K+", "+U,c=await ae(s),T=oe(c.lat,c.lon,t.location.location.latitude,t.location.location.longitude);if(!c){alert("Invalid Address");return}localStorage.setItem("schoolId",t.schoolId);const u=await P(o,n);if(!u){alert("Error creating account");return}const j=_.fromBlank("home",s,new Q(c.lat,c.lon)),Z=ee.fromBlank(u,t.schoolId,"unknown",T,"","student",b,"unknown",p.toLowerCase(),p,o,{},j);await F("student",Z),localStorage.setItem("accountType","student"),new URLSearchParams(window.location.search).get("redirect"),r(!1)},children:"Create Account"})]})})})})}
