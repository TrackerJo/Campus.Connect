import{c as y,j as n,r as l,i as I}from"./index-DUWJYJoQ.js";import{l as C,h as j,i as F}from"./constants-dc7CZI3_.js";import{y as T,z as A}from"./db-DbyQmLQG.js";import{C as M}from"./Calendar-CPq8IUYr.js";y(document.getElementById("root")).render(n.jsx(l.StrictMode,{children:n.jsx(L,{})}));function L(){const[k,E]=l.useState("student"),[w,S]=l.useState([]),[x,D]=l.useState([]);return l.useState(null),l.useEffect(()=>{I(()=>{});async function d(){const s=await T(),h=[];console.log(s),S(s);const g=[];for(const e of s){const m=e instanceof C;let c=null;if(e instanceof C){const a=h.find(t=>t.activityId===e.activityId&&t.showId===e.showId);if(a)c=a;else{const t=await A(e.activityId,e.showId);t&&(h.push(t),c=t)}}console.log(e);const o=e.date.from;console.log(e.date.date),o.setDate(e.date.date.getDate()),o.setMonth(e.date.date.getMonth()),o.setFullYear(e.date.date.getFullYear());const r=e.date.to;r.setDate(e.date.date.getDate()),r.setMonth(e.date.date.getMonth()),r.setFullYear(e.date.date.getFullYear()),console.log(o),console.log(r);let f=!1,u=!1,v=null,p=null;if(console.log(c),c)for(const a of c.dates){const t=new Date(a.date);t.getDate()===o.getDate()&&t.getMonth()===o.getMonth()&&t.getFullYear()===o.getFullYear()&&(f=!0,a.canAttend&&(u=!0,v=new Date(a.from),p=new Date(a.to)))}g.push({title:e.name,start:o.toISOString(),end:r.toISOString(),isAllDay:!1,interactive:!0,description:e.info+(m?`
Location: ${e.rehearsalLocation.name}`:"")+(u?` 
(Excused from ${v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} to ${p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:f&&!u?` 
(Fully Excused)`:""),color:f&&!u?"black":f?"grey":m?j(F(e.rehearsalLocation.color),.8):"blue",id:e.id})}D(g),console.log(s),console.log(g)}d();const i=localStorage.getItem("accountType");i&&E(i)},[]),n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"title",children:n.jsx("h1",{children:"Calendar"})}),n.jsxs("div",{className:"center",children:[n.jsx(M,{viewEvent:d=>{},events:x,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventClick:d=>{const i=w.find(s=>s.id===d.event.id);i&&(localStorage.setItem("event",JSON.stringify(i)),localStorage.removeItem("back"),window.location.href="/Campus.Connect/Calendar/Event/")}}),n.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Campus.Connect/"},children:"Back"})]})]})}
