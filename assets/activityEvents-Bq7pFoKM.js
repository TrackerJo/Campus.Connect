import{c as de,j as t,r as i,i as ue,n as me,I as he}from"./index-DdbGL9Ax.js";import{X as ge,h as ve,Y as pe,Z as fe,_ as Se}from"./db-BSKwQBwX.js";import{B as xe,C as _}from"./Calendar-BaAQ5KLE.js";de(document.getElementById("root")).render(t.jsx(i.StrictMode,{children:t.jsx(je,{})}));function je(){const[q,z]=i.useState("student"),[b,O]=i.useState([]),[I,$]=i.useState([]),[R,K]=i.useState(null),[U,k]=i.useState(!1),[A,G]=i.useState([]),[a,Q]=i.useState(),[P,X]=i.useState("students"),[W,y]=i.useState("date"),[D,N]=i.useState(null),[v,p]=i.useState(null),[f,S]=i.useState(null),[L,F]=i.useState(""),[M,H]=i.useState(""),[ee,x]=i.useState(""),[te,j]=i.useState(""),[d,u]=i.useState(void 0),[m,h]=i.useState([]),[E,B]=i.useState("students"),[ne,Ee]=i.useState(!1);i.useState(""),i.useState(""),i.useState(null),i.useState(null);const[se,Te]=i.useState(""),[V,Y]=i.useState(!1),[ae,oe]=i.useState(null),[T,C]=i.useState(void 0);i.useEffect(()=>{ue(()=>{});async function e(){k(!0);const s=new URLSearchParams(window.location.search).get("activityId");if(s){K(s);const c=await ve(s);Q(c),console.log(c),u(c.defaultLocation)}const l=await pe(s);console.log(l),O(l);const w=[];for(const c of l){console.log(c);const g=c.date.from;console.log(c.date.date),g.setDate(c.date.date.getDate()),g.setMonth(c.date.date.getMonth()),g.setFullYear(c.date.date.getFullYear());const r=c.date.to;r.setDate(c.date.date.getDate()),r.setMonth(c.date.date.getMonth()),r.setFullYear(c.date.date.getFullYear()),console.log(g),console.log(r),w.push({title:c.name,start:g.toISOString(),end:r.toISOString(),isAllDay:!1,interactive:!0,description:c.info,color:c.eventType.color.setAlpha(.8).toRBGAString(),id:c.id,location:c.location.name})}$(w),console.log(l),console.log(w),k(!1)}e();const n=localStorage.getItem("accountType");n&&z(n)},[]);function Z(){return b}const ie=e=>{const n=e.target.value,[o,s]=n.split(":").map(Number),l=new Date(D);l.setHours(o,s,0,0),p(l),x(l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},le=e=>{const n=e.target.value,[o,s]=n.split(":").map(Number),l=new Date(D);l.setHours(o,s,0,0),S(l),j(l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};function ce(){return t.jsxs("div",{className:"custom-invite-view",children:[t.jsx("button",{className:P=="students"?"selected":"",onClick:()=>{X("students")},children:"Students"}),t.jsx("button",{className:P=="parents"?"selected":"",onClick:()=>{X("parents")},children:"Parents"}),t.jsx("div",{className:"current-view",children:P=="students"?t.jsx("div",{className:"students",children:a==null?void 0:a.students.map((e,n)=>t.jsxs("div",{className:"student",children:[t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"student",checked:m.find(o=>o.userId==e.userId)!=null,onChange:o=>{o.target.checked?h([...m,e]):h(m.filter(s=>s!=e))}}),t.jsx("span",{className:"checkmark",children:" "})]}),t.jsx("label",{htmlFor:e.userId,children:e.name})]},e.userId))}):t.jsx("div",{className:"parents",children:a==null?void 0:a.parents.map((e,n)=>t.jsxs("div",{className:"parent",children:[t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"parent",onChange:o=>{o.target.checked?h([...m,e]):h(m.filter(s=>s!=e))}}),t.jsx("span",{className:"checkmark",children:" "})]}),t.jsx("label",{htmlFor:e.userId,children:e.name})]},e.userId))})})]})}function re(){return t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"mode",children:"Enter Rehersal Information"}),t.jsx("label",{htmlFor:"Name",children:"Name: "}),t.jsx("input",{type:"text",value:L,onChange:e=>{F(e.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"Description",children:"Description: "}),t.jsx("textarea",{value:M,onChange:e=>{H(e.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"",children:"Date: "}),t.jsx("input",{type:"date",value:D==null?void 0:D.toISOString().split("T")[0],onChange:e=>{const n=new Date(e.target.value);n.setHours(0,0,0,0),n.setDate(n.getDate()+1),N(n);const o=new Date(n);o.setHours(v.getHours(),v.getMinutes(),0,0),p(o),x(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const s=new Date(n);s.setHours(f.getHours(),f.getMinutes(),0,0),S(s),j(s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),t.jsx("input",{type:"time",value:ee,onChange:ie}),t.jsx("br",{}),t.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),t.jsx("input",{type:"time",value:te,onChange:le}),t.jsx("br",{}),t.jsx("label",{htmlFor:"location",children:"Location: "}),t.jsx("select",{name:"location",id:"location",onChange:e=>{u(a==null?void 0:a.locations.find(n=>n.name==e.target.value))},children:a==null?void 0:a.locations.map((e,n)=>t.jsx("option",{value:e.name,selected:(d==null?void 0:d.name)==e.name,children:e.name+" ("+e.address+")"},n))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),t.jsx("select",{name:"eventType",id:"event-type",onChange:e=>{C(a==null?void 0:a.eventTypes.find(n=>n.name==e.target.value))},children:a==null?void 0:a.eventTypes.map((e,n)=>t.jsx("option",{value:e.name,selected:(T==null?void 0:T.name)==e.name,children:e.name},n))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"inviteType",children:"Invite Type: "}),t.jsxs("select",{name:"inviteType",id:"invite-type",onChange:e=>{B(e.target.value)},children:[t.jsx("option",{value:"students",selected:E=="students",children:"Students"}),t.jsx("option",{value:"parents",selected:E=="parents",children:"Parents"}),t.jsx("option",{value:"groups",selected:E=="groups",children:"Groups"}),t.jsx("option",{value:"custom",selected:E=="custom",children:"Custom"})]}),E=="groups"?t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("label",{htmlFor:"groups",children:"Groups: "}),t.jsx("div",{className:"groups",children:a.groups.map((e,n)=>t.jsxs("div",{className:"group",children:[t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:A.find(o=>o.groupName==e.groupName)!=null,onChange:o=>{o.target.checked?(G([...A,e]),h([...m,...e.groupMembers])):(G(A.filter(s=>s.groupName!=e.groupName)),h(m.filter(s=>!e.groupMembers.includes(s))))}}),t.jsx("span",{className:"checkmark",children:" "})]}),t.jsx("label",{htmlFor:e.groupName,children:e.groupName})]},e.groupName))})]}):t.jsx(t.Fragment,{}),E=="custom"?ce():t.jsx(t.Fragment,{}),t.jsx("br",{}),U?t.jsx("div",{className:"loader"}):t.jsx("button",{onClick:async()=>{if(k(!0),console.log(`Name: ${L}, Description: ${M}, Start Time: ${v}, End Time: ${f}, Selected Location: ${d},Event Type: ${T}`),L==""||M==""||v==null||f==null||d==null||T==null){alert("Please fill out all fields"),console.log(`Name: ${L}, Description: ${M}, Start Time: ${v}, End Time: ${f}, Selected Location: ${d},  Event Type: ${T}`),k(!1);return}console.log("Submit");const e=d??a.locations[0];console.log(v),console.log(f);const n=me.fromBlank(D,v,f);console.log(n.toMap());const o=T;o.color.setAlpha(255);const s=he.fromBlank(L,M,e,n,"activity-event",Date.now(),R,A.map(l=>l.groupName),m,E,o,A,ne,se,[],a.name);if(V){s.id=ae.id,await fe(s),Y(!1);const l=s.date.from,w=s.date.to,c={title:s.name,start:l.toISOString(),end:w.toISOString(),isAllDay:!1,interactive:!0,description:s.info,color:s.eventType.color.setAlpha(.8).toRBGAString(),id:s.id,location:s.location.name},g=I.filter(J=>J.id!=s.id);g.push(c),$(g);const r=b.filter(J=>J.id!=s.id);r.push(s),console.log(r),O([...r])}else{await Se(s);const l=s.date.from,w=s.date.to,c={title:s.name,start:l.toISOString(),end:w.toISOString(),isAllDay:!1,interactive:!0,description:s.info,color:s.eventType.color.setAlpha(.8).toRBGAString(),id:s.id,location:s.location.name};$([...I,c]),O([...b,s])}k(!1),y("date"),N(null),p(null),S(null),F(""),H(""),x(""),j(""),C(a==null?void 0:a.eventTypes[0]),u(a==null?void 0:a.defaultLocation),h([]),B("students")},className:"ActionBtn",children:V?"Save":"Submit"}),t.jsx("button",{onClick:()=>{if(V){y("date"),N(null),p(null),S(null),F(""),H(""),x(""),j(""),u(a.defaultLocation),C(a.eventTypes[0]),u(a==null?void 0:a.defaultLocation),Y(!1);return}y("date"),H(""),F(""),B("students")},className:"ActionBtn",children:"Back"})]})}return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:xe,alt:"back arrow",onClick:()=>{window.location.href="/Activity/?activityId="+R}}),t.jsx("h1",{children:"Events"})]}),U?t.jsx("div",{className:"center",children:t.jsx("div",{className:"loader"})}):t.jsx("div",{className:"center",children:q=="teacher"?W=="date"?t.jsx(_,{canViewConflicts:!1,isCreating:!0,canOpenContextMenu:!0,events:I,editEvent:e=>{const n=Z().find(o=>o.id==e.id);console.log(e.id),n&&(console.log(n),y("info"),F(n.name),H(n.info),N(n.date.date),p(n.date.from),x(n.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),S(n.date.to),j(n.date.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),u(n.location),h(n.targets),console.log("FROM EDIT"),console.log(n.targets),C(n.eventType),Y(!0),B(n.generalTarget),oe(n),G(n.groupTargets))},viewEvent:e=>{const n=Z().find(o=>o.id==e.id);n&&(localStorage.setItem("event",JSON.stringify(n.toMap())),localStorage.setItem("back","/Activity/Events/?activityId="+R),window.location.href="/Calendar/Event/")},viewConflicts:e=>{},deleteEvent:async e=>{console.log(e);const n=b.find(l=>l.id==e.id),o=b.filter(l=>l.id!=e.id);O(o);const s=I.filter(l=>l.id!=e.id);$(s),await ge(n)},dateClick:e=>{console.log(e.date),N(e.date),new Date(e.date).setHours(0,0,0,0),p(new Date(e.date)),x(e.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(e.date);S(o.addHours(1)),console.log(o),j(e.date.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),u(a.defaultLocation),C(a.eventTypes[0]),y("info")},eventClick:e=>{N(e.event.start),new Date(e.event.start).setHours(0,0,0,0),p(new Date(e.event.start)),x(e.event.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(e.event.end);S(o),j(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),u(a.defaultLocation),C(a.eventTypes[0]),y("info")}}):re():t.jsx(_,{viewEvent:e=>{},canViewConflicts:!1,events:I,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventIdClick:e=>{const n=b.find(o=>o.id===e);n&&(localStorage.setItem("event",JSON.stringify(n.toMap())),localStorage.removeItem("back"),window.location.href="/Calendar/Event/")}})})]})}
