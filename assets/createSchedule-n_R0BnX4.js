import{j as t,c as ze,r as d,i as Je}from"./index-U3pxML4x.js";import{j as Ve,c as C,e as _,d as v,F as W,k as qe,l as We}from"./constants-Cyoi8QJQ.js";import{i as Ke,w as Qe,q as Xe,x as Ze,y as et,z as tt,A as st}from"./db-B1Sht4uu.js";import{A as nt,S as ke,D as Fe,C as ot,E as at,a as ct,b as rt}from"./Dance_Display_Tile-Dem4zeUS.js";import{B as xe,C as it}from"./Calendar-BGozzx9S.js";import{C as lt,S as dt}from"./Show_Group_Tile-DVy8AZoE.js";import{E as ut}from"./Ensemble_Section_Tile-DDhACZt1.js";import{F as ft}from"./Full_Cast_Tile-CJX3OvfU.js";import"./trash-BnpXJPEK.js";import"./arrow_forward-CHD_SwLW.js";function Ce({conflictResponseDate:N,actor:X}){return t.jsx("div",{className:"ConflictDisplayTile ",id:"conflict-display-tile-"+X.userId,children:t.jsx("div",{className:"header",children:t.jsxs("div",{className:"CharacterNameDiv",children:[t.jsxs("label",{htmlFor:"Actor",children:["Actor: ",X.name]}),t.jsx("br",{}),t.jsxs("label",{htmlFor:"Actor",children:["Date: ",N.date.toDateString()]}),t.jsx("br",{}),N.canAttend?t.jsxs("label",{htmlFor:"Actor",children:[N.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",N.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}):t.jsx("label",{htmlFor:"Actor",children:"Can't Attend"})]})})})}ze(document.getElementById("root")).render(t.jsx(d.StrictMode,{children:t.jsx(ht,{})}));function ht(){const[N,X]=d.useState(""),[l,Ne]=d.useState(),[Z,Le]=d.useState(""),[i,ye]=d.useState(),[U,h]=d.useState("date"),[M,D]=d.useState(null),[R,T]=d.useState(null),[B,w]=d.useState(null),[p,E]=d.useState("custom"),[K,b]=d.useState(""),[Q,L]=d.useState(""),[Me,A]=d.useState(""),[Re,k]=d.useState(""),[y,H]=d.useState(void 0),[be,ce]=d.useState(!1),[z,ee]=d.useState([]),[te,se]=d.useState([]),[m,f]=d.useState([]),[re,$]=d.useState(!1),[I,Be]=d.useState([]),[ie,g]=d.useState([]),[le,He]=d.useState(!1),[j,F]=d.useState(null),[ne,oe]=d.useState(!1),[ve,$e]=d.useState(null),[G,Y]=d.useState(),[O,P]=d.useState(void 0),[de,De]=d.useState(!1),[ue,fe]=d.useState(!1),[he,Ge]=d.useState([]),[S,Ye]=d.useState(void 0),[Te,ae]=d.useState(!1),[J,me]=d.useState("Layout"),[we,ge]=d.useState(void 0),[Ee,pe]=d.useState(void 0),[Ae,Ie]=d.useState(void 0),[V,q]=d.useState(!1);d.useEffect(()=>{Je(()=>{});const a=new URLSearchParams(window.location.search),c=a.get("activityId");c&&(X(c),Ke(c).then(s=>{s instanceof Ve||(Ne(s),Y(s==null?void 0:s.rehearsalLocations[0]),P(s==null?void 0:s.eventTypes[0]),H(s==null?void 0:s.defaultLocation))}));const e=a.get("showId");e&&(Le(e),Qe(c,e).then(s=>{const n=[];for(const r of s)for(const u of r.dates)n.find(x=>x.conflictResponseDate.date.getTime()==u.date.getTime()&&x.actor.userId==r.actor.userId)||n.push({conflictResponseDate:u,actor:r.actor});n.sort((r,u)=>r.conflictResponseDate.date.getTime()-u.conflictResponseDate.date.getTime()),Be(n),g([...n])})),Xe(c,e).then(s=>{ye(s),s!=null&&s.hasEnsemble&&Ge(s.ensemble.actors)}),Ze(c,e).then(s=>{ee(s);const n=[];for(const r of s){console.log(r);const u=r.date.from;console.log(r.date.date),u.setDate(r.date.date.getDate()),u.setMonth(r.date.date.getMonth()),u.setFullYear(r.date.date.getFullYear());const x=r.date.to;x.setDate(r.date.date.getDate()),x.setMonth(r.date.date.getMonth()),x.setFullYear(r.date.date.getFullYear()),console.log(u),console.log(x),console.log(r.rehearsalLocation.color),n.push({title:r.name,start:u.toISOString(),end:x.toISOString(),isAllDay:!1,interactive:!0,color:r.rehearsalLocation.color.setAlpha(.8).toHex(),description:r.info,id:r.id,location:r.rehearsalLocation.name})}se(n)});const o=()=>{window.innerWidth<1366?De(!0):De(!1)};return window.addEventListener("resize",o),o(),()=>window.removeEventListener("resize",o)},[]);const Oe=a=>{const c=a.target.value,[e,o]=c.split(":").map(Number),s=new Date(M);s.setHours(e,o,0,0),T(s),A(s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},Pe=a=>{const c=a.target.value,[e,o]=c.split(":").map(Number),s=new Date(M);s.setHours(e,o,0,0),w(s),k(s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};Date.prototype.addHours=function(a){return this.setTime(this.getTime()+a*60*60*1e3),this};function _e(){return le?t.jsx(t.Fragment,{children:"   "}):t.jsxs(t.Fragment,{children:[" ",t.jsx("h2",{children:"Characters"}),t.jsx("div",{className:"characters",children:m.map((a,c)=>{if(a instanceof C)return p=="custom"?t.jsx(lt,{character:a,isCreate:!1,actors:[],characters:i.characters,isAssign:!1,setCharacter:e=>{f(m.map((o,s)=>s===c?e:o))},removeCharacter:()=>{f(m.filter((e,o)=>o!==c))}},c):t.jsx(ot,{character:a,canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==c))},isMini:!1},c);if(a instanceof v)return p=="custom"?t.jsx(ut,{isGroupChatCreate:!1,onAddEnsemble:()=>{},ensembleSection:a,isCustom:!0,setEnsembleSection:e=>{f(m.map((o,s)=>s===c?e:o))},removeEnsembleSection:()=>{f(m.filter((e,o)=>o!==c)),$(!1)},isCreate:!1,isAssign:!1,actors:l.students},c):t.jsx(at,{ensembleSection:a,canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==c))},isMini:!1},c);if(a instanceof _)return p=="custom"?t.jsx(dt,{showGroup:a,characters:i.characters,setShowGroup:e=>{f(m.map((o,s)=>s===c?e:o))},removeShowGroup:()=>{f(m.filter((e,o)=>o!==c))},isCreate:!1,isAssign:!1,actors:l.students,hasEnsemble:i.hasEnsemble,showGroups:i.showGroups},c):t.jsx(ct,{showGroup:a,showCharacters:!0,canClick:!1,onClick:()=>{},canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==c))}},c);if(a instanceof W)return t.jsx(ft,{canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==c))}},c)})}),p=="custom"?t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"ActionBtn",onClick:()=>{const a=Math.floor(Math.random()*1e5);f([...m,C.fromBlank("Character 1",null,a)])},children:"Add Character"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{const a=Math.floor(Math.random()*1e5);f([...m,_.fromBlank("Show Group 1",[],a)])},children:"Add Show Group"}),(i==null?void 0:i.hasEnsemble)&&t.jsx("button",{className:"ActionBtn "+(re?"disabled":""),disabled:re,onClick:()=>{re||($(!0),f([...m,v.fromBlank(!0,!1,!1,!1,[])]))},children:"Add Ensemble"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{q(!0),h("type")},children:"Add Characters from Show Template"})]}):t.jsx(t.Fragment,{})," "]})}function Ue(){return t.jsxs(t.Fragment,{children:[t.jsxs("h2",{children:[p.charAt(0).toUpperCase()+p.slice(1,p.length)," "]}),p=="scene"&&t.jsx(rt,{scene:we,onClick:()=>{},showCharacters:!0}),p=="song"&&t.jsx(ke,{showCharacters:!0,song:Ee,onClick:()=>{}}),p=="dance"&&t.jsx(Fe,{showCharacters:!0,dance:Ae,onClick:()=>{}}),t.jsxs("button",{className:"ActionBtn",onClick:()=>{q(!0),h("type")},children:["Change ",p.charAt(0).toUpperCase()+p.slice(1,p.length)]}),t.jsx("button",{className:"ActionBtn",onClick:()=>{E("custom")},children:"Switch to custom event"})]})}function Se(){return z}return t.jsxs("div",{className:"center",children:[t.jsx("h1",{className:"title",children:"Create Schedule"}),U=="date"?t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:xe,alt:"back arrow",onClick:()=>{window.location.href="/Activity/Shows/Show/?activityId="+N+"&showId="+Z}}),t.jsx("h2",{className:"mode",children:"Select a Date"})," "]}):t.jsx(t.Fragment,{}),t.jsxs("div",{className:"container",children:[U=="date"?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"box left",children:[t.jsxs("h2",{children:["Conflicts",j!=null?" on "+j.toDateString():""]}),(i==null?void 0:i.hasEnsemble)&&t.jsxs(t.Fragment,{children:[t.jsx("label",{htmlFor:"",children:"Ignore Ensemble Conflicts"}),t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:ue,onChange:a=>{if(fe(a.target.checked),a.target.checked){const c=[];for(const e of I)he.find(o=>o.userId==e.actor.userId)||(j!=null?e.conflictResponseDate.date.getTime()==j.getTime()&&c.push(e):c.push(e));g(c)}else if(j!=null){const c=[];for(const e of I)e.conflictResponseDate.date.getTime()==j.getTime()&&c.push(e);g(c)}else g([...I])}}),t.jsx("span",{className:"checkmark",children:" "})]})," "]}),t.jsx("div",{className:"conflicts",children:ie.map((a,c)=>t.jsx(Ce,{conflictResponseDate:a.conflictResponseDate,actor:a.actor},c))})]})}):t.jsx(t.Fragment,{}),t.jsx("div",{className:U!="date"?"datePicker hidden":"datePicker",children:t.jsx(it,{canViewConflicts:!0,canPaste:S!=null,canCopy:!0,copyEvent:a=>{const c=Se().find(e=>e.id==a.id);Ye(c)},pasteEvent:a=>{const c=new Date(a);c.setHours(0,0,0,0),D(c),T(new Date(S.date.from)),A(S.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const e=new Date(S.date.to);w(e),console.log(e),k(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),b(S.name),L(S.info),H(S.location),Y(S.rehearsalLocation),f(S.characters),P(S.activityEventType),E(S.theaterEventType),S.theaterEventType=="song"?pe(S.song):S.theaterEventType=="dance"?Ie(S.dance):S.theaterEventType=="scene"&&ge(S.scene),h("info"),ae(!0)},isCreating:!0,canOpenContextMenu:!0,events:te,editEvent:a=>{const c=Se().find(e=>e.id==a.id);c&&(console.log(c),h("info"),b(c.name),L(c.info),D(c.date.date),T(c.date.from),A(c.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),w(c.date.to),k(c.date.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),H(c.location),Y(c.rehearsalLocation),f(c.characters),P(c.activityEventType),oe(!0),E(c.theaterEventType),c.theaterEventType=="song"&&pe(c.song),c.theaterEventType=="dance"&&Ie(c.dance),c.theaterEventType=="scene"&&ge(c.scene),$e(c))},viewEvent:a=>{const c=Se().find(e=>e.id==a.id);c&&(localStorage.setItem("event",JSON.stringify(c.toMap())),localStorage.setItem("back","/Activity/Shows/Show/CreateSchedule/?activityId="+N+"&showId="+Z),window.location.href="/Calendar/Event/")},viewConflicts:a=>{const c=new Date(a);c.setHours(0,0,0,0),F(c);const e=[];for(const o of I)o.conflictResponseDate.date.getTime()==c.getTime()&&e.push(o);g(e)},deleteEvent:async a=>{console.log(a);const c=z.find(s=>s.id==a.id),e=z.filter(s=>s.id!=a.id);ee(e);const o=te.filter(s=>s.id!=a.id);se(o),await et(c)},dateClick:a=>{console.log(a.date),D(a.date);const c=new Date(a.date);c.setHours(0,0,0,0),F(c);const e=[];for(const s of I)s.conflictResponseDate.date.getTime()==c.getTime()&&e.push(s);g(e),T(new Date(a.date)),A(a.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(a.date);w(o.addHours(1)),console.log(o),k(a.date.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),h("type")},eventClick:a=>{D(a.event.start);const c=new Date(a.event.start);c.setHours(0,0,0,0),F(c);const e=[];for(const s of I)s.conflictResponseDate.date.getTime()==c.getTime()&&e.push(s);g(e),T(new Date(a.event.start)),A(a.event.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(a.event.end);w(o),k(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),h("type")}})}),U=="date"?t.jsx(t.Fragment,{}):t.jsx(t.Fragment,{})]}),U=="date"?t.jsxs(t.Fragment,{children:[de&&t.jsx("button",{className:"ActionBtn",onClick:()=>{const a=new Date;console.log(a),D(a);const c=new Date(a);c.setHours(0,0,0,0),F(c);const e=[];for(const s of I)s.conflictResponseDate.date.getTime()==c.getTime()&&e.push(s);g(e),T(new Date(a)),A(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(a);w(o.addHours(1)),console.log(o),k(a.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),h("type")},children:"Create Event"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{localStorage.setItem("events",JSON.stringify(z.map(a=>a.toMap()))),window.open("/Activity/Shows/Show/Schedule/Print/","_blank")},children:"Print"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Activity/Shows/Show/?activityId="+N+"&showId="+Z},children:"Back"})]}):U=="type"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:xe,alt:"back arrow",onClick:()=>{h("date"),F(null),g([...I])}}),t.jsx("h2",{className:"mode",children:V?"Add Characters from Show":"Select a Rehersal Type"})]}),!de&&t.jsxs("div",{className:"conflicts-div",children:[t.jsxs("h2",{children:["Conflicts",j!=null?" on "+j.toDateString():""]}),t.jsx("label",{htmlFor:"",children:"Ignore Ensemble Conflicts"}),(i==null?void 0:i.hasEnsemble)&&t.jsx(t.Fragment,{children:t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:ue,onChange:a=>{if(fe(a.target.checked),a.target.checked){const c=[],e=new Date(M);e.setHours(0,0,0,0);for(const o of I)he.find(s=>s.userId==o.actor.userId)||o.conflictResponseDate.date.getTime()==e.getTime()&&c.push(o);g(c)}}}),t.jsx("span",{className:"checkmark",children:" "})]})}),t.jsx("div",{className:"conflicts",children:ie.map((a,c)=>t.jsx(Ce,{conflictResponseDate:a.conflictResponseDate,actor:a.actor},c))})]}),!V&&t.jsx("button",{onClick:()=>{h("info"),E("custom"),f([])},className:"ActionBtn",children:"Custom"}),t.jsxs("div",{className:"sections",children:[t.jsx("h2",{className:"section "+(J=="Layout"?"selected":""),onClick:()=>{me("Layout")},children:"Layout"}),i!=null&&i.dances.length>0&&t.jsx("h2",{className:"section "+(J=="Songs"?"selected":""),onClick:()=>{me("Songs")},children:"Songs"}),i!=null&&(i==null?void 0:i.songs.length)>0&&t.jsx("h2",{className:"section "+(J=="Dances"?"selected":""),onClick:()=>{me("Dances")},children:"Dances"})]}),J=="Layout"&&t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"mode",children:"Show Layout"}),t.jsx("div",{className:"layout",children:i==null?void 0:i.layout.map((a,c)=>t.jsx(nt,{act:a,onClick:e=>{h("info"),V?(f(n=>[...n,...e.characters]),q(!1)):(f(e.characters),E("scene"),ge(e),b(e.name+" - "+a.name));const o=[];for(const n of[...e.characters,m])if(n instanceof C)o.includes(n.actor.userId)&&o.push(n.actor.userId);else if(n instanceof _){for(const r of n.characters)if(r instanceof C)o.includes(r.actor.userId)&&o.push(r.actor.userId);else if(r instanceof v){if(r.includeAll)for(const u of i.ensemble.actors)o.includes(u.userId)&&o.push(u.userId);else if(r.includeMale)for(const u of i.ensemble.actors)u.gender=="male"&&o.includes(u.userId)&&o.push(u.userId);else if(r.includeFemale)for(const u of i.ensemble.actors)u.gender=="female"&&o.includes(u.userId)&&o.push(u.userId);else if(r.includeCustom)for(const u of r.customActors)o.includes(u.userId)&&o.push(u.userId)}}else if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)o.includes(r.userId)&&o.push(r.userId);else if(n.includeMale)for(const r of i.ensemble.actors)r.gender=="male"&&o.includes(r.userId)&&o.push(r.userId);else if(n.includeFemale)for(const r of i.ensemble.actors)r.gender=="female"&&o.includes(r.userId)&&o.push(r.userId);else if(n.includeCustom)for(const r of n.customActors)o.includes(r.userId)&&o.push(r.userId)}else if(n instanceof W){for(const r of i.ensemble.actors)o.includes(r.userId)&&o.push(r.userId);for(const r of i.characters)o.includes(r.actor.userId)||o.push(r.actor.userId)}const s=[];for(const n of I)o.includes(n.actor.userId)&&n.conflictResponseDate.date.getTime()==j.getTime()&&s.push(n);g(s)}},c))})," "]}),J=="Songs"&&t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"mode",children:"Songs"}),t.jsx("div",{className:"songs",children:i==null?void 0:i.songs.map((a,c)=>t.jsx(ke,{showCharacters:!1,song:a,onClick:()=>{V?(f(s=>[...s,...a.characters]),q(!1)):(f(a.characters),E("song"),pe(a),b(a.name)),h("info");const e=[];for(const s of[...a.characters,m])if(s instanceof C)e.includes(s.actor.userId)&&e.push(s.actor.userId);else if(s instanceof _){for(const n of s.characters)if(n instanceof C)e.includes(n.actor.userId)&&e.push(n.actor.userId);else if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)e.includes(r.userId)&&e.push(r.userId);else if(n.includeMale)for(const r of i.ensemble.actors)r.gender=="male"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeFemale)for(const r of i.ensemble.actors)r.gender=="female"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeCustom)for(const r of n.customActors)e.includes(r.userId)&&e.push(r.userId)}}else if(s instanceof v){if(s.includeAll)for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);else if(s.includeMale)for(const n of i.ensemble.actors)n.gender=="male"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeFemale)for(const n of i.ensemble.actors)n.gender=="female"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeCustom)for(const n of s.customActors)e.includes(n.userId)&&e.push(n.userId)}else if(s instanceof W){for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);for(const n of i.characters)e.includes(n.actor.userId)||e.push(n.actor.userId)}const o=[];for(const s of I)e.includes(s.actor.userId)&&s.conflictResponseDate.date.getTime()==j.getTime()&&o.push(s);g(o)}},c))})," "]}),J=="Dances"&&t.jsxs(t.Fragment,{children:[" ",t.jsx("h2",{className:"mode",children:"Dances"}),t.jsx("div",{className:"dances",children:i==null?void 0:i.dances.map((a,c)=>t.jsx(Fe,{showCharacters:!1,dance:a,onClick:()=>{h("info"),V?(f(s=>[...s,...a.characters]),q(!1)):(f(a.characters),E("dance"),Ie(a),b(a.name));const e=[];for(const s of[...a.characters,m])if(s instanceof C)e.includes(s.actor.userId)&&e.push(s.actor.userId);else if(s instanceof _){for(const n of s.characters)if(n instanceof C)e.includes(n.actor.userId)&&e.push(n.actor.userId);else if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)e.includes(r.userId)&&e.push(r.userId);else if(n.includeMale)for(const r of i.ensemble.actors)r.gender=="male"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeFemale)for(const r of i.ensemble.actors)r.gender=="female"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeCustom)for(const r of n.customActors)e.includes(r.userId)&&e.push(r.userId)}}else if(s instanceof v){if(s.includeAll)for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);else if(s.includeMale)for(const n of i.ensemble.actors)n.gender=="male"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeFemale)for(const n of i.ensemble.actors)n.gender=="female"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeCustom)for(const n of s.customActors)e.includes(n.userId)&&e.push(n.userId)}else if(s instanceof W){for(const n of i.ensemble.actors)e.push(n.userId);for(const n of i.characters)e.includes(n.actor.userId)||e.push(n.actor.userId)}const o=[];for(const s of I)e.includes(s.actor.userId)&&s.conflictResponseDate.date.getTime()==j.getTime()&&o.push(s);g(o)}},c))})," "]}),t.jsx("button",{onClick:()=>{if(V){h("info"),q(!1);return}h("date"),F(null),g([...I])},className:"ActionBtn",children:"Back"})]}):t.jsxs(t.Fragment,{children:[!de&&t.jsxs("div",{className:"conflicts-div",children:[t.jsxs("h2",{children:["Conflicts",j!=null?" on "+j.toDateString():""]}),(i==null?void 0:i.hasEnsemble)&&t.jsxs(t.Fragment,{children:[t.jsx("label",{htmlFor:"",children:"Ignore Ensemble Conflicts"}),t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:ue,onChange:a=>{if(fe(a.target.checked),a.target.checked){const c=[],e=[];for(const o of m)if(o instanceof C)e.includes(o.actor.userId)&&e.push(o.actor.userId);else if(o instanceof _){for(const s of o.characters)if(s instanceof C)e.includes(s.actor.userId)&&e.push(s.actor.userId);else if(s.includeAll)for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);else if(s.includeMale)for(const n of i.ensemble.actors)n.gender=="male"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeFemale)for(const n of i.ensemble.actors)n.gender=="female"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeCustom)for(const n of s.customActors)e.includes(n.userId)&&e.push(n.userId)}else if(o instanceof v){if(o.includeAll)for(const s of i.ensemble.actors)e.includes(s.userId)&&e.push(s.userId);else if(o.includeMale)for(const s of i.ensemble.actors)s.gender=="male"&&e.includes(s.userId)&&e.push(s.userId);else if(o.includeFemale)for(const s of i.ensemble.actors)s.gender=="female"&&e.includes(s.userId)&&e.push(s.userId);else if(o.includeCustom)for(const s of o.customActors)e.includes(s.userId)&&e.push(s.userId)}else{for(const s of i.ensemble.actors)e.push(s.userId);for(const s of i.characters)e.includes(s.actor.userId)||e.push(s.actor.userId)}for(const o of I)he.find(s=>s.userId==o.actor.userId)||e.includes(o.actor.userId)&&o.conflictResponseDate.date.getTime()==j.getTime()&&c.push(o);g(c)}}}),t.jsx("span",{className:"checkmark",children:" "})]})," "]}),t.jsx("div",{className:"conflicts",children:ie.map((a,c)=>t.jsx(Ce,{conflictResponseDate:a.conflictResponseDate,actor:a.actor},c))})]}),t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:xe,alt:"back arrow",onClick:()=>{if(ne){h("date"),D(null),T(null),w(null),E("custom"),b(""),L(""),A(""),k(""),Y(l==null?void 0:l.rehearsalLocations[0]),P(l==null?void 0:l.eventTypes[0]),H(l==null?void 0:l.defaultLocation),$(!1),F(null),g(I),oe(!1);return}Te?(ae(!1),h("date")):h("type"),L(""),b(""),$(!1);const a=[];for(const c of I)c.conflictResponseDate.date.getTime()==j.getTime()&&a.push(c);g(a)}}),t.jsx("h2",{className:"mode",children:"Enter Rehersal Information"})]}),t.jsx("label",{htmlFor:"Name",children:"Name: "}),t.jsx("input",{type:"text",value:K,onChange:a=>{b(a.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"Description",children:"Description: "}),t.jsx("textarea",{value:Q,onChange:a=>{L(a.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"",children:"Date: "}),t.jsx("input",{type:"date",value:M==null?void 0:M.toISOString().split("T")[0],onChange:a=>{const c=new Date(a.target.value);if(c=="Invalid Date"){D(null);return}c.setHours(0,0,0,0),c.setDate(c.getDate()+1),D(c);const e=new Date(c);e.setHours(R.getHours(),R.getMinutes(),0,0),T(e),A(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(c);o.setHours(B.getHours(),B.getMinutes(),0,0),w(o),k(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),F(c);const s=[];for(const n of I)n.conflictResponseDate.date.getTime()==c.getTime()&&s.push(n);g(s)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),t.jsx("input",{type:"time",value:Me,onChange:Oe}),t.jsx("br",{}),t.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),t.jsx("input",{type:"time",value:Re,onChange:Pe}),t.jsx("br",{}),t.jsx("label",{htmlFor:"location",children:"Location: "}),t.jsx("select",{name:"location",id:"location",onChange:a=>{H(l==null?void 0:l.locations.find(c=>c.name==a.target.value))},children:l==null?void 0:l.locations.map((a,c)=>t.jsx("option",{value:a.name,selected:(y==null?void 0:y.name)==a.name,children:a.name+" ("+a.address+")"},c))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"location",children:"Rehersal Location: "}),t.jsx("select",{name:"location",id:"rehersal-location",onChange:a=>{Y(l==null?void 0:l.rehearsalLocations.find(c=>c.name==a.target.value))},children:l==null?void 0:l.rehearsalLocations.map((a,c)=>t.jsx("option",{value:a.name,selected:(G==null?void 0:G.name)==a.name,children:a.name},c))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),t.jsx("select",{name:"eventType",id:"event-type",onChange:a=>{P(l==null?void 0:l.eventTypes.find(c=>c.name==a.target.value))},children:l==null?void 0:l.eventTypes.map((a,c)=>t.jsx("option",{value:a.name,selected:(O==null?void 0:O.name)==a.name,children:a.name},c))}),t.jsx("br",{}),p=="custom"?t.jsxs(t.Fragment,{children:[t.jsx("label",{htmlFor:"fullCast",children:"Full Cast: "}),t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:le,onChange:a=>He(a.target.checked)}),t.jsx("span",{className:"checkmark"})]})]}):t.jsx(t.Fragment,{}),p=="custom"&&t.jsx("br",{}),p=="custom"?_e():Ue(),t.jsx("br",{}),be?t.jsx("div",{className:"loader"}):t.jsx("button",{onClick:async()=>{if(ce(!0),console.log(`Name: ${K}, Description: ${Q}, Start Time: ${R}, End Time: ${B}, Selected Location: ${y}, Rehearsal Location: ${G}, Event Type: ${O}`),K==""||Q==""||R==null||B==null||y==null||G==null||O==null){alert("Please fill out all fields"),console.log(`Name: ${K}, Description: ${Q}, Start Time: ${R}, End Time: ${B}, Selected Location: ${y}, Rehearsal Location: ${G}, Event Type: ${O}`),ce(!1);return}console.log("Submit");const a=y??l.locations[0];console.log(R),console.log(B);const c=qe.fromBlank(M,R,B);console.log(c.toMap());const e=[];if(le){if(m.push(new W),i!=null&&i.hasEnsemble&&(i==null?void 0:i.ensemble)!=null)for(const s of i.ensemble.actors)e.push(s);for(const s of i.characters)e.find(n=>n.userId==s.actor.userId)==null&&e.push(s.actor)}else for(const s of m){if(s instanceof W){for(const n of i.ensemble.actors)e.push(n);for(const n of i.characters)e.find(r=>r.userId==n.actor.userId)==null&&e.push(n.actor);break}if(s instanceof C){if(e.find(n=>n.userId==s.actor.userId)!=null)continue;e.push(s.actor)}if(s instanceof v){if(s.includeAll)for(const n of i.ensemble.actors)e.find(r=>r.userId==n.userId)==null&&e.push(n);else if(s.includeMale){for(const n of i.ensemble.actors)if(n.gender=="male"){if(e.find(r=>r.userId==n.userId)!=null)continue;e.push(n)}}else if(s.includeFemale){for(const n of i.ensemble.actors)if(n.gender=="female"){if(e.find(r=>r.userId==n.userId)!=null)continue;e.push(n)}}else if(s.includeCustom)for(const n of s.customActors)e.find(r=>r.userId==n.userId)==null&&e.push(n)}if(s instanceof _)for(const n of s.characters){if(n instanceof C){if(e.find(r=>r.userId==n.actor.userId)!=null)continue;e.push(n.actor)}if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)e.find(u=>u.userId==r.userId)==null&&e.push(r);else if(n.includeMale){for(const r of i.ensemble.actors)if(r.gender=="male"){if(e.find(u=>u.userId==r.userId)!=null)continue;e.push(r)}}else if(n.includeFemale){for(const r of i.ensemble.actors)if(r.gender=="female"){if(e.find(u=>u.userId==r.userId)!=null)continue;e.push(r)}}else if(n.includeCustom)for(const r of n.customActors)e.find(u=>u.userId==r.userId)==null&&e.push(r)}}}const o=We.fromBlank(K,Q,a,c,"activity-theater-event",Date.now(),N,l.name,Z,i.name,m,e,p,O,G,p=="scene"?we:void 0,p=="song"?Ee:void 0,p=="dance"?Ae:void 0);if(console.log(o),ne){o.id=ve.id,await tt(o),oe(!1);const s=o.date.from,n=o.date.to;s.setDate(o.date.date.getDate()),s.setMonth(o.date.date.getMonth()),s.setFullYear(o.date.date.getFullYear()),n.setDate(o.date.date.getDate()),n.setMonth(o.date.date.getMonth()),n.setFullYear(o.date.date.getFullYear());const r={title:o.name,start:s.toISOString(),end:n.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.rehearsalLocation.color.setAlpha(.8).toHex(),location:o.rehearsalLocation.name,id:o.id},u=te.filter(je=>je.id!=ve.id);u.push(r),se(u);const x=z.filter(je=>je.id!=o.id);x.push(o),console.log(x),ee([...x])}else{await st(o);const s=o.date.from,n=o.date.to;s.setDate(o.date.date.getDate()),s.setMonth(o.date.date.getMonth()),s.setFullYear(o.date.date.getFullYear()),n.setDate(o.date.date.getDate()),n.setMonth(o.date.date.getMonth()),n.setFullYear(o.date.date.getFullYear());const r={title:o.name,start:s.toISOString(),end:n.toISOString(),isAllDay:!1,interactive:!0,color:o.rehearsalLocation.color.setAlpha(.8).toHex(),id:o.id,location:o.rehearsalLocation.name,description:o.info};se([...te,r]),ee([...z,o])}ce(!1),h("date"),D(null),T(null),w(null),E("custom"),b(""),L(""),A(""),k(""),Y(l==null?void 0:l.rehearsalLocations[0]),P(l==null?void 0:l.eventTypes[0]),H(l==null?void 0:l.defaultLocation),f([]),$(!1),F(null),g(I),ae(!1)},className:"ActionBtn",children:ne?"Save":"Submit"}),!be&&t.jsx("button",{onClick:()=>{if(ne){h("date"),D(null),T(null),w(null),E("custom"),b(""),L(""),A(""),k(""),Y(l==null?void 0:l.rehearsalLocations[0]),P(l==null?void 0:l.eventTypes[0]),H(l==null?void 0:l.defaultLocation),$(!1),F(null),g(I),oe(!1);return}Te?(ae(!1),h("date")):h("type"),L(""),b(""),$(!1);const a=[];for(const c of I)c.conflictResponseDate.date.getTime()==j.getTime()&&a.push(c);g(a)},className:"ActionBtn",children:"Back"})]})]})}
