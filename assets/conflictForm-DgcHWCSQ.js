import{j as e,r as l,c as ce,i as de,g as z}from"./index-U3pxML4x.js";import{m as E,k as H,n as S,o as ue,i as me,g as Z,p as he}from"./constants-HHyPtPso.js";import{T as xe}from"./trash-BnpXJPEK.js";import{B as ge,C as je,D as fe,i as be,w as pe,q as De,E as Ce,F as ve}from"./db-Kw40k41I.js";import{A as Se}from"./Add_User_Dialog-Dad0pas1.js";function ye({conflict:s,canDelete:i,onDelete:j,setConflict:m}){return e.jsx("div",{className:"ConflictDateTile",id:"conflict-date-tile-"+s.date.date.toISOString(),children:e.jsxs("div",{className:"header",children:[e.jsxs("div",{className:"ConflictDateNameDiv",children:[e.jsx("label",{htmlFor:"Character",children:"Date: "}),e.jsx("input",{type:"date",value:s.date.date.toISOString().slice(0,10),onChange:a=>{const u=new Date(a.target.value);if(u=="Invalid Date"){m(E.fromBlank(H.fromBlank(new Date,s.date.from,s.date.to),s.moreInfo));return}u.setHours(0,0,0,0),m(E.fromBlank(H.fromBlank(u,s.date.from,s.date.to),s.moreInfo))}}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Actor",children:"From: "}),e.jsx("input",{type:"time",value:s.date.from.toTimeString().slice(0,5),onChange:a=>{console.log(a.target.value);const u=new Date,h=a.target.value.split(":");u.setHours(parseInt(h[0]),parseInt(h[1]),0,0),m(E.fromBlank(H.fromBlank(s.date.date,u,s.date.to),s.moreInfo))}}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Actor",children:"To: "}),e.jsx("input",{type:"time",value:s.date.to.toTimeString().slice(0,5),onChange:a=>{console.log(a.target.value);const u=new Date,h=a.target.value.split(":");u.setHours(parseInt(h[0]),parseInt(h[1]),0,0),console.log({date:u}),m(E.fromBlank(H.fromBlank(s.date.date,s.date.from,u),s.moreInfo))}}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Character",children:"More Info: "}),e.jsx("input",{type:"text",value:s.moreInfo,onChange:a=>{m(E.fromBlank(H.fromBlank(s.date.date,s.date.from,s.date.to),a.target.value))}})]}),i&&e.jsx("div",{children:e.jsx("img",{src:xe,alt:"",className:"TrashIcon",onClick:()=>{j()}})})]})})}function we({minTime:s,maxTime:i,setConflict:j,dialogRef:m,close:a,date:u}){const[h,D]=l.useState(S.fromBlank(u,s,i,!0,""));return l.useEffect(()=>{D(S.fromBlank(u,s,i,!0,""))},[s,i,u]),e.jsxs("dialog",{ref:m,className:"AddConflictDialog",children:[e.jsx("h2",{children:"Add Conflict"}),e.jsxs("div",{className:"conflict-times",children:[e.jsx("label",{htmlFor:"",children:"From: "}),e.jsx("input",{type:"time",value:h.from.toTimeString().slice(0,5),onChange:y=>{const C=new Date,F=y.target.value.split(":");C.setHours(parseInt(F[0]),parseInt(F[1]),0,0),D(S.fromBlank(u,C,h.to,!0,h.note))}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"To: "}),e.jsx("input",{type:"time",value:h.to.toTimeString().slice(0,5),onChange:y=>{const C=new Date,F=y.target.value.split(":");C.setHours(parseInt(F[0]),parseInt(F[1]),0,0),D(S.fromBlank(u,h.from,C,!0,h.note))}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Note (Optional): "}),e.jsx("input",{type:"text",value:h.note,onChange:y=>{D(S.fromBlank(u,h.from,h.to,!0,y.target.value))}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{D(S.fromBlank(u,s,i,!0,"")),j(h)},children:"Add Conflict"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{a()},children:"Close"})]})]})}function ke({conflict:s,conflictResponseDate:i,setConflict:j}){const m=l.useRef(null);return e.jsxs("div",{className:"ConflictDateFormTile",id:"conflict-date-form-tile-"+s.date.date.toISOString(),children:[e.jsx("div",{className:"header",children:e.jsxs("div",{className:"ConflictDateFormNameDiv",children:[e.jsxs("label",{htmlFor:"Character",children:["Date: ",s.date.date.toDateString()]}),e.jsx("br",{}),e.jsxs("label",{htmlFor:"Actor",children:["From: ",s.date.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})," "]}),e.jsx("br",{}),e.jsxs("label",{htmlFor:"Actor",children:["To: ",s.date.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})]}),e.jsx("br",{}),s.moreInfo!=""&&e.jsxs("label",{htmlFor:"Character",children:["More Info: ",s.moreInfo]})]})}),e.jsxs("div",{className:"can-attend-div",children:[e.jsx("label",{htmlFor:"can-attend-cbox",children:"Can attend rehersal: "}),e.jsxs("div",{className:"custom-checkbox",onClick:()=>{j(S.fromBlank(s.date.date,null,null,!(i!=null&&i.canAttend),""))},children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:i==null?void 0:i.canAttend,onChange:a=>j(S.fromBlank(s.date.date,null,null,a.target.checked,""))}),e.jsx("span",{className:"checkmark"})]})]}),(i==null?void 0:i.from)&&e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"",children:"Conflict:"}),e.jsx("br",{}),e.jsxs("label",{htmlFor:"",children:["From: ",i.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})]}),e.jsx("br",{}),e.jsxs("label",{htmlFor:"",children:["To: ",i.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})]}),i.note!=""&&e.jsx("br",{}),i.note!=""&&e.jsxs("label",{htmlFor:"",children:["Note: ",i.note]})]})}),(i==null?void 0:i.canAttend)&&e.jsx("button",{className:"ActionBtn",onClick:()=>{var a;if(i!=null&&i.from){j(S.fromBlank(s.date.date,null,null,!0,""));return}(a=m.current)==null||a.showModal()},children:i!=null&&i.from?"Remove Conflict":"Add Conflict"}),e.jsx(we,{minTime:s.date.from,maxTime:s.date.to,setConflict:a=>{var u;j(S.fromBlank(s.date.date,a.from,a.to,!0,a.note)),(u=m.current)==null||u.close()},date:s.date.date,dialogRef:m,close:()=>{var a;(a=m.current)==null||a.close()}})]})}function Fe({dialogRef:s,close:i,addConflicts:j}){const[m,a]=l.useState("daily"),[u,h]=l.useState(new Date),[D,y]=l.useState(new Date),[C,F]=l.useState(new Date),[b,f]=l.useState(new Date),[A,B]=l.useState(""),[r,x]=l.useState([]),[T,J]=l.useState(!1);return e.jsxs("dialog",{ref:s,className:"AddRecurringConflictDialog",children:[e.jsx("h2",{children:"Add Recurring Conflict"}),e.jsx("label",{htmlFor:"",children:"Note: Only use this if you can still attend part of the rehersal!"}),e.jsxs("div",{className:"conflict-times",children:[e.jsx("label",{htmlFor:"",children:"Recurring Type: "}),e.jsxs("select",{name:"recurring-type",id:"recurring-type",value:m,onChange:o=>{a(o.target.value)},children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"biweekly",children:"Every other week"})]}),m=="daily"&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Exclude weekends: "}),e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:T,onChange:o=>J(o.target.checked)}),e.jsx("span",{className:"checkmark"})]})]}),(m=="weekly"||m=="biweekly")&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Days of the week: "}),e.jsxs("div",{className:"repeat-days",children:[e.jsx("div",{className:"day-of-week noselect "+(r.includes(0)?"day-chosen":""),onClick:()=>{if(r.includes(0)){x(r.filter(o=>o!=0));return}x([...r,0])},children:e.jsx("label",{htmlFor:"",children:"Sun"})}),e.jsx("div",{className:"day-of-week noselect "+(r.includes(1)?"day-chosen":""),onClick:()=>{if(r.includes(1)){x(r.filter(o=>o!=1));return}x([...r,1])},children:e.jsx("label",{htmlFor:"",children:"Mon"})}),e.jsx("div",{className:"day-of-week noselect "+(r.includes(2)?"day-chosen":""),onClick:()=>{if(r.includes(2)){x(r.filter(o=>o!=2));return}x([...r,2])},children:e.jsx("label",{htmlFor:"",children:"Tue"})}),e.jsx("div",{className:"day-of-week noselect "+(r.includes(3)?"day-chosen":""),onClick:()=>{if(r.includes(3)){x(r.filter(o=>o!=3));return}x([...r,3])},children:e.jsx("label",{htmlFor:"",children:"Wed"})}),e.jsx("div",{className:"day-of-week noselect "+(r.includes(4)?"day-chosen":""),onClick:()=>{if(r.includes(4)){x(r.filter(o=>o!=4));return}x([...r,4])},children:e.jsx("label",{htmlFor:"",children:"Thu"})}),e.jsx("div",{className:"day-of-week noselect "+(r.includes(5)?"day-chosen":""),onClick:()=>{if(r.includes(5)){x(r.filter(o=>o!=5));return}x([...r,5])},children:e.jsx("label",{htmlFor:"",children:"Fri"})}),e.jsx("div",{className:"day-of-week noselect "+(r.includes(6)?"day-chosen":""),onClick:()=>{if(r.includes(6)){x(r.filter(o=>o!=6));return}x([...r,6])},children:e.jsx("label",{htmlFor:"",children:"Sat"})})]})]}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Start Date: "}),e.jsx("input",{type:"date",value:u.toISOString().slice(0,10),onChange:o=>{console.log(o.target.value);const c=new Date(o.target.value);if(c=="Invalid Date"){h(new Date);return}c.setHours(0,0,0,0),c.setDate(c.getDate()+1),h(c)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"End Date: "}),e.jsx("input",{type:"date",value:D.toISOString().slice(0,10),onChange:o=>{console.log(o.target.value);const c=new Date(o.target.value);if(c=="Invalid Date"){y(new Date);return}c.setHours(0,0,0,0),c.setDate(c.getDate()+1),y(c)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Start Time: "}),e.jsx("input",{type:"time",value:C.toTimeString().slice(0,5),onChange:o=>{const c=new Date,v=o.target.value.split(":");c.setHours(parseInt(v[0]),parseInt(v[1]),0,0),F(c)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"End Time: "}),e.jsx("input",{type:"time",value:b.toTimeString().slice(0,5),onChange:o=>{const c=new Date,v=o.target.value.split(":");c.setHours(parseInt(v[0]),parseInt(v[1]),0,0),f(c)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Note (Optional): "}),e.jsx("input",{type:"text",value:A,onChange:o=>{B(o.target.value)}}),e.jsx("button",{className:"ActionBtn",onClick:()=>{const o=[],c=new Date(u);c.setHours(0,0,0,0),console.log("Start Date"),console.log(c),console.log("End Date"),console.log(D),D.setHours(0,0,0,0),console.log("End Date Changed"),console.log(D);let v=0;for(;c<=D;)if(console.log(c),m=="daily"?o.push(S.fromBlank(new Date(c),C,b,!0,A)):m=="weekly"?r.includes(c.getDay())&&o.push(S.fromBlank(new Date(c),C,b,!0,A)):m=="biweekly"&&(v%2==0&&r.includes(c.getDay())&&o.push(S.fromBlank(new Date(c),C,b,!0,A)),v++),c.setDate(c.getDate()+1),T)for(;c.getDay()==0||c.getDay()==6;)c.setDate(c.getDate()+1);console.log(o),j(o)},children:"Add Conflicts"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{i()},children:"Close"})]})]})}function Ae({conflictResponseDate:s}){return e.jsx("div",{className:"SimpleConflictResponseDisplayTile",id:"simple-conflict-response-display-tile-"+s.date.toISOString(),children:e.jsx("div",{className:"header",children:e.jsxs("div",{className:"CharacterNameDiv",children:[e.jsxs("label",{htmlFor:"Actor",children:["Date: ",s.date.toDateString()]}),e.jsx("br",{}),e.jsx("br",{}),s.canAttend?e.jsxs("label",{htmlFor:"Actor",children:[s.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",s.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}):e.jsx("label",{htmlFor:"Actor",children:"Can't Attend"}),s.note!=""&&e.jsx("br",{}),s.note!=""&&e.jsx("br",{}),s.note!=""&&e.jsxs("label",{htmlFor:"Actor",children:["Note: ",s.note]})]})})})}function Ie({dialogRef:s,close:i,addDay:j}){const[m,a]=l.useState(),[u,h]=l.useState(),[D,y]=l.useState(),[C,F]=l.useState("");return e.jsx("dialog",{ref:s,children:e.jsxs("div",{className:"AddAdditionalDayDialog",children:[e.jsx("h2",{children:"Add Additional Day"}),e.jsx("label",{children:"Date"}),e.jsx("input",{type:"date",onChange:b=>{const f=new Date(b.target.value);f.setDate(f.getDate()+1),f.setHours(0,0,0,0),a(f)}}),e.jsx("br",{}),e.jsx("label",{children:"Start Time"}),e.jsx("input",{type:"time",onChange:b=>{console.log(b.target.value);const f=new Date,A=b.target.value.split(":");f.setHours(parseInt(A[0]),parseInt(A[1]),0,0),h(f),console.log({date:f})}}),e.jsx("br",{}),e.jsx("label",{children:"End Time"}),e.jsx("input",{type:"time",onChange:b=>{console.log(b.target.value);const f=new Date,A=b.target.value.split(":");f.setHours(parseInt(A[0]),parseInt(A[1]),0,0),y(f),console.log({date:f})}}),e.jsx("h3",{children:"More Info"}),e.jsx("input",{type:"text",className:"MoreInfoInput",value:C,onChange:b=>{F(b.target.value)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{j(E.fromBlank(H.fromBlank(m,u,D),C))},children:"Add Day"}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{i()},children:"Close"})]})})}ce(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(Ne,{})}));function Ne(){var Y;const[s,i]=l.useState(""),[j,m]=l.useState(""),[a,u]=l.useState(),[h,D]=l.useState(null),[y,C]=l.useState(null),[F,b]=l.useState(null),[f,A]=l.useState(null),[B,r]=l.useState([]),[x,T]=l.useState([]),[J,o]=l.useState("setDates"),[c,v]=l.useState(!1),[P,_]=l.useState("student"),[M,q]=l.useState([]),[G,ee]=l.useState(!0),[K,te]=l.useState(null),[R,Q]=l.useState(!1),[ne,se]=l.useState(),[ae,le]=l.useState([]);l.useState([]);const W=l.useRef(null),$=l.useRef(null),U=l.useRef(null),[O,V]=l.useState(!1);l.useEffect(()=>{async function n(){de(()=>{});const t=new URLSearchParams(window.location.search),d=t.get("activityId");let g=null;d&&(i(d),g=await be(d));const p=t.get("showId");p&&m(p);let w;const I=localStorage.getItem(`show-${p}`);if(I){w=Z.fromMap(JSON.parse(I)),u(w);let k=[];for(const N of w.characters)N.actor&&k.push(N.actor);w.ensemble&&(k=[...k,...w.ensemble.actors]),k=k.filter((N,oe,re)=>oe===re.findIndex(ie=>ie.userId===N.userId)),le(k),console.log(w),pe(d,p).then(N=>{q(N),console.log(N)})}else w=await De(d,p);const L=localStorage.getItem("accountType");if(L){if(_(L),console.log(L),console.log(z()),L=="teacher"&&g){if(g.teachers.findIndex(k=>k.userId==z())==-1){window.location.href=`/Activities/?activityJoinCode=${g.joinCode}&redirect=${window.location.pathname+window.location.search.replace(/&/g,"~")}`;return}}else if(L=="student"&&g&&g.students.findIndex(k=>k.userId==z())==-1){window.location.href=`/Activities/?activityJoinCode=${g.joinCode}&redirect=${window.location.pathname+window.location.search.replace(/&/g,"~")}`;return}if(L=="student"&&w&&w.conflictForm){const k=[];w.conflictForm.dates.map(N=>{k.push(S.fromBlank(N.date.date,null,null,!1,""))}),T(k)}}}n()},[]);function X(){return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"ActionBtn",onClick:()=>{var n;(n=U.current)==null||n.showModal()},children:"Add Additional Day"}),e.jsx("div",{className:"conflicts",children:B.map((n,t)=>e.jsx(ye,{conflict:n,canDelete:!0,onDelete:()=>{const d=[...B];d.splice(t,1),r(d)},setConflict:d=>{const g=[...B];g[t]=d,r(g)}},n.date.date.toISOString()))}),e.jsx("br",{}),c?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(v(!0),K==null&&!O){alert("Please set a form deadline"),v(!1);return}const n=Z.fromMap(a.toMap());if(O){n.conflictForm.dates=B,u(n),await Ce(s,j,n.conflictForm),V(!1),v(!1);return}n.conflictForm=he.fromBlank(B,K,Date.now()),u(n),console.log(n),await ve(s,j,n.conflictForm),v(!1)},children:"Save Conflict Form"}),e.jsx("br",{}),!O&&e.jsx("button",{className:"ActionBtn",onClick:()=>{o("setDates"),r([])},children:"Back"})]})}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",children:e.jsx("h1",{children:"Conflict Form"})}),e.jsxs("div",{className:"center",children:[!(a!=null&&a.conflictForm)&&P=="teacher"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Create Conflict Form"}),e.jsx("br",{}),J=="setDates"?e.jsxs(e.Fragment,{children:[" ",e.jsx("label",{children:"Start Date"}),e.jsx("input",{type:"date",onChange:n=>{console.log(new Date(n.target.value));const t=new Date(n.target.value);t.setDate(t.getDate()+1),t.setHours(0,0,0,0),D(t)}}),e.jsx("br",{}),e.jsx("label",{children:"End Date"}),e.jsx("input",{type:"date",onChange:n=>{const t=new Date(n.target.value);t.setDate(t.getDate()+1),t.setHours(0,0,0,0),C(t)}}),e.jsx("br",{}),e.jsx("label",{children:"Default Rehersal Start Time"}),e.jsx("input",{type:"time",onChange:n=>{console.log(n.target.value);const t=new Date,d=n.target.value.split(":");t.setHours(parseInt(d[0]),parseInt(d[1]),0,0),b(t),console.log({date:t})}}),e.jsx("br",{}),e.jsx("label",{children:"Default Rehersal End Time"}),e.jsx("input",{type:"time",onChange:n=>{console.log(n.target.value);const t=new Date,d=n.target.value.split(":");t.setHours(parseInt(d[0]),parseInt(d[1]),0,0),A(t),console.log({date:t})}}),e.jsx("br",{}),e.jsx("label",{children:"Exclude Weekends"}),e.jsx("input",{type:"checkbox",checked:G,onChange:n=>{ee(n.target.checked)}}),e.jsx("br",{}),e.jsx("label",{children:"Form Deadline"}),e.jsx("input",{type:"date",onChange:n=>{const t=new Date(n.target.value);t.setDate(t.getDate()+1),t.setHours(0,0,0,0),te(t)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{if(h&&y&&F&&f){const n=[],t=new Date(h);for(console.log("Start Date"),console.log(t);t<=y;)if(console.log(t),n.push(E.fromBlank(H.fromBlank(new Date(t),F,f),"")),t.setDate(t.getDate()+1),G)for(;t.getDay()==0||t.getDay()==6;)t.setDate(t.getDate()+1);r(n),o("editDates"),console.log(n)}},children:"Next"})," "]}):X()]}):P=="teacher"&&!R&&!O?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Conflict Form Responses"}),e.jsx("div",{className:"conflicts",children:M.map(n=>e.jsxs("div",{className:"conflict-response",children:[n.actor.name,e.jsx("br",{}),e.jsxs("div",{className:"conflict-response-dates",children:[n.dates.map(t=>t.canAttend?e.jsxs("div",{className:"conflict-response-date",children:[t.date.toDateString(),e.jsx("br",{}),t.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})," - ",t.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"}),t.note!=""&&e.jsx("br",{}),t.note!=""&&e.jsxs("label",{htmlFor:"Actor",children:["Note: ",t.note]})]}):e.jsxs("div",{className:"conflict-response-date",children:[t.date.toDateString(),e.jsx("br",{}),"Can't Attend"]})),e.jsx("button",{className:"ActionBtn",onClick:async()=>{const t=[...M];t.splice(M.indexOf(n),1),q(t),await ge(s,j,n)},children:"Delete"})]})]}))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{r(a.conflictForm.dates),V(!0)},children:"Edit Conflict Form"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var n;(n=W.current)==null||n.showModal()},children:"Add Conflict Response"}),e.jsx("button",{className:"ActionBtn",onClick:async()=>{const n=window.location.href;await navigator.clipboard.writeText(n),alert("Link copied to clipboard")},children:"Share Conflict Form"})]}):P=="teacher"&&O?X():M.length==0&&(a==null?void 0:a.formStatus)=="open"||R?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Conflict Form"}),e.jsx("p",{children:"Select can attend even if you can't make the full rehersal, just add a conflict"}),e.jsxs("div",{className:"quick-actions",children:[e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;const n=[];(t=a==null?void 0:a.conflictForm)==null||t.dates.map(d=>{n.push(S.fromBlank(d.date.date,null,null,!0,""))}),T(n)},children:"I can attend all the rehersals"}),e.jsx("button",{className:"ActionBtn",onClick:n=>{var t;(t=$.current)==null||t.showModal()},children:"Add recurring conflict"})]}),e.jsx("div",{className:"conflicts",children:(Y=a==null?void 0:a.conflictForm)==null?void 0:Y.dates.map((n,t)=>(console.log(n),e.jsx(ke,{conflict:n,conflictResponseDate:x[t],setConflict:d=>{const g=[...x];console.log(g),g[t]=d,T(g)}})))}),e.jsx("br",{}),c?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{v(!0);const n=x.filter(p=>p.canAttend&&p.from||!p.canAttend);let t;R?t=ne:t=await je();const d=ue.fromBlank(n,"",t,s,j,Date.now());console.log(d),await fe(s,j,d);const g=[...M];g.push(d),q(g),v(!1),Q(!1)},children:"Submit Conflict Form"})]}):(a==null?void 0:a.formStatus)=="open"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Conflict Form Response"}),e.jsx("div",{className:"conflicts",children:M[0].dates.map(n=>e.jsx(Ae,{conflictResponseDate:n}))})]}):e.jsx(e.Fragment,{children:e.jsx("h2",{children:"Conflict Form Closed"})}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href=`/Activity/Shows/Show/?activityId=${s}&showId=${j}`},children:"Close"})]}),e.jsx(Fe,{dialogRef:$,addConflicts:n=>{const t=[...x];n.map(d=>{var w;if(console.log("FInding conflict"),console.log(d),x.findIndex(I=>(console.log("Checking date"),console.log(I.date.toDateString()),I.date.toDateString()==d.date.toDateString()))==-1)return;const g=x.findIndex(I=>I.date.toDateString()==d.date.toDateString());console.log("Index"),console.log(g),console.log("Current Conflicts"),console.log((w=a==null?void 0:a.conflictForm)==null?void 0:w.dates),console.log(x);const p=a.conflictForm.dates[g];p.date.from&&d.from<p.date.from&&(d.from=p.date.from),p.date.to&&d.to>p.date.to&&(d.to=p.date.to),t[t.findIndex(I=>I.date.toDateString()==d.date.toDateString())]=d}),T(t),$.current.close()},close:()=>{$.current.close()}}),e.jsx(Se,{dialogRef:W,close:()=>{W.current.close()},students:ae,parents:[],teachers:[],addedMembers:[],addUser:n=>{n instanceof me&&se(n),W.current.close(),Q(!0)}}),e.jsx(Ie,{dialogRef:U,close:()=>{U.current.close()},addDay:n=>{const t=[...B];t.push(n),r(t),U.current.close()}})]})}
