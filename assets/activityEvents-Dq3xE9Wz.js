import{c as re,j as t,r as o,i as de,n as ue,I as me}from"./index-DdbGL9Ax.js";import{X as he,h as ge,Y as ve,Z as pe,_ as fe}from"./db-BSKwQBwX.js";import{B as Se,C as Z}from"./Calendar-BaAQ5KLE.js";re(document.getElementById("root")).render(t.jsx(o.StrictMode,{children:t.jsx(xe,{})}));function xe(){const[_,q]=o.useState("student"),[b,O]=o.useState([]),[I,$]=o.useState([]),[R,z]=o.useState(null),[J,k]=o.useState(!1),[A,G]=o.useState([]),[a,K]=o.useState(),[P,U]=o.useState("students"),[Q,y]=o.useState("date"),[D,N]=o.useState(null),[v,p]=o.useState(null),[f,S]=o.useState(null),[L,F]=o.useState(""),[M,H]=o.useState(""),[W,x]=o.useState(""),[ee,j]=o.useState(""),[u,m]=o.useState(void 0),[h,g]=o.useState([]),[T,B]=o.useState("students"),[te,je]=o.useState(!1);o.useState(""),o.useState(""),o.useState(null),o.useState(null);const[ne,Te]=o.useState(""),[V,Y]=o.useState(!1),[se,ae]=o.useState(null),[E,C]=o.useState(void 0);o.useEffect(()=>{de(()=>{});async function e(){k(!0);const i=new URLSearchParams(window.location.search).get("activityId");if(i){z(i);const c=await ge(i);K(c),console.log(c),m(c.defaultLocation)}const l=await ve(i);console.log(l),O(l);const w=[];for(const c of l){console.log(c);const r=c.date.from;console.log(c.date.date),r.setDate(c.date.date.getDate()),r.setMonth(c.date.date.getMonth()),r.setFullYear(c.date.date.getFullYear());const d=c.date.to;d.setDate(c.date.date.getDate()),d.setMonth(c.date.date.getMonth()),d.setFullYear(c.date.date.getFullYear()),console.log(r),console.log(d),w.push({title:c.name,start:r.toISOString(),end:d.toISOString(),isAllDay:!1,interactive:!0,description:c.info,color:c.eventType.color.setAlpha(.8).toRBGAString(),id:c.id,location:c.location.name})}$(w),console.log(l),console.log(w),k(!1)}e();const s=localStorage.getItem("accountType");s&&q(s)},[]);function X(){return b}const oe=e=>{const s=e.target.value,[n,i]=s.split(":").map(Number),l=new Date(D);l.setHours(n,i,0,0),p(l),x(l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},ie=e=>{const s=e.target.value,[n,i]=s.split(":").map(Number),l=new Date(D);l.setHours(n,i,0,0),S(l),j(l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};Date.prototype.addHours=function(e){return this.setTime(this.getTime()+e*60*60*1e3),this};function le(){return t.jsxs("div",{className:"custom-invite-view",children:[t.jsx("button",{className:P=="students"?"selected":"",onClick:()=>{U("students")},children:"Students"}),t.jsx("button",{className:P=="parents"?"selected":"",onClick:()=>{U("parents")},children:"Parents"}),t.jsx("div",{className:"current-view",children:P=="students"?t.jsx("div",{className:"students",children:a==null?void 0:a.students.map((e,s)=>t.jsxs("div",{className:"student",children:[t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"student",checked:h.find(n=>n.userId==e.userId)!=null,onChange:n=>{n.target.checked?g([...h,e]):g(h.filter(i=>i!=e))}}),t.jsx("span",{className:"checkmark",children:" "})]}),t.jsx("label",{htmlFor:e.userId,children:e.name})]},e.userId))}):t.jsx("div",{className:"parents",children:a==null?void 0:a.parents.map((e,s)=>t.jsxs("div",{className:"parent",children:[t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"parent",onChange:n=>{n.target.checked?g([...h,e]):g(h.filter(i=>i!=e))}}),t.jsx("span",{className:"checkmark",children:" "})]}),t.jsx("label",{htmlFor:e.userId,children:e.name})]},e.userId))})})]})}function ce(){return t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"mode",children:"Enter Rehersal Information"}),t.jsx("label",{htmlFor:"Name",children:"Name: "}),t.jsx("input",{type:"text",value:L,onChange:e=>{F(e.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"Description",children:"Description: "}),t.jsx("textarea",{value:M,onChange:e=>{H(e.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"",children:"Date: "}),t.jsx("input",{type:"date",value:D==null?void 0:D.toISOString().split("T")[0],onChange:e=>{const s=new Date(e.target.value);s.setHours(0,0,0,0),s.setDate(s.getDate()+1),N(s);const n=new Date(s);n.setHours(v.getHours(),v.getMinutes(),0,0),p(n),x(n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const i=new Date(s);i.setHours(f.getHours(),f.getMinutes(),0,0),S(i),j(i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),t.jsx("input",{type:"time",value:W,onChange:oe}),t.jsx("br",{}),t.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),t.jsx("input",{type:"time",value:ee,onChange:ie}),t.jsx("br",{}),t.jsx("label",{htmlFor:"location",children:"Location: "}),t.jsx("select",{name:"location",id:"location",onChange:e=>{m(a==null?void 0:a.locations.find(s=>s.name==e.target.value))},children:a==null?void 0:a.locations.map((e,s)=>t.jsx("option",{value:e.name,selected:(u==null?void 0:u.name)==e.name,children:e.name+" ("+e.address+")"},s))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),t.jsx("select",{name:"eventType",id:"event-type",onChange:e=>{C(a==null?void 0:a.eventTypes.find(s=>s.name==e.target.value))},children:a==null?void 0:a.eventTypes.map((e,s)=>t.jsx("option",{value:e.name,selected:(E==null?void 0:E.name)==e.name,children:e.name},s))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"inviteType",children:"Invite Type: "}),t.jsxs("select",{name:"inviteType",id:"invite-type",onChange:e=>{B(e.target.value)},children:[t.jsx("option",{value:"students",selected:T=="students",children:"Students"}),t.jsx("option",{value:"parents",selected:T=="parents",children:"Parents"}),t.jsx("option",{value:"groups",selected:T=="groups",children:"Groups"}),t.jsx("option",{value:"custom",selected:T=="custom",children:"Custom"})]}),T=="groups"?t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("label",{htmlFor:"groups",children:"Groups: "}),t.jsx("div",{className:"groups",children:a.groups.map((e,s)=>t.jsxs("div",{className:"group",children:[t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:A.find(n=>n.groupName==e.groupName)!=null,onChange:n=>{n.target.checked?(G([...A,e]),g([...h,...e.groupMembers])):(G(A.filter(i=>i.groupName!=e.groupName)),g(h.filter(i=>!e.groupMembers.includes(i))))}}),t.jsx("span",{className:"checkmark",children:" "})]}),t.jsx("label",{htmlFor:e.groupName,children:e.groupName})]},e.groupName))})]}):t.jsx(t.Fragment,{}),T=="custom"?le():t.jsx(t.Fragment,{}),t.jsx("br",{}),J?t.jsx("div",{className:"loader"}):t.jsx("button",{onClick:async()=>{if(k(!0),console.log(`Name: ${L}, Description: ${M}, Start Time: ${v}, End Time: ${f}, Selected Location: ${u},Event Type: ${E}`),L==""||M==""||v==null||f==null||u==null||E==null){alert("Please fill out all fields"),console.log(`Name: ${L}, Description: ${M}, Start Time: ${v}, End Time: ${f}, Selected Location: ${u},  Event Type: ${E}`),k(!1);return}console.log("Submit");const e=u??a.locations[0];console.log(v),console.log(f);const s=ue.fromBlank(D,v,f);console.log(s.toMap());const n=me.fromBlank(L,M,e,s,"activity-event",Date.now(),R,A.map(i=>i.groupName),h,T,E,A,te,ne,[],a.name);if(console.log(n),V){n.id=se.id,await pe(n),Y(!1);const i=n.date.from,l=n.date.to,w={title:n.name,start:i.toISOString(),end:l.toISOString(),isAllDay:!1,interactive:!0,description:n.info,color:n.eventType.color.setAlpha(.8).toRBGAString(),id:n.id,location:n.location.name},c=I.filter(d=>d.id!=n.id);c.push(w),$(c);const r=b.filter(d=>d.id!=n.id);r.push(n),console.log(r),O([...r])}else{await fe(n);const i=n.date.from,l=n.date.to,w={title:n.name,start:i.toISOString(),end:l.toISOString(),isAllDay:!1,interactive:!0,description:n.info,color:n.eventType.color.setAlpha(.8).toRBGAString(),id:n.id,location:n.location.name};$([...I,w]),O([...b,n])}k(!1),y("date"),N(null),p(null),S(null),F(""),H(""),x(""),j(""),C(a==null?void 0:a.eventTypes[0]),m(a==null?void 0:a.defaultLocation),g([]),B("students")},className:"ActionBtn",children:V?"Save":"Submit"}),t.jsx("button",{onClick:()=>{if(V){y("date"),N(null),p(null),S(null),F(""),H(""),x(""),j(""),m(a.defaultLocation),C(a.eventTypes[0]),m(a==null?void 0:a.defaultLocation),Y(!1);return}y("date"),H(""),F(""),B("students")},className:"ActionBtn",children:"Back"})]})}return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:Se,alt:"back arrow",onClick:()=>{window.location.href="/Activity/?activityId="+R}}),t.jsx("h1",{children:"Calendar"})]}),J?t.jsx("div",{className:"center",children:t.jsx("div",{className:"loader"})}):t.jsx("div",{className:"center",children:_=="teacher"?Q=="date"?t.jsx(Z,{canViewConflicts:!1,isCreating:!0,canOpenContextMenu:!0,events:I,editEvent:e=>{const s=X().find(n=>n.id==e.id);console.log(e.id),s&&(console.log(s),y("info"),F(s.name),H(s.info),N(s.date.date),p(s.date.from),x(s.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),S(s.date.to),j(s.date.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),m(s.location),g(s.targets),console.log("FROM EDIT"),console.log(s.targets),C(s.eventType),Y(!0),B(s.generalTarget),ae(s),G(s.groupTargets))},viewEvent:e=>{const s=X().find(n=>n.id==e.id);s&&(localStorage.setItem("event",JSON.stringify(s.toMap())),localStorage.setItem("back","/Activity/Events/?activityId="+R),window.location.href="/Calendar/Event/")},viewConflicts:e=>{},deleteEvent:async e=>{console.log(e);const s=b.find(l=>l.id==e.id),n=b.filter(l=>l.id!=e.id);O(n);const i=I.filter(l=>l.id!=e.id);$(i),await he(s)},dateClick:e=>{console.log(e.date),N(e.date),new Date(e.date).setHours(0,0,0,0),p(new Date(e.date)),x(e.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const n=new Date(e.date);S(n.addHours(1)),console.log(n),j(e.date.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),m(a.defaultLocation),C(a.eventTypes[0]),y("info")},eventClick:e=>{N(e.event.start),new Date(e.event.start).setHours(0,0,0,0),p(new Date(e.event.start)),x(e.event.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const n=new Date(e.event.end);S(n),j(n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),m(a.defaultLocation),C(a.eventTypes[0]),y("info")}}):ce():t.jsx(Z,{viewEvent:e=>{},canViewConflicts:!1,events:I,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventIdClick:e=>{const s=b.find(n=>n.id===e);s&&(localStorage.setItem("event",JSON.stringify(s.toMap())),localStorage.removeItem("back"),window.location.href="/Calendar/Event/")}})})]})}
