import{r,j as e,c as we,i as ye}from"./index-CBYUpoa4.js";import{k as ae,y as ie}from"./constants-CiIGZTLG.js";import{a4 as ke,a5 as de,i as Fe,a6 as Ie,a7 as Be}from"./db-CHdH9QDA.js";import{B as Le,C as Se}from"./Calendar-CJUTpXW1.js";import{T as Me}from"./trash-BnpXJPEK.js";import"./arrow_forward-CHD_SwLW.js";function Re({dialogRef:Z,close:X,addDate:f,eventDate:D}){const[S,y]=r.useState(new Date),[B,G]=r.useState(new Date),[H,k]=r.useState(new Date),[N,L]=r.useState(""),[n,x]=r.useState(""),T=l=>{const i=l.target.value,[h,u]=i.split(":").map(Number),c=new Date(S);c.setHours(h,u,0,0),G(c),L(c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},d=l=>{const i=l.target.value,[h,u]=i.split(":").map(Number),c=new Date(S);c.setHours(h,u,0,0),k(c),x(c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};return r.useEffect(()=>{D&&(y(D.date),G(D.from),k(D.to),L(D.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),x(D.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})))},[D]),e.jsxs("dialog",{ref:Z,className:"AddEventDateDialog",children:[e.jsx("h2",{children:"Add Event Date"}),e.jsx("label",{htmlFor:"",children:"Date: "}),e.jsx("input",{type:"date",value:S==null?void 0:S.toISOString().split("T")[0],onChange:l=>{const i=new Date(l.target.value);i.setHours(0,0,0,0),i.setDate(i.getDate()+1),y(i);const h=new Date(i);h.setHours(B.getHours(),B.getMinutes(),0,0),G(h),L(h.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const u=new Date(i);u.setHours(H.getHours(),H.getMinutes(),0,0),k(u),x(u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),e.jsx("input",{type:"time",value:N,onChange:T}),e.jsx("br",{}),e.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),e.jsx("input",{type:"time",value:n,onChange:d}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"ActionBtn",onClick:()=>{X()},children:"Close"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{f(ae.fromBlank(S,B,H))},children:"Add Date"})]})]})}function Oe({close:Z,dialogRef:X,events:f,activity:D}){const[S,y]=r.useState("schedule"),[B,G]=r.useState(!1),[H,k]=r.useState(!1);function N(d){const l=Object.keys(d[0]),i=d.map(h=>l.map(u=>h[u]).join(","));return[l.join(","),...i].join(`
`)}const L=()=>{const d=[];B&&(f=T(f));for(let c=0;c<f.length;c++){const g=f[c];d.push({Date:g.date.date.getMonth()+1+"/"+g.date.date.getDate()+"/"+g.date.date.getFullYear().toString().slice(2),Start:g.date.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}),End:g.date.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}),Name:g.name,Location:g.location.name==D.defaultLocation.name?"default":g.location.name,"Event Type":g.eventType.name,"Extra Info":g.info,"Invite Type":g.generalTarget,"Custom/Group Targets":g.groupTargets.map(C=>C.groupName).join(", "),"Added to Campus Connect":""})}d.sort((c,g)=>c.Date==g.Date?c.Start==g.Start?c.End>g.End?1:-1:c.Start>g.Start?1:-1:c.Date>g.Date?1:-1);const l=N(d),i=new Blob([l],{type:"text/csv"}),h=window.URL.createObjectURL(i),u=document.createElement("a");u.href=h,u.download=S+".csv",u.click(),window.URL.revokeObjectURL(h)};function n(d,l,i,h){const u=new Date(d,l,1);let c=0;for(;u.getMonth()===l;){if(u.getDay()===i&&(c++,c===h))return u;u.setDate(u.getDate()+1)}return n(d,l+1,i,1)}function x(d){const l=d.getDay(),i=d.getFullYear()+1,h=d.getMonth();let u=1;const c=new Date(d);for(c.setDate(1);c.getMonth()===h;){if(c.getDay()===l){if(c.getDate()===d.getDate())break;u++}c.setDate(c.getDate()+1)}return n(i,h,l,u)}function T(d){return d.map(l=>{const i=x(l.date.date),h=ae.fromBlank(i,l.date.from,l.date.to);return ie.fromBlank(l.name,l.info,l.location,h,l.type,l.lastUpdated,l.activityId,l.groupNames,l.targets,l.generalTarget,l.eventType,l.groupTargets,l.hasSchoolEvent,l.schoolEventId,l.conflicts,l.activityName)})}return e.jsxs("dialog",{ref:X,children:[e.jsx("h2",{children:"Export Schedule"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:S,onChange:d=>{y(d.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Move Schedule Forward a Year? "}),e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:B,onChange:d=>{G(d.target.checked)}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("br",{}),H?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(S==""){alert("Please fill out all fields");return}k(!0),L(),k(!1)},children:"Export Schedule"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{Z()},children:"Close"})]})]})}const Ye="data:image/png;base64,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";function Ge({close:Z,dialogRef:X,activity:f,addEvents:D}){const[S,y]=r.useState(!1),[B,G]=r.useState(null),[H,k]=r.useState([]),N=r.useRef(null);function L(x){const T=x.split(`
`),d=[],l=T[0].split(",");for(let i=1;i<T.length;i++){const h={},u=T[i].split(",");for(let c=0;c<l.length;c++)h[l[c]]=u[c];d.push(h)}return JSON.stringify(d)}function n(x){const T=JSON.parse(x),d=[];for(let l=0;l<T.length;l++){const i=T[l];if(i["Added to Campus Connect"].toLowerCase()=="yes")continue;const h=new Date(i.Date),u=new Date(h.toDateString()+" "+i.Start),c=new Date(h.toDateString()+" "+i.End),g=ae.fromBlank(h,u,c),C=i.Name;let b=i.Location;b=="default"?b=f.defaultLocation:b=f.locations.find(Y=>Y.name==b);const P=f.eventTypes.find(Y=>Y.name==i["Event Type"]),M=i["Extra Info"],K=i["Invite Type"],F=[],_=[],w=[];if(K=="groups"){const Y=i["Custom/Group Targets"].split(", ");for(let A=0;A<Y.length;A++){const j=f.groups.find(v=>v.groupName==Y[A]);j&&(F.push(j),_.push(j.groupName),j.groupMembers.forEach(v=>{w.find(I=>I.userId==v.userId)||w.push(v)}))}}else if(K=="custom"){const Y=i["Custom/Group Targets"].split(", ");for(let A=0;A<Y.length;A++){const j=f.students.find(v=>v.userId==Y[A]);if(j)w.push(j);else{const v=f.parents.find(I=>I.userId==Y[A]);v&&w.push(v)}}}d.push(ie.fromBlank(C,M,b,g,"activity-event",Date.now(),f.id,_,w,K,P,F,!1,"",[],f.name))}return d}return e.jsx("dialog",{ref:X,children:e.jsxs("div",{className:"import-schedule-dialog",children:[e.jsx("h2",{children:"Import Schedule"}),H.length==0?e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"CSV File: "}),e.jsx("input",{type:"file",accept:".csv",ref:N,onChange:x=>{x.target.files&&G(x.target.files[0])}}),S?e.jsx("div",{className:"center-loader",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(B==null){alert("Please select a file");return}y(!0);const x=new FileReader;x.onload=function(T){const d=T.target.result,l=L(d),i=n(l);k(i),console.log(l),console.log(i)},x.readAsText(B),y(!1)},children:"Import Schedule"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{G(null),k([]),Z(),N.current.value=""},children:"Close"})]}):e.jsxs("div",{className:"events-view",children:[e.jsx("h3",{children:"Events"}),e.jsx("div",{className:"events",children:H.map((x,T)=>e.jsxs("div",{className:"event",children:[e.jsxs("div",{className:"event-info",children:[e.jsx("p",{children:x.name}),e.jsx("p",{children:x.info}),e.jsx("p",{children:x.location.name})]}),e.jsxs("div",{className:"event-date-add",children:[e.jsx("p",{children:x.date.date.toDateString()}),e.jsxs("p",{children:[x.date.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})," - ",x.date.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})]})]}),e.jsx("div",{children:e.jsx("img",{src:Ye,alt:"",className:"removeIcon",onClick:()=>{const d=[...H];d.splice(T,1),k(d)}})})]},T))}),S?e.jsx("div",{className:"center-loader",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{y(!0),await D(H),k([]),G(null),y(!1),Z()},children:"Import Schedule"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{G(null),k([]),Z(),N.current.value=""},children:"Close"}),e.jsx("label",{htmlFor:"",className:"hiddenText",children:" s "})]})]})})}we(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(He,{})}));function He(){const[Z,X]=r.useState("student"),[f,D]=r.useState([]),[S,y]=r.useState([]),[B,G]=r.useState(null),[H,k]=r.useState(!1),[N,L]=r.useState([]),[n,x]=r.useState(),[T,d]=r.useState("students"),[l,i]=r.useState("date"),[h,u]=r.useState(null),[c,g]=r.useState(null),[C,b]=r.useState(null),[P,M]=r.useState(""),[K,F]=r.useState(""),[_,w]=r.useState(""),[Y,A]=r.useState(""),[j,v]=r.useState(void 0),[I,V]=r.useState([]),[R,z]=r.useState("students"),[ue,Pe]=r.useState(!1);r.useState(""),r.useState(""),r.useState(null),r.useState(null);const[me,Ke]=r.useState(""),[q,ee]=r.useState(!1),[te,Ae]=r.useState(null),[O,J]=r.useState(void 0),[W,Te]=r.useState(void 0),[ne,he]=r.useState([]),[Ee,De]=r.useState(void 0),oe=r.useRef(null),le=r.useRef(null),re=r.useRef(null),[ge,$]=r.useState(!1);r.useEffect(()=>{ye(()=>{});async function t(){k(!0);const m=new URLSearchParams(window.location.search).get("activityId");if(m){G(m);const p=await Fe(m);x(p),console.log(p),v(p.defaultLocation)}const o=await Ie(m);console.log(o),D(o);const E=[];for(const p of o){console.log(p);const Q=p.date.from;console.log(p.date.date),Q.setDate(p.date.date.getDate()),Q.setMonth(p.date.date.getMonth()),Q.setFullYear(p.date.date.getFullYear());const U=p.date.to;U.setDate(p.date.date.getDate()),U.setMonth(p.date.date.getMonth()),U.setFullYear(p.date.date.getFullYear()),console.log(Q),console.log(U),E.push({title:p.name,start:Q.toISOString(),end:U.toISOString(),isAllDay:!1,interactive:!0,description:p.info,color:p.eventType.color.setAlpha(.8).toRBGAString(),id:p.id,location:p.location.name})}y(E),console.log(o),console.log(E),k(!1)}t();const s=localStorage.getItem("accountType");s&&X(s)},[]);function pe(){return f}const fe=t=>{const s=t.target.value,[a,m]=s.split(":").map(Number),o=new Date(h);o.setHours(a,m,0,0),g(o),w(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},ve=t=>{const s=t.target.value,[a,m]=s.split(":").map(Number),o=new Date(h);o.setHours(a,m,0,0),b(o),A(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};Date.prototype.addHours=function(t){return this.setTime(this.getTime()+t*60*60*1e3),this};function xe(){return e.jsxs("div",{className:"custom-invite-view",children:[e.jsx("button",{className:T=="students"?"selected":"",onClick:()=>{d("students")},children:"Students"}),e.jsx("button",{className:T=="parents"?"selected":"",onClick:()=>{d("parents")},children:"Parents"}),e.jsx("div",{className:"current-view",children:T=="students"?e.jsx("div",{className:"students",children:n==null?void 0:n.students.map((t,s)=>e.jsxs("div",{className:"student",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"student",checked:I.find(a=>a.userId==t.userId)!=null,onChange:a=>{a.target.checked?V([...I,t]):V(I.filter(m=>m!=t))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.userId,children:t.name})]},t.userId))}):e.jsx("div",{className:"parents",children:n==null?void 0:n.parents.map((t,s)=>e.jsxs("div",{className:"parent",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"parent",onChange:a=>{a.target.checked?V([...I,t]):V(I.filter(m=>m!=t))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.userId,children:t.name})]},t.userId))})})]})}function Ne(){return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mode",children:"Enter Event Information"}),e.jsx("label",{htmlFor:"Name",children:"Name: "}),e.jsx("input",{type:"text",value:P,onChange:t=>{M(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Description",children:"Description: "}),e.jsx("textarea",{value:K,onChange:t=>{F(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Date: "}),e.jsx("input",{type:"date",value:h==null?void 0:h.toISOString().split("T")[0],onChange:t=>{const s=new Date(t.target.value);s.setHours(0,0,0,0),s.setDate(s.getDate()+1),u(s);const a=new Date(s);a.setHours(c.getHours(),c.getMinutes(),0,0),g(a),w(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const m=new Date(s);m.setHours(C.getHours(),C.getMinutes(),0,0),b(m),A(m.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),e.jsx("input",{type:"time",value:_,onChange:fe}),e.jsx("br",{}),e.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),e.jsx("input",{type:"time",value:Y,onChange:ve}),e.jsx("br",{}),e.jsx("label",{htmlFor:"location",children:"Location: "}),e.jsx("select",{name:"location",id:"location",onChange:t=>{v(n==null?void 0:n.locations.find(s=>s.name==t.target.value))},children:n==null?void 0:n.locations.map((t,s)=>e.jsx("option",{value:t.name,selected:(j==null?void 0:j.name)==t.name,children:t.name+" ("+t.address+")"},s))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),e.jsx("select",{name:"eventType",id:"event-type",onChange:t=>{J(n==null?void 0:n.eventTypes.find(s=>s.name==t.target.value))},children:n==null?void 0:n.eventTypes.map((t,s)=>e.jsx("option",{value:t.name,selected:(O==null?void 0:O.name)==t.name,children:t.name},s))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"inviteType",children:"Invite Type: "}),e.jsxs("select",{name:"inviteType",id:"invite-type",onChange:t=>{z(t.target.value)},children:[e.jsx("option",{value:"students",selected:R=="students",children:"Students"}),e.jsx("option",{value:"parents",selected:R=="parents",children:"Parents"}),e.jsx("option",{value:"groups",selected:R=="groups",children:"Groups"}),e.jsx("option",{value:"custom",selected:R=="custom",children:"Custom"})]}),R=="groups"?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("label",{htmlFor:"groups",children:"Groups: "}),e.jsx("div",{className:"groups",children:n.groups.map((t,s)=>e.jsxs("div",{className:"group",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:N.find(a=>a.groupName==t.groupName)!=null,onChange:a=>{a.target.checked?(L([...N,t]),V([...I,...t.groupMembers])):(L(N.filter(m=>m.groupName!=t.groupName)),V(I.filter(m=>!t.groupMembers.includes(m))))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.groupName,children:t.groupName})]},t.groupName))})]}):e.jsx(e.Fragment,{}),R=="custom"?xe():e.jsx(e.Fragment,{}),e.jsx("br",{}),ge?e.jsx("div",{className:"loader"}):e.jsx("button",{onClick:async()=>{if($(!0),console.log(`Name: ${P}, Description: ${K}, Start Time: ${c}, End Time: ${C}, Selected Location: ${j},Event Type: ${O}`),P==""||c==null||C==null||j==null||O==null){alert("Please fill out all fields"),console.log(`Name: ${P}, Description: ${K}, Start Time: ${c}, End Time: ${C}, Selected Location: ${j},  Event Type: ${O}`),$(!1);return}console.log("Submit");const t=j??n.locations[0];console.log(c),console.log(C);const s=ae.fromBlank(h,c,C);console.log(s.toMap());const a=[],m=O;m.color.setAlpha(255);const o=ie.fromBlank(P,K,t,s,"activity-event",Date.now(),B,N.map(E=>E.groupName),I,R,m,N,ue,me,[],n.name);if(q){o.id=te.id,te.generalTarget=="groups"&&o.groupTargets.forEach(se=>{se.groupMembers.forEach(je=>{a.find(be=>be.userId==je.userId)||a.push(je)})}),o.targets=[...a],await Be(o),ee(!1);const E=o.date.from,p=o.date.to,Q={title:o.name,start:E.toISOString(),end:p.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.eventType.color.setAlpha(.8).toRBGAString(),id:o.id,location:o.location.name},U=S.filter(se=>se.id!=te.id);console.log(U),console.log(te.id),U.push(Q),y([...U]);const ce=f.filter(se=>se.id!=te.id);ce.push(o),console.log(ce),D([...ce])}else{await de(o);const E=o.date.from,p=o.date.to;E.setDate(o.date.date.getDate()),E.setMonth(o.date.date.getMonth()),E.setFullYear(o.date.date.getFullYear()),p.setDate(o.date.date.getDate()),p.setMonth(o.date.date.getMonth()),p.setFullYear(o.date.date.getFullYear());const Q={title:o.name,start:E.toISOString(),end:p.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.eventType.color.setAlpha(.8).toRBGAString(),id:o.id,location:o.location.name};y([...S,Q]),D([...f,o])}$(!1),i("date"),u(null),g(null),b(null),M(""),F(""),w(""),A(""),J(n==null?void 0:n.eventTypes[0]),v(n==null?void 0:n.defaultLocation),V([]),z("students")},className:"ActionBtn",children:q?"Save":"Submit"}),e.jsx("button",{onClick:()=>{if(q){i("date"),u(null),g(null),b(null),M(""),F(""),w(""),A(""),v(n.defaultLocation),J(n.eventTypes[0]),v(n==null?void 0:n.defaultLocation),ee(!1);return}i("date"),F(""),M(""),z("students")},className:"ActionBtn",children:"Back"})]})}function Ce(){return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mode",children:"Enter Event Information"}),e.jsx("label",{htmlFor:"Name",children:"Name: "}),e.jsx("input",{type:"text",value:P,onChange:t=>{M(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Description",children:"Description: "}),e.jsx("textarea",{value:K,onChange:t=>{F(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),e.jsx("input",{type:"time",value:_,onChange:fe}),e.jsx("br",{}),e.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),e.jsx("input",{type:"time",value:Y,onChange:ve}),e.jsx("br",{}),e.jsx("label",{htmlFor:"location",children:"Location: "}),e.jsx("select",{name:"location",id:"location",onChange:t=>{v(n==null?void 0:n.locations.find(s=>s.name==t.target.value))},children:n==null?void 0:n.locations.map((t,s)=>e.jsx("option",{value:t.name,selected:(j==null?void 0:j.name)==t.name,children:t.name+" ("+t.address+")"},s))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),e.jsx("select",{name:"eventType",id:"event-type",onChange:t=>{J(n==null?void 0:n.eventTypes.find(s=>s.name==t.target.value))},children:n==null?void 0:n.eventTypes.map((t,s)=>e.jsx("option",{value:t.name,selected:(O==null?void 0:O.name)==t.name,children:t.name},s))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"inviteType",children:"Invite Type: "}),e.jsxs("select",{name:"inviteType",id:"invite-type",onChange:t=>{z(t.target.value)},children:[e.jsx("option",{value:"students",selected:R=="students",children:"Students"}),e.jsx("option",{value:"parents",selected:R=="parents",children:"Parents"}),e.jsx("option",{value:"groups",selected:R=="groups",children:"Groups"}),e.jsx("option",{value:"custom",selected:R=="custom",children:"Custom"})]}),R=="groups"?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("label",{htmlFor:"groups",children:"Groups: "}),e.jsx("div",{className:"groups",children:n.groups.map((t,s)=>e.jsxs("div",{className:"group",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:N.find(a=>a.groupName==t.groupName)!=null,onChange:a=>{a.target.checked?(L([...N,t]),V([...I,...t.groupMembers])):(L(N.filter(m=>m.groupName!=t.groupName)),V(I.filter(m=>!t.groupMembers.includes(m))))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.groupName,children:t.groupName})]},t.groupName))})]}):e.jsx(e.Fragment,{}),R=="custom"?xe():e.jsx(e.Fragment,{}),e.jsx("br",{}),e.jsx("h2",{children:"Event Dates"}),e.jsx("div",{className:"event-dates",children:ne.map((t,s)=>e.jsxs("div",{className:"event-date",children:[e.jsxs("div",{className:"event-date-title",children:[e.jsx("label",{htmlFor:"",className:"event-date-name",children:t.date.toDateString()}),e.jsx("label",{htmlFor:"",className:"event-date-time",children:t.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})+" - "+t.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})})]}),e.jsx("img",{src:Me,className:"event-date-icon",onClick:()=>{he(ne.filter(a=>a!=t))}})]},s))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var a;if(c==null||C==null){alert("Please fill out start time and end time");return}const t=new Date;t.setHours(0,0,0,0);const s=ae.fromBlank(t,c,C);De(s),(a=oe.current)==null||a.showModal()},children:"Add Date"}),e.jsx("br",{}),ge?e.jsx("div",{className:"loader"}):e.jsx("button",{onClick:async()=>{if($(!0),console.log(`Name: ${P}, Description: ${K}, Start Time: ${c}, End Time: ${C}, Selected Location: ${j},Event Type: ${O}`),P==""||c==null||C==null||j==null||O==null||ne.length==0){alert("Please fill out all fields"),console.log(`Name: ${P}, Description: ${K}, Start Time: ${c}, End Time: ${C}, Selected Location: ${j},  Event Type: ${O}`),$(!1);return}console.log("Submit");const t=j??n.locations[0];console.log(c),console.log(C);const s=[];for(const a of ne){const m=O;m.color.setAlpha(255);const o=ie.fromBlank(P,K,t,a,"activity-event",Date.now(),B,N.map(U=>U.groupName),I,R,m,N,ue,me,[],n.name);await de(o);const E=o.date.from,p=o.date.to;E.setDate(o.date.date.getDate()),E.setMonth(o.date.date.getMonth()),E.setFullYear(o.date.date.getFullYear()),p.setDate(o.date.date.getDate()),p.setMonth(o.date.date.getMonth()),p.setFullYear(o.date.date.getFullYear());const Q={title:o.name,start:E.toISOString(),end:p.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.eventType.color.setAlpha(.8).toRBGAString(),id:o.id,location:o.location.name};s.push(Q),D([...f,o])}y([...S,...s]),$(!1),i("date"),u(null),g(null),b(null),M(""),F(""),w(""),A(""),J(n==null?void 0:n.eventTypes[0]),v(n==null?void 0:n.defaultLocation),V([]),z("students")},className:"ActionBtn",children:q?"Save":"Submit"}),e.jsx("button",{onClick:()=>{if(q){i("date"),u(null),g(null),b(null),M(""),F(""),w(""),A(""),v(n.defaultLocation),J(n.eventTypes[0]),v(n==null?void 0:n.defaultLocation),ee(!1);return}i("date"),F(""),M(""),z("students")},className:"ActionBtn",children:"Back"})]})}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"page-title",children:[e.jsx("img",{src:Le,alt:"back arrow",onClick:()=>{if(l!="date"){if(i("date"),q){i("date"),u(null),g(null),b(null),M(""),F(""),w(""),A(""),v(n.defaultLocation),J(n.eventTypes[0]),v(n==null?void 0:n.defaultLocation),ee(!1);return}i("date"),F(""),M(""),z("students");return}window.location.href="/Activity/?activityId="+B}}),e.jsx("h1",{children:"Events"})]}),H?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:l!="date"?"datePicker hidden":"datePicker",children:[" ",e.jsx(Se,{canPaste:W!=null,canCopy:!0,copyEvent:t=>{const s=f.find(a=>a.id==t.id);for(const a of f)console.log(a.id);Te(s),console.log(s),console.log(t.id)},pasteEvent:t=>{console.log("PASTE EVENT"),console.log(t);const s=new Date(t);s.setHours(0,0,0,0),u(s),g(new Date(W.date.from)),w(W.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const a=new Date(W.date.to);b(a),console.log(a),A(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),v(W.location),J(W.eventType),M(W.name),F(W.info),V(W.targets),z(W.generalTarget),L(W.groupTargets),i("info")},canViewConflicts:!1,isCreating:!0,canOpenContextMenu:!0,events:S,editEvent:t=>{const s=pe().find(a=>a.id==t.id);console.log(t.id),s&&(console.log(s),i("info"),M(s.name),F(s.info),u(s.date.date),g(s.date.from),w(s.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),b(s.date.to),A(s.date.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),v(s.location),V(s.targets),console.log("FROM EDIT"),console.log(s.targets),J(s.eventType),ee(!0),z(s.generalTarget),Ae(s),L(s.groupTargets))},viewEvent:t=>{const s=pe().find(a=>a.id==t.id);s&&(localStorage.setItem("event",JSON.stringify(s.toMap())),localStorage.setItem("back","/Activity/Events/?activityId="+B),window.location.href="/Calendar/Event/")},viewConflicts:t=>{},deleteEvent:async t=>{console.log(t);const s=f.find(o=>o.id==t.id),a=f.filter(o=>o.id!=t.id);D(a);const m=S.filter(o=>o.id!=t.id);y(m),await ke(s)},dateClick:t=>{console.log(t.date),u(t.date),new Date(t.date).setHours(0,0,0,0),g(new Date(t.date)),w(t.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const a=new Date(t.date);b(a.addHours(1)),console.log(a),A(t.date.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),v(n.defaultLocation),J(n.eventTypes[0]),i("info")},eventClick:t=>{u(t.event.start),new Date(t.event.start).setHours(0,0,0,0),g(new Date(t.event.start)),w(t.event.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const a=new Date(t.event.end);b(a),A(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),v(n.defaultLocation),J(n.eventTypes[0]),i("info")}}),e.jsx("button",{className:"ActionBtn",onClick:()=>{i("multipleEvents"),J(n.eventTypes[0])},children:"Add Multiple Events"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{localStorage.setItem("events",JSON.stringify(f.map(t=>t.toMap()))),window.open("/Activity/Events/Print/","_blank")},children:"Print"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=le.current)==null||t.showModal()},children:"Export to CSV"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=re.current)==null||t.showModal()},children:"Import from CSV"})]}),Z=="teacher"?l=="multipleEvents"?Ce():l=="date"?e.jsx(e.Fragment,{}):Ne():e.jsxs(e.Fragment,{children:[" ",e.jsx(Se,{canPaste:!1,canCopy:!1,copyEvent:()=>{},pasteEvent:()=>{},viewEvent:t=>{},canViewConflicts:!1,events:S,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventIdClick:t=>{const s=f.find(a=>a.id===t);s&&(localStorage.setItem("event",JSON.stringify(s.toMap())),localStorage.removeItem("back"),window.location.href="/Calendar/Event/")}})," ",e.jsx("button",{className:"ActionBtn",onClick:()=>{localStorage.setItem("events",JSON.stringify(f.map(t=>t.toMap()))),window.open("/Activity/Events/Print/","_blank")},children:"Print"})]})]}),e.jsx(Re,{dialogRef:oe,addDate:t=>{he([...ne,t]),oe.current.close()},close:()=>{oe.current.close()},eventDate:Ee}),n!=null&&e.jsx(Oe,{dialogRef:le,events:f,close:()=>{le.current.close()},activity:n}),n!=null&&e.jsx(Ge,{activity:n,dialogRef:re,close:()=>{re.current.close()},addEvents:async t=>{const s=[];for(const a of t){await de(a);const m=a.date.from,o=a.date.to;m.setDate(a.date.date.getDate()),m.setMonth(a.date.date.getMonth()),m.setFullYear(a.date.date.getFullYear()),o.setDate(a.date.date.getDate()),o.setMonth(a.date.date.getMonth()),o.setFullYear(a.date.date.getFullYear());const E={title:a.name,start:m.toISOString(),end:o.toISOString(),isAllDay:!1,interactive:!0,description:a.info,color:a.eventType.color.setAlpha(.8).toRBGAString(),id:a.id,location:a.location.name};s.push(E),D([...f,a])}y([...S,...s])}})]})}
