import{c as M,j as n,r as s,i as T,l as A}from"./index-DnJ92IFj.js";import{S as F,T as R,l as D}from"./constants-CQrCYvr3.js";import{G as k,H as L,I as Y}from"./db-DR_rqsON.js";import{B,C as N}from"./Calendar-BEAttRJ9.js";import{D as O}from"./Download_App_Dialog-2EFYKD9L.js";import"./arrow_forward-CHD_SwLW.js";M(document.getElementById("root")).render(n.jsx(s.StrictMode,{children:n.jsx(b,{})}));function b(){const[G,E]=s.useState("student"),[S,x]=s.useState([]),[y,I]=s.useState([]);s.useState(null);const[j,p]=s.useState(!1),d=s.useRef(null);return s.useEffect(()=>{T(()=>{}),k().then(t=>{t?t instanceof F?t.FCMToken==""&&t.fullname!="Wisdom Pearson"&&t.fullname!="Chandler Harmeyer"&&d.current.showModal():t instanceof R&&t.FCMToken==""&&d.current.showModal():A()});async function f(){p(!0);const t=await L(),h=[];console.log(t),x(t);const m=[];for(const e of t){const v=e instanceof D;let c=null;if(e instanceof D){const l=h.find(o=>o.activityId===e.activityId&&o.showId===e.showId);if(l)c=l;else{const o=await Y(e.activityId,e.showId);o&&(h.push(o),c=o)}}console.log(e);const a=e.date.from;console.log(e.date.date),a.setDate(e.date.date.getDate()),a.setMonth(e.date.date.getMonth()),a.setFullYear(e.date.date.getFullYear());const r=e.date.to;r.setDate(e.date.date.getDate()),r.setMonth(e.date.date.getMonth()),r.setFullYear(e.date.date.getFullYear()),console.log(a),console.log(r);let g=!1,u=!1,C=null,w=null;if(console.log(c),c)for(const l of c.dates){const o=new Date(l.date);o.getDate()===a.getDate()&&o.getMonth()===a.getMonth()&&o.getFullYear()===a.getFullYear()&&(g=!0,l.canAttend&&(u=!0,C=new Date(l.from),w=new Date(l.to)))}m.push({title:e.name,start:a.toISOString(),end:r.toISOString(),isAllDay:!1,interactive:!0,description:e.info+(u?` 
(Excused from ${C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} to ${w.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:g&&!u?` 
(Fully Excused)`:""),color:g&&!u?"black":g?"grey":v?e.rehearsalLocation.color.setAlpha(.8).toRBGAString():e.eventType.color.setAlpha(.8).toRBGAString(),id:e.id,location:v?`${e.rehearsalLocation.name}`:""})}I(m),console.log(t),console.log(m),p(!1)}f();const i=localStorage.getItem("accountType");i&&E(i)},[]),n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("img",{src:B,alt:"back arrow",onClick:()=>{window.location.href="/"}}),n.jsx("h1",{children:"Calendar"})]}),j?n.jsx("div",{className:"center",children:n.jsx("div",{className:"loader"})}):n.jsx("div",{className:"center",children:n.jsx(N,{viewEvent:f=>{},canPaste:!1,canCopy:!1,copyEvent:()=>{},pasteEvent:()=>{},canViewConflicts:!1,events:y,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventIdClick:f=>{const i=S.find(t=>t.id===f);i&&(localStorage.setItem("event",JSON.stringify(i.toMap())),localStorage.removeItem("back"),window.location.href="/Calendar/Event/")}})}),n.jsx(O,{close:()=>{d.current.close()},dialogRef:d})]})}
