import{c as te,j as e,r as a,a as ae,b as Z}from"./index-BrfWEQze.js";import{c as B,g as oe}from"./db-DueI9z1M.js";import{T as ne,L as re,G as se,S as le}from"./constants-BaAdZBoe.js";import{g as ce,a as ie}from"./distance-Dq5bV3Z3.js";te(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(ue,{})}));function ue(){const[l,x]=a.useState(""),[i,f]=a.useState(""),[S,c]=a.useState(!1),[g,W]=a.useState([]),[z,y]=a.useState(""),[v,j]=a.useState("accountType"),[A,N]=a.useState("student"),[I,C]=a.useState("LoginInfo"),[u,P]=a.useState(""),[o,r]=a.useState(""),[k,U]=a.useState(""),[d,b]=a.useState(""),[L,V]=a.useState(""),[T,K]=a.useState(""),[M,G]=a.useState(""),[F,Y]=a.useState(""),[E,$]=a.useState(""),[H,J]=a.useState(!1),_=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],X=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"];return a.useEffect(()=>{async function t(){const n=await oe();W(n),y(n[0].schoolId)}t()},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"center",children:e.jsx("div",{className:"Login",children:v=="accountType"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Account Type"}),e.jsx("button",{className:"actionBtn",onClick:()=>{N("student"),j("login")},children:"Student"}),e.jsx("button",{className:"actionBtn",onClick:()=>{N("teacher"),j("login")},children:"Teacher"})]}):v=="login"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Login"}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{x(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{f(t.target.value)}}),e.jsx("select",{onChange:t=>{y(t.target.value)},children:g.map(t=>e.jsx("option",{value:t.schoolId,children:t.schoolName}))}),S?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"actionBtn",onClick:async()=>{if(c(!0),!await ae(l,i,z)){c(!1),alert("Wrong email or password");return}localStorage.setItem("accountType",A),c(!1);const s=new URLSearchParams(window.location.search).get("redirect");s?window.location.href=s.replace(/~/g,"&"):window.location.href="/"},children:"Login"}),e.jsx("button",{className:"actionBtn",onClick:()=>{j("createAccount")},children:"Create an Account"})]}):A=="teacher"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),e.jsx("input",{type:"text",placeholder:"Full Name",onChange:t=>{P(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{x(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Phone Number",onChange:t=>{r(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{f(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"School Code",onChange:t=>{b(t.target.value)}}),S?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"actionBtn",onClick:async()=>{if(c(!0),u==""){alert("Please enter your full name");return}if(l==""){alert("Please enter your email");return}if(!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(l)){alert("Invalid email");return}if(o==""){alert("Please enter your phone number, if you don't have one, type none");return}r(o.replace(/-/g,"")),r(o.replace(/ /g,"")),r(o.replace(/\(/g,"")),r(o.replace(/\)/g,""));const n=/^\d{10}$/;if(o!="none"&&!n.test(o)){alert("Invalid phone number (Only include numbers or type none)");return}if(i==""){alert("Please enter a password");return}if(i.length<6){alert("Password must be at least 6 characters");return}if(d==""){alert("Please enter your school code");return}const s=g.find(D=>D.schoolTeacherCode==d);if(!s){alert("Invalid School Code");return}localStorage.setItem("schoolId",s.schoolId);const h=ne.fromBlank("",s.schoolId,o.replace("none",""),"","teacher",u.toLowerCase().trim(),u.trim(),l.trim()),m=await Z(l,i);if(!m){alert("Error creating account");return}h.uid=m,await B("teacher",h),localStorage.setItem("accountType","teacher");const p=new URLSearchParams(window.location.search).get("redirect");p?window.location.href=p.replace(/~/g,"&"):window.location.href="/",c(!1)},children:"Create Account"})]}):I=="LoginInfo"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),Q(),e.jsx("button",{onClick:()=>{if(u==""){alert("Please enter your full name");return}if(l==""){alert("Please enter your email");return}if(!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(l)){alert("Invalid email");return}if(o==""){alert("Please enter your phone number, if you don't have one, type none");return}r(o.replace(/-/g,"")),r(o.replace(/ /g,"")),r(o.replace(/\(/g,"")),r(o.replace(/\)/g,""));const n=/^\d{10}$/;if(o!="none"&&!n.test(o)){alert("Invalid phone number (Only include numbers or type none)");return}if(i==""){alert("Please enter a password");return}if(i.length<6){alert("Password must be at least 6 characters");return}if(k==""){alert("Please select your sex");return}C("HomeAddress")},children:"Next"})]}):I=="HomeAddress"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),q(),e.jsx("button",{onClick:()=>{C("SchoolCode")},children:"Next"}),e.jsx("label",{className:"skip-text-button",onClick:()=>{J(!0),C("SchoolCode")},children:"Skip"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),ee(),S?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{onClick:async()=>{c(!0);let t;if(d!=""?t=g.find(w=>w.schoolCode==d):t=g.find(w=>w.schoolDomain==L.split("@")[1]),t==null){d!=""?alert("Invalid School Code"):alert("Invalid School Email"),c(!1);return}let n={lat:0,lon:0},s="",h=0;if(H||(s=T+", "+M+", "+F+", "+E,n=await ce(s),h=ie(n.lat,n.lon,t.location.location.latitude,t.location.location.longitude)),!n&&!H){alert("Invalid Address");return}localStorage.setItem("schoolId",t.schoolId);const m=await Z(l,i);if(!m){alert("Error creating account");return}const R=re.fromBlank("home",s,new se(n.lat,n.lon)),p=le.fromBlank(m,t.schoolId,"unknown",h,"","student",o.replace("none",""),k,"unknown",u.toLowerCase().trim(),u.trim(),l.trim(),{},R);await B("student",p),localStorage.setItem("accountType","student");const O=new URLSearchParams(window.location.search).get("redirect");O?window.location.href=O.replace(/~/g,"&"):window.location.href="/",c(!1)},children:"Create Account"})]})})})});function q(){return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Home Address",value:T,onChange:t=>{K(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"City",value:M,onChange:t=>{G(t.target.value)}}),e.jsxs("select",{value:F,onChange:t=>{Y(t.target.value)},children:[e.jsx("option",{value:"null",selected:!0,children:"Select your State"}),_.map((t,n)=>e.jsx("option",{value:t,children:X[n]}))]}),e.jsx("input",{type:"text",placeholder:"Zip Code",value:E,onChange:t=>{$(t.target.value)}})]})}function Q(){return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Full Name",onChange:t=>{P(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{x(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{f(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Phone Number",onChange:t=>{r(t.target.value)}}),e.jsxs("select",{onChange:t=>{U(t.target.value)},children:[e.jsx("option",{value:"",selected:!0,children:"Select your Sex"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]})}function ee(){return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"School Code",value:d,onChange:t=>{b(t.target.value)}}),e.jsx("p",{children:"Or"}),e.jsx("input",{type:"text",placeholder:"School Email",value:L,onChange:t=>{V(t.target.value)}})]})}}
