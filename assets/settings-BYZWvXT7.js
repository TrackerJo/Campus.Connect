import{r as a,j as e,c as se,i as ae}from"./index-CBYUpoa4.js";import{H as ne,I as K,J as oe,K as le,L as ie,M as re,N as ce,O as de,P as ue,Q as he,R as me,f as xe}from"./db-BmeP-Gam.js";import{n as V,o as w,L as W,G as Y,p as q,q as H,r as E}from"./constants-WQrXGkfb.js";import{g as J}from"./distance-CvoZ9uwc.js";import{A as X}from"./Add_User_Dialog-CgVzQTPV.js";function ge({addRehearsalLocation:u,close:p,dialogRef:s}){const[n,l]=a.useState(""),[m,c]=a.useState("#000000");return e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Add Rehearsal Location"}),e.jsxs("div",{className:"location-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:n,onChange:d=>{l(d.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:m,onChange:d=>{c(d.target.value)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{u(V.fromBlank(n,w(m)))},children:"Add Rehearsal Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]})}const I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAgCAYAAADqgqNBAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAH6ADAAQAAAABAAAAIAAAAABT9vqhAAABMUlEQVRIDe2WO07DQBBAbSsFJE1OQEmgTUGJRDgAxyC5SAo6OAiKUkcK5Ax0IKUDpBSpSOnNG/CKkWVHsr3rRIpXevb6s/N2xlM4CI5hGGNO4BE+YAxRLXkjOoUZ6PHkXY4tgrRYNhF7Tz0Mw5gMn8GkMl2mrt1dklkbrmxE5iPJFmSsoW+fOT0TWMRz2MDABmd+DyvwLsbxO3443qgNdO3c6RmJzfhP+3+UDVw7lelgO8SyhW+41O87mx+q+GtfGYv4wll5dSACd+AFskYj1sWqNqe+Tal1k3lvrldtU/O9invVuihnddJceRl/8rwR59Su4O2jLLX8Vy8ga/hrLvkyGIdZVu75FSfytwx5LeLbHPF5wX4t/jriiZLLj94DnBWPVGIFoneYwh20SoQovWQLokOD66GvfLEAAAAASUVORK5CYII=";function je({addLocation:u,close:p,dialogRef:s,savedLocations:n}){const[l,m]=a.useState(""),[c,d]=a.useState(""),[h,v]=a.useState(void 0),[g,j]=a.useState(!1);return e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Add Location"}),e.jsxs("div",{className:"location-info",children:[n.length>0?e.jsxs(e.Fragment,{children:[" ",e.jsx("h3",{children:"Select from saved locations"}),e.jsxs("select",{name:"",id:"saved-locations",onChange:o=>{v(n.find(N=>N.name==o.target.value))},children:[e.jsx("option",{value:"",selected:!0,children:"Select a location"}),n.map((o,N)=>e.jsxs("option",{value:o.name,children:[o.name," (",o.address,")"]},N))]}),e.jsx("h3",{children:"Or add a new location"})]}):e.jsx("h3",{children:"Add a new location"}),e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:l,onChange:o=>{m(o.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Address: "}),e.jsx("input",{type:"text",value:c,onChange:o=>{d(o.target.value)}}),e.jsx("br",{}),g?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(j(!0),(l==""||c=="")&&h==null){alert("Please fill out all fields"),j(!1);return}if(h){u(h);return}const o=await J(c);console.log(o),u(W.fromBlank(l,c,new Y(o.lat,o.lon),!1)),j(!1)},children:"Add Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]})}function fe({addEventType:u,close:p,dialogRef:s,eventTypes:n}){const[l,m]=a.useState(""),[c,d]=a.useState("#000000");return e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Add Event Type"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:l,onChange:h=>{m(h.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:c,onChange:h=>{d(h.target.value)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{if(l==""){alert("Please fill out all fields");return}if(n.find(h=>h.name==l)){alert("Event type with that name already exists");return}u(q.fromBlank(l,w(c)))},children:"Add Event Type"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]})}function Ae({editLocation:u,close:p,dialogRef:s,location:n}){const[l,m]=a.useState(""),[c,d]=a.useState(""),[h,v]=a.useState(!1);return a.useEffect(()=>{n&&(m(n.name),d(n.address))},[n]),e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Edit Location"}),e.jsxs("div",{className:"location-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:l,onChange:g=>{m(g.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Address: "}),e.jsx("input",{type:"text",value:c,onChange:g=>{d(g.target.value)}}),e.jsx("br",{}),h?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(v(!0),l==""||c==""){alert("Please fill out all fields"),v(!1);return}let g=n.location;if(c!=n.address){const j=await J(c);g=new Y(j.lat,j.lon)}await u(W.fromBlank(l,c,g,n.isSchool)),v(!1)},children:"Edit Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]})}function pe({editEventType:u,close:p,dialogRef:s,eventTypes:n,eventType:l}){const[m,c]=a.useState(""),[d,h]=a.useState("#000000"),[v,g]=a.useState(!1);function j(o,N,y,A){return`#${(1<<24|o<<16|N<<8|y).toString(16).slice(1).toUpperCase()}`}return a.useEffect(()=>{l&&(c(l.name),h(j(l.color.red,l.color.green,l.color.blue,l.color.alpha)))},[l]),e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Edit Event Type"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:m,onChange:o=>{c(o.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:d,onChange:o=>{console.log(o.target.value),h(o.target.value)}}),e.jsx("br",{}),v?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(m==""){alert("Please fill out all fields");return}if(n.find(o=>o.name==m&&o.name!=l.name)){alert("An event type with that name already exists");return}g(!0),await u(q.fromBlank(m,w(d))),g(!1)},children:"Edit Event Type"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]})}function ve({editRehearsalLocation:u,close:p,dialogRef:s,rehearsalLocations:n,rehearsalLocation:l}){const[m,c]=a.useState(""),[d,h]=a.useState("#000000"),[v,g]=a.useState(!1);function j(o,N,y,A){return`#${(1<<24|o<<16|N<<8|y).toString(16).slice(1).toUpperCase()}`}return a.useEffect(()=>{l&&(c(l.name),h(j(l.color.red,l.color.green,l.color.blue,l.color.alpha)))},[l]),e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Edit Rehearsal Location"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Location: "}),e.jsx("input",{type:"text",value:m,onChange:o=>{c(o.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:d,onChange:o=>{console.log(o.target.value),h(o.target.value)}}),e.jsx("br",{}),v?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(m==""){alert("Please fill out all fields");return}if(n.find(o=>o.name==m&&o.name!=l.name)){alert("A rehearsal location with that name already exists");return}g(!0),await u(V.fromBlank(m,w(d))),g(!1)},children:"Edit Rehearsal Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]})}function Ne({editActivityName:u,close:p,dialogRef:s,activityName:n}){const[l,m]=a.useState(""),[c,d]=a.useState(!1);return a.useEffect(()=>{n&&m(n)},[n]),e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Edit Activity Name"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:l,onChange:h=>{m(h.target.value)}}),e.jsx("br",{}),c?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(l==""){alert("Please fill out all fields");return}d(!0),await u(l),d(!1)},children:"Edit Activity Name"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]})}function ye({editGroup:u,close:p,dialogRef:s,group:n,groups:l,activityStudents:m,activityParents:c}){const[d,h]=a.useState(""),[v,g]=a.useState("#000000"),[j,o]=a.useState([]),[N,y]=a.useState(!1),A=a.useRef(null);function S(f,C,b,B){return`#${(1<<24|f<<16|C<<8|b).toString(16).slice(1).toUpperCase()}`}return a.useEffect(()=>{n&&(h(n.groupName),g(S(n.groupColor.red,n.groupColor.green,n.groupColor.blue,n.groupColor.alpha)),o(n.groupMembers))},[n]),e.jsxs(e.Fragment,{children:[e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Edit Group"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:d,onChange:f=>{h(f.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:v,onChange:f=>{console.log(f.target.value),g(f.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Members: "}),e.jsx("div",{className:"MembersList",children:j.map((f,C)=>e.jsxs("div",{className:"GroupMember",children:[e.jsx("label",{htmlFor:"",children:f.name}),e.jsx("button",{className:"ActionBtn",onClick:()=>{o(j.filter(b=>b!=f))},children:"Remove"})]},C))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{A.current.showModal()},children:"Add Member"}),e.jsx("br",{}),N?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(d==""){alert("Please fill out all fields");return}if(l.find(f=>f.groupName==d&&f.groupName!=n.groupName)){alert("A group with that name already exists");return}y(!0),await u(H.fromBlank(d,j,w(v))),y(!1)},children:"Save Group"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]}),e.jsx(X,{students:m,parents:c,teachers:[],dialogRef:A,addedMembers:j,close:()=>{A.current.close()},addUser:f=>{const C=[...j,f],b=[],B=C.filter(R=>b.includes(R.name)?!1:(b.push(R.name),!0));o(B)}})]})}function be({createGroup:u,close:p,dialogRef:s,groups:n,activityStudents:l,activityParents:m}){const[c,d]=a.useState(""),[h,v]=a.useState("#000000"),[g,j]=a.useState([]),[o,N]=a.useState(!1),y=a.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Create Group"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:c,onChange:A=>{d(A.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:h,onChange:A=>{console.log(A.target.value),v(A.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Members: "}),e.jsx("div",{className:"MembersList",children:g.map((A,S)=>e.jsxs("div",{className:"GroupMember",children:[e.jsx("label",{htmlFor:"",children:A.name}),e.jsx("button",{className:"ActionBtn",onClick:()=>{j(g.filter(f=>f!=A))},children:"Remove"})]},S))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{y.current.showModal()},children:"Add Member"}),e.jsx("br",{}),o?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(c==""){alert("Please fill out all fields");return}if(n.find(A=>A.groupName==c)){alert("A group with that name already exists");return}N(!0),await u(H.fromBlank(c,g,w(h))),N(!1)},children:"Create Group"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{p()},children:"Close"})]})]}),e.jsx(X,{students:l,parents:m,teachers:[],dialogRef:y,addedMembers:g,close:()=>{y.current.close()},addUser:A=>{const S=[...g,A],f=[],C=S.filter(b=>f.includes(b.name)?!1:(f.push(b.name),!0));j(C)}})]})}se(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(Ce,{})}));function Ce(){const[u,p]=a.useState(""),[s,n]=a.useState(null),[l,m]=a.useState("student"),c=a.useRef(null),d=a.useRef(null),h=a.useRef(null),[v,g]=a.useState([]),[j,o]=a.useState([]),[N,y]=a.useState([]),[A,S]=a.useState([]),[f,C]=a.useState(!0),[b,B]=a.useState(void 0),[R,z]=a.useState(void 0),[P,Z]=a.useState(void 0),[O,$]=a.useState(void 0),k=a.useRef(null),T=a.useRef(null),M=a.useRef(null),F=a.useRef(null),G=a.useRef(null),D=a.useRef(null),[U,_]=a.useState([]),[Q,ee]=a.useState([]);return a.useEffect(()=>{async function t(){C(!0),ae(()=>{});const i=new URLSearchParams(window.location.search).get("activityId");if(i){p(i);const te=await me();S(te)}const x=await xe(i);x&&(n(x),x instanceof E&&g(x.rehearsalLocations),o(x.eventTypes),y(x.groups),_(x.students),ee(x.parents));const L=localStorage.getItem("accountType");L&&m(L),C(!1)}t()},[]),e.jsxs(e.Fragment,{children:[f?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"title",children:[e.jsxs("h1",{children:["Activity: ",s==null?void 0:s.name]}),e.jsxs("h3",{children:["Join Code: ",s==null?void 0:s.joinCode]}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=F.current)==null||t.showModal()},children:"Edit Activity Name"}),e.jsx("h2",{children:"Saved Locations"}),e.jsx("div",{className:"saved-locations",children:s==null?void 0:s.locations.map((t,r)=>(console.log(t),e.jsxs("div",{className:"saved-location",children:[e.jsxs("label",{htmlFor:"",className:"saved-location-name",children:[t.name," (",t.address,")"]}),e.jsx("img",{src:I,alt:"edit",className:"saved-location-edit",onClick:()=>{var i;B(t),(i=k.current)==null||i.showModal()}})]},r)))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var r;(r=d.current)==null||r.showModal()},children:"Add Location"}),s instanceof E&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Rehearsal Locations"}),e.jsx("div",{className:"rehearsal-locations",children:v.map((t,r)=>(console.log(t.color),e.jsxs("div",{className:"rehearsal-location",children:[e.jsx("label",{htmlFor:"",className:"rehearsal-location-name",children:t.name}),e.jsxs("div",{className:"rehearsal-location-right",children:[e.jsx("div",{className:"rehearsal-location-color",style:{backgroundColor:t.color.toRBGAString()}}),e.jsx("img",{src:I,alt:"",onClick:i=>{var x;Z(t),(x=M.current)==null||x.showModal()}})]})]})))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var r;(r=c.current)==null||r.showModal()},children:"Add Rehearsal Location"})," "]}),e.jsx("h2",{children:"Event Types"}),e.jsx("div",{className:"event-types",children:j.map((t,r)=>e.jsxs("div",{className:"event-type",children:[e.jsx("label",{htmlFor:"",className:"event-type-name",children:t.name}),e.jsxs("div",{className:"event-type-right",children:[e.jsx("div",{className:"event-type-color",style:{backgroundColor:t.color.toRBGAString()}}),e.jsx("img",{src:I,alt:"",onClick:()=>{var i;z(t),(i=T.current)==null||i.showModal()}})]})]}))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var r;(r=h.current)==null||r.showModal()},children:"Add Event Type"}),e.jsx("br",{}),e.jsx("h2",{children:"Groups"}),e.jsx("div",{className:"event-types",children:N.map((t,r)=>e.jsxs("div",{className:"event-type",children:[e.jsx("label",{htmlFor:"",className:"event-type-name",children:t.groupName}),e.jsxs("div",{className:"event-type-right",children:[e.jsx("div",{className:"event-type-color",style:{backgroundColor:t.groupColor.toRBGAString()}}),e.jsx("img",{src:I,alt:"",onClick:()=>{var i;$(t),(i=G.current)==null||i.showModal()}})]})]}))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var r;(r=D.current)==null||r.showModal()},children:"Create Group"}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Activity/?activityId="+u},children:"Back"})]}),e.jsx(ge,{dialogRef:c,addRehearsalLocation:async t=>{var r;if(s instanceof E){const i=[...s.rehearsalLocations];i.push(t),s.rehearsalLocations=i,console.log(i),g(i),await ne(u,i),(r=c.current)==null||r.close()}},close:()=>{var t;(t=c.current)==null||t.close()}}),e.jsx(je,{dialogRef:d,close:()=>{var t;(t=d.current)==null||t.close()},addLocation:async function(t){var r,i;if(A.find(x=>x.name==t.name)){await K(u,t),(r=d.current)==null||r.close(),s.locations.push(t),n(s);return}await K(u,t),await oe(t),S(x=>[...x,t]),s.locations.push(t),n(s),(i=d.current)==null||i.close()},savedLocations:A.filter(t=>!s.locations.find(r=>t.name==r.name))}),e.jsx(fe,{dialogRef:h,close:()=>{var t;(t=h.current)==null||t.close()},addEventType:async t=>{var i;const r=[...s.eventTypes];r.push(t),o(r),await le(u,t),(i=h.current)==null||i.close()},eventTypes:s.eventTypes})]}),e.jsx(Ae,{dialogRef:k,close:()=>{var t;(t=k.current)==null||t.close()},location:b,editLocation:async t=>{var x;const i=[...s.locations].findIndex(L=>L.name==b.name);s.locations.splice(i,1),s.locations.push(t),console.log(s),await ie(u,t,b),n(s),window.location.reload(),(x=k.current)==null||x.close()}}),e.jsx(pe,{eventTypes:(s==null?void 0:s.eventTypes)??[],dialogRef:T,close:()=>{var t;(t=T.current)==null||t.close()},eventType:R,editEventType:async t=>{var x;const i=[...s.eventTypes].findIndex(L=>L.name==R.name);s.eventTypes.splice(i,1),s.eventTypes.push(t),console.log(s),await re(u,t,R,s instanceof E),n(s),window.location.reload(),(x=T.current)==null||x.close()}}),s instanceof E&&e.jsx(ve,{rehearsalLocations:s.rehearsalLocations,dialogRef:M,close:()=>{var t;(t=M.current)==null||t.close()},rehearsalLocation:P,editRehearsalLocation:async t=>{var x;const i=[...s.rehearsalLocations].findIndex(L=>L.name==P.name);s.rehearsalLocations.splice(i,1),s.rehearsalLocations.push(t),console.log(s),await ce(u,t,P),n(s),window.location.reload(),(x=M.current)==null||x.close()}}),e.jsx(Ne,{dialogRef:F,close:()=>{var t;(t=F.current)==null||t.close()},activityName:s==null?void 0:s.name,editActivityName:async t=>{var r;await de(u,t),n(i=>i?(i.name=t,i):null),window.location.reload(),(r=F.current)==null||r.close()}}),e.jsx(ye,{dialogRef:G,activityParents:Q,activityStudents:U,groups:N,close:()=>{var t;(t=G.current)==null||t.close()},group:O,editGroup:async t=>{var x;const i=[...s.groups].findIndex(L=>L.groupName==O.groupName);s.groups.splice(i,1),s.groups.push(t),console.log(s),await ue(u,t,O),n(s),window.location.reload(),(x=G.current)==null||x.close()}}),e.jsx(be,{dialogRef:D,close:()=>{var t;(t=D.current)==null||t.close()},groups:N,activityParents:Q,activityStudents:U,createGroup:async t=>{var i;const r=[...s.groups];r.push(t),y(r),await he(u,t),(i=D.current)==null||i.close()}})]})}
