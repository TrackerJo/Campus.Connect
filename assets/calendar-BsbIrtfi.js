import{c as j,j as t,r as s,i as A}from"./index-C75OlIaX.js";import{i as E}from"./constants-DefHE-sM.js";import{B as F,C as L}from"./db-BBaBM75u.js";import{C as M}from"./Calendar-DuC1w0M8.js";j(document.getElementById("root")).render(t.jsx(s.StrictMode,{children:t.jsx(T,{})}));function T(){const[R,S]=s.useState("student"),[w,x]=s.useState([]),[D,I]=s.useState([]);s.useState(null);const[y,h]=s.useState(!1);return s.useEffect(()=>{A(()=>{});async function d(){h(!0);const l=await F(),m=[];console.log(l),x(l);const g=[];for(const e of l){const v=e instanceof E;let c=null;if(e instanceof E){const a=m.find(n=>n.activityId===e.activityId&&n.showId===e.showId);if(a)c=a;else{const n=await L(e.activityId,e.showId);n&&(m.push(n),c=n)}}console.log(e);const o=e.date.from;console.log(e.date.date),o.setDate(e.date.date.getDate()),o.setMonth(e.date.date.getMonth()),o.setFullYear(e.date.date.getFullYear());const r=e.date.to;r.setDate(e.date.date.getDate()),r.setMonth(e.date.date.getMonth()),r.setFullYear(e.date.date.getFullYear()),console.log(o),console.log(r);let f=!1,u=!1,p=null,C=null;if(console.log(c),c)for(const a of c.dates){const n=new Date(a.date);n.getDate()===o.getDate()&&n.getMonth()===o.getMonth()&&n.getFullYear()===o.getFullYear()&&(f=!0,a.canAttend&&(u=!0,p=new Date(a.from),C=new Date(a.to)))}g.push({title:e.name,start:o.toISOString(),end:r.toISOString(),isAllDay:!1,interactive:!0,description:e.info+(u?` 
(Excused from ${p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} to ${C.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:f&&!u?` 
(Fully Excused)`:""),color:f&&!u?"black":f?"grey":v?e.rehearsalLocation.color.setAlpha(.8).toRBGAString():"blue",id:e.id,location:v?`${e.rehearsalLocation.name}`:""})}I(g),console.log(l),console.log(g),h(!1)}d();const i=localStorage.getItem("accountType");i&&S(i)},[]),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"title",children:t.jsx("h1",{children:"Calendar"})}),y?t.jsx("div",{className:"center",children:t.jsx("div",{className:"loader"})}):t.jsxs("div",{className:"center",children:[t.jsx(M,{viewEvent:d=>{},events:D,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventIdClick:d=>{const i=w.find(l=>l.id===d);i&&(localStorage.setItem("event",JSON.stringify(i)),localStorage.removeItem("back"),window.location.href="/Calendar/Event/")}}),t.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/"},children:"Back"})]})]})}
