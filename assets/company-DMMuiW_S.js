import{r as s,j as e,c as v,i as w}from"./index-U3pxML4x.js";import{a as h,C as L}from"./constants-b6ADl2C6.js";import{ac as N,ah as f,ai as E}from"./db-CbK9Qc0o.js";import{A as D}from"./Add_Location_Dialog-Bt3GjaQv.js";import{E as M}from"./Edit_Location_Dialog-CVUPMahm.js";import"./distance-DNOHIura.js";function g({location:r,onEdit:m,onDelete:u,canEdit:c,canDelete:t}){const[o,d]=s.useState(!1),[l,i]=s.useState(!1);return e.jsxs("div",{className:"location-tile",children:[e.jsx("label",{htmlFor:"",children:r.name}),e.jsx("label",{htmlFor:"",children:r.address}),c?l?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{i(!0),await m(),i(!1)},children:"Edit"}):e.jsx(e.Fragment,{}),t?o?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{d(!0),await u(),d(!1)},children:"Delete"}):e.jsx(e.Fragment,{})]})}function S({editCompanyName:r,close:m,dialogRef:u,companyName:c}){const[t,o]=s.useState(""),[d,l]=s.useState(!1);return s.useEffect(()=>{c&&o(c)},[c]),e.jsxs("dialog",{ref:u,children:[e.jsx("h2",{children:"Edit Company Name"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:t,onChange:i=>{o(i.target.value)}}),e.jsx("br",{}),d?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(t==""){alert("Please fill out all fields");return}l(!0),await r(t),l(!1)},children:"Save"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{m()},children:"Close"})]})]})}v(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(b,{})}));function b(){const[r,m]=s.useState("student"),[u,c]=s.useState(!0),[t,o]=s.useState(null),[d,l]=s.useState(void 0),i=s.useRef(null),p=s.useRef(null),[C,y]=s.useState(!1),x=s.useRef(null);return s.useEffect(()=>{w(()=>{}),new URLSearchParams(window.location.search);const n=localStorage.getItem("accountType");n&&m(n),N().then(a=>{a||(window.location.href="/"),o(a),c(!1)})},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",children:e.jsx("h1",{children:t==null?"":t.name})}),e.jsxs("div",{className:"center",children:[u?e.jsx("div",{className:"loader"}):t!=null?e.jsxs("div",{className:"companyInfo",children:[e.jsx("button",{className:"ActionBtn",onClick:n=>{x.current.showModal()},children:"Edit Company Name"}),e.jsxs("h2",{children:["Join Code: ",t.joinCode]}),e.jsxs("div",{className:"row",children:[e.jsx("h2",{children:"Company Type:"}),C?e.jsx("div",{className:"loader"}):e.jsx("select",{name:"",id:"",value:t.type,onChange:async n=>{y(!0);const a=h.fromMap(t.toMap());a.type=n.target.value,a.lastUpdated=Date.now(),o(a),await f(a),y(!1)},children:Object.keys(L).map(n=>e.jsx("option",{value:n,children:n}))})]}),e.jsx("h2",{children:"Default Location"}),e.jsx("div",{className:"center-location",children:e.jsx(g,{location:t.location,canEdit:!0,canDelete:!1,onEdit:async()=>{l(t.location),p.current.showModal()},onDelete:async()=>{}})}),e.jsx("h2",{children:"Saved Locations"}),e.jsx("div",{className:"saved-locations",children:t.savedLocations.map(n=>e.jsx(g,{location:n,canEdit:!0,canDelete:!0,onEdit:async()=>{l(n),p.current.showModal()},onDelete:async()=>{const a=h.fromMap(t.toMap());a.savedLocations=t.savedLocations.filter(j=>j.name!=n.name),a.lastUpdated=Date.now(),await f(a),o(a)}}))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{i.current.showModal()},children:"Add Location"})]}):e.jsx(e.Fragment,{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/"},children:"Back"})]}),t!=null&&e.jsx(D,{dialogRef:i,existingLocations:t.savedLocations,savedLocations:[],close:()=>{i.current.close()},addLocation:async n=>{const a=h.fromMap(t.toMap());a.savedLocations.push(n),a.lastUpdated=Date.now(),await f(a),o(a),i.current.close()}}),e.jsx(M,{dialogRef:p,location:d,close:()=>{p.current.close()},editLocation:async n=>{const a=h.fromMap(t.toMap());a.savedLocations=t.savedLocations.map(j=>j.name==n.name?n:j),a.lastUpdated=Date.now(),await f(a),o(a),p.current.close()}}),e.jsx(S,{dialogRef:x,companyName:t==null?void 0:t.name,close:()=>{x.current.close()},editCompanyName:async n=>{const a=h.fromMap(t.toMap());a.name=n,await f(a),await E(a.id,n),o(a),x.current.close()}})]})}
