import{j as t,c as ze,r as d,i as Je}from"./index-U3pxML4x.js";import{j as Ve,c as C,e as _,d as v,F as W,k as qe,l as We}from"./constants-Yg3gz1gf.js";import{i as Ke,w as Qe,q as Xe,x as Ze,y as et,z as tt,A as st}from"./db-Xkjm3m1R.js";import{A as nt,S as ke,D as Fe,C as ot,E as at,a as ct,b as rt}from"./Dance_Display_Tile-DxE3vjVg.js";import{B as xe,C as it}from"./Calendar-BG4YQB9j.js";import{C as lt,S as dt}from"./Show_Group_Tile-DjkH6fHU.js";import{E as ut}from"./Ensemble_Section_Tile-z_MH0Ckt.js";import{F as ft}from"./Full_Cast_Tile-CJX3OvfU.js";import"./trash-BnpXJPEK.js";import"./arrow_forward-CHD_SwLW.js";function Ce({conflictResponseDate:D,actor:Z}){return t.jsx("div",{className:"ConflictDisplayTile ",id:"conflict-display-tile-"+Z.userId,children:t.jsx("div",{className:"header",children:t.jsxs("div",{className:"CharacterNameDiv",children:[t.jsxs("label",{htmlFor:"Actor",children:["Actor: ",Z.name]}),t.jsx("br",{}),t.jsxs("label",{htmlFor:"Actor",children:["Date: ",D.date.toDateString()]}),t.jsx("br",{}),D.canAttend?t.jsxs("label",{htmlFor:"Actor",children:[D.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",D.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}):t.jsx("label",{htmlFor:"Actor",children:"Can't Attend"})]})})})}ze(document.getElementById("root")).render(t.jsx(d.StrictMode,{children:t.jsx(ht,{})}));function ht(){const[D,Z]=d.useState(""),[l,Ne]=d.useState(),[K,Le]=d.useState(""),[i,ye]=d.useState(),[U,h]=d.useState("date"),[M,T]=d.useState(null),[R,w]=d.useState(null),[B,E]=d.useState(null),[p,A]=d.useState("custom"),[Q,b]=d.useState(""),[X,L]=d.useState(""),[Me,k]=d.useState(""),[Re,F]=d.useState(""),[y,H]=d.useState(void 0),[be,ie]=d.useState(!1),[z,ee]=d.useState([]),[te,se]=d.useState([]),[m,f]=d.useState([]),[le,$]=d.useState(!1),[I,Be]=d.useState([]),[de,g]=d.useState([]),[ue,He]=d.useState(!1),[j,N]=d.useState(null),[ne,oe]=d.useState(!1),[ve,$e]=d.useState(null),[G,Y]=d.useState(),[O,P]=d.useState(void 0),[ae,De]=d.useState(!1),[fe,he]=d.useState(!1),[me,Ge]=d.useState([]),[S,Ye]=d.useState(void 0),[Te,ce]=d.useState(!1),[J,ge]=d.useState("Layout"),[we,pe]=d.useState(void 0),[Ee,Ie]=d.useState(void 0),[Ae,Se]=d.useState(void 0),[V,q]=d.useState(!1);d.useEffect(()=>{Je(()=>{});const c=new URLSearchParams(window.location.search),a=c.get("activityId");a&&(Z(a),Ke(a).then(s=>{s instanceof Ve||(Ne(s),Y(s==null?void 0:s.rehearsalLocations[0]),P(s==null?void 0:s.eventTypes[0]),H(s==null?void 0:s.defaultLocation))}));const e=c.get("showId");e&&(Le(e),Qe(a,e).then(s=>{const n=[];for(const r of s)for(const u of r.dates)n.find(x=>x.conflictResponseDate.date.getTime()==u.date.getTime()&&x.actor.userId==r.actor.userId)||n.push({conflictResponseDate:u,actor:r.actor});n.sort((r,u)=>r.conflictResponseDate.date.getTime()-u.conflictResponseDate.date.getTime()),Be(n),g([...n])})),Xe(a,e).then(s=>{ye(s),s!=null&&s.hasEnsemble&&Ge(s.ensemble.actors)}),Ze(a,e).then(s=>{ee(s);const n=[];for(const r of s){console.log(r);const u=r.date.from;console.log(r.date.date),u.setDate(r.date.date.getDate()),u.setMonth(r.date.date.getMonth()),u.setFullYear(r.date.date.getFullYear());const x=r.date.to;x.setDate(r.date.date.getDate()),x.setMonth(r.date.date.getMonth()),x.setFullYear(r.date.date.getFullYear()),console.log(u),console.log(x),console.log(r.rehearsalLocation.color),n.push({title:r.name,start:u.toISOString(),end:x.toISOString(),isAllDay:!1,interactive:!0,color:r.rehearsalLocation.color.setAlpha(.8).toHex(),description:r.info,id:r.id,location:r.rehearsalLocation.name})}se(n)});const o=()=>{window.innerWidth<800?De(!0):De(!1)};return window.addEventListener("resize",o),o(),()=>window.removeEventListener("resize",o)},[]);const Oe=c=>{const a=c.target.value,[e,o]=a.split(":").map(Number),s=new Date(M);s.setHours(e,o,0,0),w(s),k(s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},Pe=c=>{const a=c.target.value,[e,o]=a.split(":").map(Number),s=new Date(M);s.setHours(e,o,0,0),E(s),F(s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};Date.prototype.addHours=function(c){return this.setTime(this.getTime()+c*60*60*1e3),this};function _e(){return ue?t.jsx(t.Fragment,{children:"   "}):t.jsxs(t.Fragment,{children:[" ",t.jsx("h2",{children:"Characters"}),t.jsx("div",{className:"characters",children:m.map((c,a)=>{if(c instanceof C)return p=="custom"?t.jsx(lt,{character:c,isCreate:!1,actors:[],characters:i.characters,isAssign:!1,setCharacter:e=>{f(m.map((o,s)=>s===a?e:o))},removeCharacter:()=>{f(m.filter((e,o)=>o!==a))}},a):t.jsx(ot,{character:c,canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==a))},isMini:!1},a);if(c instanceof v)return p=="custom"?t.jsx(ut,{isGroupChatCreate:!1,onAddEnsemble:()=>{},ensembleSection:c,isCustom:!0,setEnsembleSection:e=>{f(m.map((o,s)=>s===a?e:o))},removeEnsembleSection:()=>{f(m.filter((e,o)=>o!==a)),$(!1)},isCreate:!1,isAssign:!1,actors:l.students},a):t.jsx(at,{ensembleSection:c,canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==a))},isMini:!1},a);if(c instanceof _)return p=="custom"?t.jsx(dt,{showGroup:c,characters:i.characters,setShowGroup:e=>{f(m.map((o,s)=>s===a?e:o))},removeShowGroup:()=>{f(m.filter((e,o)=>o!==a))},isCreate:!1,isAssign:!1,actors:l.students,hasEnsemble:i.hasEnsemble,showGroups:i.showGroups},a):t.jsx(ct,{showGroup:c,showCharacters:!0,canClick:!1,onClick:()=>{},canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==a))}},a);if(c instanceof W)return t.jsx(ft,{canDelete:!0,onDelete:()=>{f(m.filter((e,o)=>o!==a))}},a)})}),p=="custom"?t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"ActionBtn",onClick:()=>{const c=Math.floor(Math.random()*1e5);f([...m,C.fromBlank("Character 1",null,c)])},children:"Add Character"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{const c=Math.floor(Math.random()*1e5);f([...m,_.fromBlank("Show Group 1",[],c)])},children:"Add Show Group"}),(i==null?void 0:i.hasEnsemble)&&t.jsx("button",{className:"ActionBtn "+(le?"disabled":""),disabled:le,onClick:()=>{le||($(!0),f([...m,v.fromBlank(!0,!1,!1,!1,[])]))},children:"Add Ensemble"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{q(!0),h("type")},children:"Add Characters from Show Template"})]}):t.jsx(t.Fragment,{})," "]})}function Ue(){return t.jsxs(t.Fragment,{children:[t.jsxs("h2",{children:[p.charAt(0).toUpperCase()+p.slice(1,p.length)," "]}),p=="scene"&&t.jsx(rt,{scene:we,onClick:()=>{},showCharacters:!0}),p=="song"&&t.jsx(ke,{showCharacters:!0,song:Ee,onClick:()=>{}}),p=="dance"&&t.jsx(Fe,{showCharacters:!0,dance:Ae,onClick:()=>{}}),t.jsxs("button",{className:"ActionBtn",onClick:()=>{q(!0),h("type")},children:["Change ",p.charAt(0).toUpperCase()+p.slice(1,p.length)]}),t.jsx("button",{className:"ActionBtn",onClick:()=>{A("custom")},children:"Switch to custom event"})]})}function re(){return z}return t.jsxs("div",{className:"center",children:[t.jsx("h1",{className:"title",children:"Create Schedule"}),U=="date"?t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:xe,alt:"back arrow",onClick:()=>{window.location.href="/Activity/Shows/Show/?activityId="+D+"&showId="+K}}),t.jsx("h2",{className:"mode",children:"Select a Date"})," "]}):t.jsx(t.Fragment,{}),t.jsxs("div",{className:"container",children:[U=="date"?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"box left",children:[t.jsxs("h2",{children:["Conflicts",j!=null?" on "+j.toDateString():""]}),(i==null?void 0:i.hasEnsemble)&&t.jsxs(t.Fragment,{children:[t.jsx("label",{htmlFor:"",children:"Ignore Ensemble Conflicts"}),t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:fe,onChange:c=>{if(he(c.target.checked),c.target.checked){const a=[];for(const e of I)me.find(o=>o.userId==e.actor.userId)||(j!=null?e.conflictResponseDate.date.getTime()==j.getTime()&&a.push(e):a.push(e));g(a)}else if(j!=null){const a=[];for(const e of I)e.conflictResponseDate.date.getTime()==j.getTime()&&a.push(e);g(a)}else g([...I])}}),t.jsx("span",{className:"checkmark",children:" "})]})," "]}),t.jsx("div",{className:"conflicts",children:de.map((c,a)=>t.jsx(Ce,{conflictResponseDate:c.conflictResponseDate,actor:c.actor},a))})]})}):t.jsx(t.Fragment,{}),t.jsx("div",{className:U!="date"?"datePicker hidden":"datePicker",children:t.jsx(it,{canViewConflicts:!0,canPaste:S!=null,canCopy:!0,copyEvent:c=>{const a=re().find(e=>e.id==c.id);Ye(a)},pasteEvent:c=>{const a=new Date(c);a.setHours(0,0,0,0),T(a),w(new Date(S.date.from)),k(S.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const e=new Date(S.date.to);E(e),console.log(e),F(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),b(S.name),L(S.info),H(S.location),Y(S.rehearsalLocation),f(S.characters),P(S.activityEventType),A(S.theaterEventType),S.theaterEventType=="song"?Ie(S.song):S.theaterEventType=="dance"?Se(S.dance):S.theaterEventType=="scene"&&pe(S.scene),h("info"),ce(!0)},isCreating:!0,canOpenContextMenu:!0,events:te,editEvent:c=>{const a=re().find(e=>e.id==c.id);a&&(console.log(a),h("info"),b(a.name),L(a.info),T(a.date.date),w(a.date.from),k(a.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),E(a.date.to),F(a.date.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),H(a.location),Y(a.rehearsalLocation),f(a.characters),P(a.activityEventType),oe(!0),A(a.theaterEventType),a.theaterEventType=="song"&&Ie(a.song),a.theaterEventType=="dance"&&Se(a.dance),a.theaterEventType=="scene"&&pe(a.scene),$e(a))},viewEvent:c=>{const a=re().find(e=>e.id==c.id);a&&(localStorage.setItem("event",JSON.stringify(a.toMap())),localStorage.setItem("back","/Activity/Shows/Show/CreateSchedule/?activityId="+D+"&showId="+K),window.location.href="/Calendar/Event/")},viewConflicts:c=>{const a=new Date(c);a.setHours(0,0,0,0),N(a);const e=[];for(const o of I)o.conflictResponseDate.date.getTime()==a.getTime()&&e.push(o);g(e)},deleteEvent:async c=>{console.log(c);const a=z.find(s=>s.id==c.id),e=z.filter(s=>s.id!=c.id);ee(e);const o=te.filter(s=>s.id!=c.id);se(o),await et(a)},dateClick:c=>{console.log(c.date),T(c.date);const a=new Date(c.date);a.setHours(0,0,0,0),N(a);const e=[];for(const s of I)s.conflictResponseDate.date.getTime()==a.getTime()&&e.push(s);g(e),w(new Date(c.date)),k(c.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(c.date);E(o.addHours(1)),console.log(o),F(c.date.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),h("type")},eventClick:c=>{if(ae){const s=re().find(n=>n.id==c.event.id);s&&(localStorage.setItem("event",JSON.stringify(s.toMap())),localStorage.setItem("back","/Activity/Shows/Show/CreateSchedule/?activityId="+D+"&showId="+K),window.location.href="/Calendar/Event/");return}T(c.event.start);const a=new Date(c.event.start);a.setHours(0,0,0,0),N(a);const e=[];for(const s of I)s.conflictResponseDate.date.getTime()==a.getTime()&&e.push(s);g(e),w(new Date(c.event.start)),k(c.event.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(c.event.end);E(o),F(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),h("type")}})}),U=="date"?t.jsx(t.Fragment,{}):t.jsx(t.Fragment,{})]}),U=="date"?t.jsxs(t.Fragment,{children:[ae&&t.jsx("button",{className:"ActionBtn",onClick:()=>{const c=new Date;console.log(c),T(c);const a=new Date(c);a.setHours(0,0,0,0),N(a);const e=[];for(const s of I)s.conflictResponseDate.date.getTime()==a.getTime()&&e.push(s);g(e),w(new Date(c)),k(c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(c);E(o.addHours(1)),console.log(o),F(c.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),h("type")},children:"Create Event"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{localStorage.setItem("events",JSON.stringify(z)),window.open("/Activity/Shows/Show/Schedule/Print/","_blank")},children:"Print"}),t.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Activity/Shows/Show/?activityId="+D+"&showId="+K},children:"Back"})]}):U=="type"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:xe,alt:"back arrow",onClick:()=>{h("date"),N(null),g([...I])}}),t.jsx("h2",{className:"mode",children:V?"Add Characters from Show":"Select a Rehersal Type"})]}),!ae&&t.jsxs("div",{className:"conflicts-div",children:[t.jsxs("h2",{children:["Conflicts",j!=null?" on "+j.toDateString():""]}),t.jsx("label",{htmlFor:"",children:"Ignore Ensemble Conflicts"}),(i==null?void 0:i.hasEnsemble)&&t.jsx(t.Fragment,{children:t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:fe,onChange:c=>{if(he(c.target.checked),c.target.checked){const a=[],e=new Date(M);e.setHours(0,0,0,0);for(const o of I)me.find(s=>s.userId==o.actor.userId)||o.conflictResponseDate.date.getTime()==e.getTime()&&a.push(o);g(a)}}}),t.jsx("span",{className:"checkmark",children:" "})]})}),t.jsx("div",{className:"conflicts",children:de.map((c,a)=>t.jsx(Ce,{conflictResponseDate:c.conflictResponseDate,actor:c.actor},a))})]}),!V&&t.jsx("button",{onClick:()=>{h("info"),A("custom"),f([])},className:"ActionBtn",children:"Custom"}),t.jsxs("div",{className:"sections",children:[t.jsx("h2",{className:"section "+(J=="Layout"?"selected":""),onClick:()=>{ge("Layout")},children:"Layout"}),i!=null&&i.dances.length>0&&t.jsx("h2",{className:"section "+(J=="Songs"?"selected":""),onClick:()=>{ge("Songs")},children:"Songs"}),i!=null&&(i==null?void 0:i.songs.length)>0&&t.jsx("h2",{className:"section "+(J=="Dances"?"selected":""),onClick:()=>{ge("Dances")},children:"Dances"})]}),J=="Layout"&&t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"mode",children:"Show Layout"}),t.jsx("div",{className:"layout",children:i==null?void 0:i.layout.map((c,a)=>t.jsx(nt,{act:c,onClick:e=>{h("info"),V?(f(n=>[...n,...e.characters]),q(!1)):(f(e.characters),A("scene"),pe(e),b(e.name+" - "+c.name));const o=[];for(const n of[...e.characters,m])if(n instanceof C)o.includes(n.actor.userId)&&o.push(n.actor.userId);else if(n instanceof _){for(const r of n.characters)if(r instanceof C)o.includes(r.actor.userId)&&o.push(r.actor.userId);else if(r instanceof v){if(r.includeAll)for(const u of i.ensemble.actors)o.includes(u.userId)&&o.push(u.userId);else if(r.includeMale)for(const u of i.ensemble.actors)u.gender=="male"&&o.includes(u.userId)&&o.push(u.userId);else if(r.includeFemale)for(const u of i.ensemble.actors)u.gender=="female"&&o.includes(u.userId)&&o.push(u.userId);else if(r.includeCustom)for(const u of r.customActors)o.includes(u.userId)&&o.push(u.userId)}}else if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)o.includes(r.userId)&&o.push(r.userId);else if(n.includeMale)for(const r of i.ensemble.actors)r.gender=="male"&&o.includes(r.userId)&&o.push(r.userId);else if(n.includeFemale)for(const r of i.ensemble.actors)r.gender=="female"&&o.includes(r.userId)&&o.push(r.userId);else if(n.includeCustom)for(const r of n.customActors)o.includes(r.userId)&&o.push(r.userId)}else if(n instanceof W){for(const r of i.ensemble.actors)o.includes(r.userId)&&o.push(r.userId);for(const r of i.characters)o.includes(r.actor.userId)||o.push(r.actor.userId)}const s=[];for(const n of I)o.includes(n.actor.userId)&&n.conflictResponseDate.date.getTime()==j.getTime()&&s.push(n);g(s)}},a))})," "]}),J=="Songs"&&t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"mode",children:"Songs"}),t.jsx("div",{className:"songs",children:i==null?void 0:i.songs.map((c,a)=>t.jsx(ke,{showCharacters:!1,song:c,onClick:()=>{V?(f(s=>[...s,...c.characters]),q(!1)):(f(c.characters),A("song"),Ie(c),b(c.name)),h("info");const e=[];for(const s of[...c.characters,m])if(s instanceof C)e.includes(s.actor.userId)&&e.push(s.actor.userId);else if(s instanceof _){for(const n of s.characters)if(n instanceof C)e.includes(n.actor.userId)&&e.push(n.actor.userId);else if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)e.includes(r.userId)&&e.push(r.userId);else if(n.includeMale)for(const r of i.ensemble.actors)r.gender=="male"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeFemale)for(const r of i.ensemble.actors)r.gender=="female"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeCustom)for(const r of n.customActors)e.includes(r.userId)&&e.push(r.userId)}}else if(s instanceof v){if(s.includeAll)for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);else if(s.includeMale)for(const n of i.ensemble.actors)n.gender=="male"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeFemale)for(const n of i.ensemble.actors)n.gender=="female"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeCustom)for(const n of s.customActors)e.includes(n.userId)&&e.push(n.userId)}else if(s instanceof W){for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);for(const n of i.characters)e.includes(n.actor.userId)||e.push(n.actor.userId)}const o=[];for(const s of I)e.includes(s.actor.userId)&&s.conflictResponseDate.date.getTime()==j.getTime()&&o.push(s);g(o)}},a))})," "]}),J=="Dances"&&t.jsxs(t.Fragment,{children:[" ",t.jsx("h2",{className:"mode",children:"Dances"}),t.jsx("div",{className:"dances",children:i==null?void 0:i.dances.map((c,a)=>t.jsx(Fe,{showCharacters:!1,dance:c,onClick:()=>{h("info"),V?(f(s=>[...s,...c.characters]),q(!1)):(f(c.characters),A("dance"),Se(c),b(c.name));const e=[];for(const s of[...c.characters,m])if(s instanceof C)e.includes(s.actor.userId)&&e.push(s.actor.userId);else if(s instanceof _){for(const n of s.characters)if(n instanceof C)e.includes(n.actor.userId)&&e.push(n.actor.userId);else if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)e.includes(r.userId)&&e.push(r.userId);else if(n.includeMale)for(const r of i.ensemble.actors)r.gender=="male"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeFemale)for(const r of i.ensemble.actors)r.gender=="female"&&e.includes(r.userId)&&e.push(r.userId);else if(n.includeCustom)for(const r of n.customActors)e.includes(r.userId)&&e.push(r.userId)}}else if(s instanceof v){if(s.includeAll)for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);else if(s.includeMale)for(const n of i.ensemble.actors)n.gender=="male"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeFemale)for(const n of i.ensemble.actors)n.gender=="female"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeCustom)for(const n of s.customActors)e.includes(n.userId)&&e.push(n.userId)}else if(s instanceof W){for(const n of i.ensemble.actors)e.push(n.userId);for(const n of i.characters)e.includes(n.actor.userId)||e.push(n.actor.userId)}const o=[];for(const s of I)e.includes(s.actor.userId)&&s.conflictResponseDate.date.getTime()==j.getTime()&&o.push(s);g(o)}},a))})," "]}),t.jsx("button",{onClick:()=>{if(V){h("info"),q(!1);return}h("date"),N(null),g([...I])},className:"ActionBtn",children:"Back"})]}):t.jsxs(t.Fragment,{children:[!ae&&t.jsxs("div",{className:"conflicts-div",children:[t.jsxs("h2",{children:["Conflicts",j!=null?" on "+j.toDateString():""]}),(i==null?void 0:i.hasEnsemble)&&t.jsxs(t.Fragment,{children:[t.jsx("label",{htmlFor:"",children:"Ignore Ensemble Conflicts"}),t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:fe,onChange:c=>{if(he(c.target.checked),c.target.checked){const a=[],e=[];for(const o of m)if(o instanceof C)e.includes(o.actor.userId)&&e.push(o.actor.userId);else if(o instanceof _){for(const s of o.characters)if(s instanceof C)e.includes(s.actor.userId)&&e.push(s.actor.userId);else if(s.includeAll)for(const n of i.ensemble.actors)e.includes(n.userId)&&e.push(n.userId);else if(s.includeMale)for(const n of i.ensemble.actors)n.gender=="male"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeFemale)for(const n of i.ensemble.actors)n.gender=="female"&&e.includes(n.userId)&&e.push(n.userId);else if(s.includeCustom)for(const n of s.customActors)e.includes(n.userId)&&e.push(n.userId)}else if(o instanceof v){if(o.includeAll)for(const s of i.ensemble.actors)e.includes(s.userId)&&e.push(s.userId);else if(o.includeMale)for(const s of i.ensemble.actors)s.gender=="male"&&e.includes(s.userId)&&e.push(s.userId);else if(o.includeFemale)for(const s of i.ensemble.actors)s.gender=="female"&&e.includes(s.userId)&&e.push(s.userId);else if(o.includeCustom)for(const s of o.customActors)e.includes(s.userId)&&e.push(s.userId)}else{for(const s of i.ensemble.actors)e.push(s.userId);for(const s of i.characters)e.includes(s.actor.userId)||e.push(s.actor.userId)}for(const o of I)me.find(s=>s.userId==o.actor.userId)||e.includes(o.actor.userId)&&o.conflictResponseDate.date.getTime()==j.getTime()&&a.push(o);g(a)}}}),t.jsx("span",{className:"checkmark",children:" "})]})," "]}),t.jsx("div",{className:"conflicts",children:de.map((c,a)=>t.jsx(Ce,{conflictResponseDate:c.conflictResponseDate,actor:c.actor},a))})]}),t.jsxs("div",{className:"page-title",children:[t.jsx("img",{src:xe,alt:"back arrow",onClick:()=>{if(ne){h("date"),T(null),w(null),E(null),A("custom"),b(""),L(""),k(""),F(""),Y(l==null?void 0:l.rehearsalLocations[0]),P(l==null?void 0:l.eventTypes[0]),H(l==null?void 0:l.defaultLocation),$(!1),N(null),g(I),oe(!1);return}Te?(ce(!1),h("date")):h("type"),L(""),b(""),$(!1);const c=[];for(const a of I)a.conflictResponseDate.date.getTime()==j.getTime()&&c.push(a);g(c)}}),t.jsx("h2",{className:"mode",children:"Enter Rehersal Information"})]}),t.jsx("label",{htmlFor:"Name",children:"Name: "}),t.jsx("input",{type:"text",value:Q,onChange:c=>{b(c.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"Description",children:"Description: "}),t.jsx("textarea",{value:X,onChange:c=>{L(c.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"",children:"Date: "}),t.jsx("input",{type:"date",value:M==null?void 0:M.toISOString().split("T")[0],onChange:c=>{const a=new Date(c.target.value);if(a=="Invalid Date"){T(null);return}a.setHours(0,0,0,0),a.setDate(a.getDate()+1),T(a);const e=new Date(a);e.setHours(R.getHours(),R.getMinutes(),0,0),w(e),k(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const o=new Date(a);o.setHours(B.getHours(),B.getMinutes(),0,0),E(o),F(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),N(a);const s=[];for(const n of I)n.conflictResponseDate.date.getTime()==a.getTime()&&s.push(n);g(s)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),t.jsx("input",{type:"time",value:Me,onChange:Oe}),t.jsx("br",{}),t.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),t.jsx("input",{type:"time",value:Re,onChange:Pe}),t.jsx("br",{}),t.jsx("label",{htmlFor:"location",children:"Location: "}),t.jsx("select",{name:"location",id:"location",onChange:c=>{H(l==null?void 0:l.locations.find(a=>a.name==c.target.value))},children:l==null?void 0:l.locations.map((c,a)=>t.jsx("option",{value:c.name,selected:(y==null?void 0:y.name)==c.name,children:c.name+" ("+c.address+")"},a))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"location",children:"Rehersal Location: "}),t.jsx("select",{name:"location",id:"rehersal-location",onChange:c=>{Y(l==null?void 0:l.rehearsalLocations.find(a=>a.name==c.target.value))},children:l==null?void 0:l.rehearsalLocations.map((c,a)=>t.jsx("option",{value:c.name,selected:(G==null?void 0:G.name)==c.name,children:c.name},a))}),t.jsx("br",{}),t.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),t.jsx("select",{name:"eventType",id:"event-type",onChange:c=>{P(l==null?void 0:l.eventTypes.find(a=>a.name==c.target.value))},children:l==null?void 0:l.eventTypes.map((c,a)=>t.jsx("option",{value:c.name,selected:(O==null?void 0:O.name)==c.name,children:c.name},a))}),t.jsx("br",{}),p=="custom"?t.jsxs(t.Fragment,{children:[t.jsx("label",{htmlFor:"fullCast",children:"Full Cast: "}),t.jsxs("label",{className:"custom-checkbox",children:[t.jsx("input",{type:"checkbox",id:"ensemble",checked:ue,onChange:c=>He(c.target.checked)}),t.jsx("span",{className:"checkmark"})]})]}):t.jsx(t.Fragment,{}),p=="custom"&&t.jsx("br",{}),p=="custom"?_e():Ue(),t.jsx("br",{}),be?t.jsx("div",{className:"loader"}):t.jsx("button",{onClick:async()=>{if(ie(!0),console.log(`Name: ${Q}, Description: ${X}, Start Time: ${R}, End Time: ${B}, Selected Location: ${y}, Rehearsal Location: ${G}, Event Type: ${O}`),Q==""||X==""||R==null||B==null||y==null||G==null||O==null){alert("Please fill out all fields"),console.log(`Name: ${Q}, Description: ${X}, Start Time: ${R}, End Time: ${B}, Selected Location: ${y}, Rehearsal Location: ${G}, Event Type: ${O}`),ie(!1);return}console.log("Submit");const c=y??l.locations[0];console.log(R),console.log(B);const a=qe.fromBlank(M,R,B);console.log(a.toMap());const e=[];if(ue){if(m.push(new W),i!=null&&i.hasEnsemble&&(i==null?void 0:i.ensemble)!=null)for(const s of i.ensemble.actors)e.push(s);for(const s of i.characters)e.find(n=>n.userId==s.actor.userId)==null&&e.push(s.actor)}else for(const s of m){if(s instanceof W){for(const n of i.ensemble.actors)e.push(n);for(const n of i.characters)e.find(r=>r.userId==n.actor.userId)==null&&e.push(n.actor);break}if(s instanceof C){if(e.find(n=>n.userId==s.actor.userId)!=null)continue;e.push(s.actor)}if(s instanceof v){if(s.includeAll)for(const n of i.ensemble.actors)e.find(r=>r.userId==n.userId)==null&&e.push(n);else if(s.includeMale){for(const n of i.ensemble.actors)if(n.gender=="male"){if(e.find(r=>r.userId==n.userId)!=null)continue;e.push(n)}}else if(s.includeFemale){for(const n of i.ensemble.actors)if(n.gender=="female"){if(e.find(r=>r.userId==n.userId)!=null)continue;e.push(n)}}else if(s.includeCustom)for(const n of s.customActors)e.find(r=>r.userId==n.userId)==null&&e.push(n)}if(s instanceof _)for(const n of s.characters){if(n instanceof C){if(e.find(r=>r.userId==n.actor.userId)!=null)continue;e.push(n.actor)}if(n instanceof v){if(n.includeAll)for(const r of i.ensemble.actors)e.find(u=>u.userId==r.userId)==null&&e.push(r);else if(n.includeMale){for(const r of i.ensemble.actors)if(r.gender=="male"){if(e.find(u=>u.userId==r.userId)!=null)continue;e.push(r)}}else if(n.includeFemale){for(const r of i.ensemble.actors)if(r.gender=="female"){if(e.find(u=>u.userId==r.userId)!=null)continue;e.push(r)}}else if(n.includeCustom)for(const r of n.customActors)e.find(u=>u.userId==r.userId)==null&&e.push(r)}}}const o=We.fromBlank(Q,X,c,a,"activity-theater-event",Date.now(),D,l.name,K,i.name,m,e,p,O,G,p=="scene"?we:void 0,p=="song"?Ee:void 0,p=="dance"?Ae:void 0);if(console.log(o),ne){o.id=ve.id,await tt(o),oe(!1);const s=o.date.from,n=o.date.to;s.setDate(o.date.date.getDate()),s.setMonth(o.date.date.getMonth()),s.setFullYear(o.date.date.getFullYear()),n.setDate(o.date.date.getDate()),n.setMonth(o.date.date.getMonth()),n.setFullYear(o.date.date.getFullYear());const r={title:o.name,start:s.toISOString(),end:n.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.rehearsalLocation.color.setAlpha(.8).toHex(),location:o.rehearsalLocation.name,id:o.id},u=te.filter(je=>je.id!=ve.id);u.push(r),se(u);const x=z.filter(je=>je.id!=o.id);x.push(o),console.log(x),ee([...x])}else{await st(o);const s=o.date.from,n=o.date.to;s.setDate(o.date.date.getDate()),s.setMonth(o.date.date.getMonth()),s.setFullYear(o.date.date.getFullYear()),n.setDate(o.date.date.getDate()),n.setMonth(o.date.date.getMonth()),n.setFullYear(o.date.date.getFullYear());const r={title:o.name,start:s.toISOString(),end:n.toISOString(),isAllDay:!1,interactive:!0,color:o.rehearsalLocation.color.setAlpha(.8).toHex(),id:o.id,location:o.rehearsalLocation.name,description:o.info};se([...te,r]),ee([...z,o])}ie(!1),h("date"),T(null),w(null),E(null),A("custom"),b(""),L(""),k(""),F(""),Y(l==null?void 0:l.rehearsalLocations[0]),P(l==null?void 0:l.eventTypes[0]),H(l==null?void 0:l.defaultLocation),f([]),$(!1),N(null),g(I),ce(!1)},className:"ActionBtn",children:ne?"Save":"Submit"}),!be&&t.jsx("button",{onClick:()=>{if(ne){h("date"),T(null),w(null),E(null),A("custom"),b(""),L(""),k(""),F(""),Y(l==null?void 0:l.rehearsalLocations[0]),P(l==null?void 0:l.eventTypes[0]),H(l==null?void 0:l.defaultLocation),$(!1),N(null),g(I),oe(!1);return}Te?(ce(!1),h("date")):h("type"),L(""),b(""),$(!1);const c=[];for(const a of I)a.conflictResponseDate.date.getTime()==j.getTime()&&c.push(a);g(c)},className:"ActionBtn",children:"Back"})]})]})}
