import{c as te,j as e,r as a,a as ae,b as D}from"./index-BrfWEQze.js";import{c as O,g as oe}from"./db-CMBfYTOW.js";import{T as ne,L as se,G as ce,S as re}from"./constants-B9kCK6KS.js";function S(n){return n*(Math.PI/180)}function le(n){return n*.621371}async function ie(n){const i=`https://geocode.maps.co/search?q=${n}&api_key=667ef1741c1fc644172402icg005d42`;try{const s=await fetch(i,{method:"POST"});if(s.ok){const l=await s.json(),d={lat:parseFloat(l[0].lat),lon:parseFloat(l[0].lon)};return console.log(d),d}else return console.error(`Request failed with status: ${s.status}`),{lat:0,lon:0}}catch(s){return console.error(`Request failed: ${s}`),{lat:0,lon:0}}}function de(n,i,s,l){const c=S(s-n),h=S(l-i),g=Math.sin(c/2)*Math.sin(c/2)+Math.cos(S(n))*Math.cos(S(s))*Math.sin(h/2)*Math.sin(h/2),p=6371*(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)));return le(p)}te(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(he,{})}));function he(){const[n,i]=a.useState(""),[s,l]=a.useState(""),[d,c]=a.useState(!1),[h,g]=a.useState([]),[A,p]=a.useState(""),[N,j]=a.useState("accountType"),[y,I]=a.useState("student"),[k,C]=a.useState("LoginInfo"),[x,M]=a.useState(""),[B,W]=a.useState(""),[K,U]=a.useState(""),[u,L]=a.useState(""),[T,V]=a.useState(""),[P,q]=a.useState(""),[F,G]=a.useState(""),[b,Y]=a.useState(""),[E,Z]=a.useState(""),[H,$]=a.useState(!1),J=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],z=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"];return a.useEffect(()=>{async function t(){const o=await oe();g(o),p(o[0].schoolId)}t()},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"center",children:e.jsx("div",{className:"Login",children:N=="accountType"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Account Type"}),e.jsx("button",{className:"actionBtn",onClick:()=>{I("student"),j("login")},children:"Student"}),e.jsx("button",{className:"actionBtn",onClick:()=>{I("teacher"),j("login")},children:"Teacher"})]}):N=="login"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Login"}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{i(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{l(t.target.value)}}),e.jsx("select",{onChange:t=>{p(t.target.value)},children:h.map(t=>e.jsx("option",{value:t.schoolId,children:t.schoolName}))}),d?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"actionBtn",onClick:async()=>{if(c(!0),!await ae(n,s,A)){c(!1),alert("Wrong email or password");return}localStorage.setItem("accountType",y),c(!1);const r=new URLSearchParams(window.location.search).get("redirect");r?window.location.href=r.replace(/~/g,"&"):window.location.href="/"},children:"Login"}),e.jsx("button",{className:"actionBtn",onClick:()=>{j("createAccount")},children:"Create an Account"})]}):y=="teacher"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),e.jsx("input",{type:"text",placeholder:"Full Name",onChange:t=>{M(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{i(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{l(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"School Code",onChange:t=>{L(t.target.value)}}),d?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"actionBtn",onClick:async()=>{c(!0);const t=h.find(w=>w.schoolTeacherCode==u);if(!t){alert("Invalid School Code");return}localStorage.setItem("schoolId",t.schoolId);const o=ne.fromBlank("",t.schoolId,"","teacher",x.toLowerCase(),x,n),r=await D(n,s);if(!r){alert("Error creating account");return}o.uid=r,await O("teacher",o),localStorage.setItem("accountType","teacher");const m=new URLSearchParams(window.location.search).get("redirect");m?window.location.href=m.replace(/~/g,"&"):window.location.href="/",c(!1)},children:"Create Account"})]}):k=="LoginInfo"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),_(),e.jsx("button",{onClick:()=>{C("HomeAddress")},children:"Next"})]}):k=="HomeAddress"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),X(),e.jsx("button",{onClick:()=>{C("SchoolCode")},children:"Next"}),e.jsx("label",{className:"skip-text-button",onClick:()=>{$(!0),C("SchoolCode")},children:"Skip"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:"Create Account"}),Q(),d?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{onClick:async()=>{c(!0);let t;if(u!=""?t=h.find(v=>v.schoolCode==u):t=h.find(v=>v.schoolDomain==T.split("@")[1]),t==null){u!=""?alert("Invalid School Code"):alert("Invalid School Email"),c(!1);return}let o={lat:0,lon:0},r="",f=0;if(H||(r=P+", "+F+", "+b+", "+E,o=await ie(r),f=de(o.lat,o.lon,t.location.location.latitude,t.location.location.longitude)),!o&&!H){alert("Invalid Address");return}localStorage.setItem("schoolId",t.schoolId);const m=await D(n,s);if(!m){alert("Error creating account");return}const w=se.fromBlank("home",r,new ce(o.lat,o.lon)),ee=re.fromBlank(m,t.schoolId,"unknown",f,"","student",B,K,"unknown",x.toLowerCase().trim(),x.trim(),n.trim(),{},w);await O("student",ee),localStorage.setItem("accountType","student");const R=new URLSearchParams(window.location.search).get("redirect");R?window.location.href=R.replace(/~/g,"&"):window.location.href="/",c(!1)},children:"Create Account"})]})})})});function X(){return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Home Address",value:P,onChange:t=>{q(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"City",value:F,onChange:t=>{G(t.target.value)}}),e.jsxs("select",{value:b,onChange:t=>{Y(t.target.value)},children:[e.jsx("option",{value:"null",selected:!0,children:"Select your State"}),J.map((t,o)=>e.jsx("option",{value:t,children:z[o]}))]}),e.jsx("input",{type:"text",placeholder:"Zip Code",value:E,onChange:t=>{Z(t.target.value)}})]})}function _(){return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Full Name",onChange:t=>{M(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Email",onChange:t=>{i(t.target.value)}}),e.jsx("input",{type:"password",placeholder:"Password",onChange:t=>{l(t.target.value)}}),e.jsx("input",{type:"text",placeholder:"Phone Number",onChange:t=>{W(t.target.value)}}),e.jsxs("select",{onChange:t=>{U(t.target.value)},children:[e.jsx("option",{value:"",selected:!0,children:"Select your Sex"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]})}function Q(){return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"School Code",value:u,onChange:t=>{L(t.target.value)}}),e.jsx("p",{children:"Or"}),e.jsx("input",{type:"text",placeholder:"School Email",value:T,onChange:t=>{V(t.target.value)}})]})}}
