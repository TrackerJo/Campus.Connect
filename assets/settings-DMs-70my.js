import{r as a,j as e,v as P,w as E,L as k,G as I,x as F,c as U,y as S,i as V}from"./index-BfAiCOmw.js";import{G as q,H as B,I as K,J as Q,K as W,L as Y,M as J,h as X}from"./db-CCKL9Mgi.js";function H({addRehearsalLocation:d,close:g,dialogRef:s}){const[n,o]=a.useState(""),[A,r]=a.useState("#000000");return e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Add Rehearsal Location"}),e.jsxs("div",{className:"location-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:n,onChange:u=>{o(u.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:A,onChange:u=>{r(u.target.value)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{d(P.fromBlank(n,E(A)))},children:"Add Rehearsal Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{g()},children:"Close"})]})]})}const w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAgCAYAAADqgqNBAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAH6ADAAQAAAABAAAAIAAAAABT9vqhAAABMUlEQVRIDe2WO07DQBBAbSsFJE1OQEmgTUGJRDgAxyC5SAo6OAiKUkcK5Ax0IKUDpBSpSOnNG/CKkWVHsr3rRIpXevb6s/N2xlM4CI5hGGNO4BE+YAxRLXkjOoUZ6PHkXY4tgrRYNhF7Tz0Mw5gMn8GkMl2mrt1dklkbrmxE5iPJFmSsoW+fOT0TWMRz2MDABmd+DyvwLsbxO3443qgNdO3c6RmJzfhP+3+UDVw7lelgO8SyhW+41O87mx+q+GtfGYv4wll5dSACd+AFskYj1sWqNqe+Tal1k3lvrldtU/O9invVuihnddJceRl/8rwR59Su4O2jLLX8Vy8ga/hrLvkyGIdZVu75FSfytwx5LeLbHPF5wX4t/jriiZLLj94DnBWPVGIFoneYwh20SoQovWQLokOD66GvfLEAAAAASUVORK5CYII=";async function D(d){const g=`https://maps.googleapis.com/maps/api/geocode/json?address=${d}&key=AIzaSyA2saT3TcMaenLp4Im3VhI7zT79mXlN9PI`;try{const s=await fetch(g,{method:"POST"});if(s.ok){const n=await s.json(),o={lat:n.results[0].geometry.location.lat,lon:n.results[0].geometry.location.lng};return console.log(o),o}else return console.error(`Request failed with status: ${s.status}`),{lat:0,lon:0}}catch(s){return console.error(`Request failed: ${s}`),{lat:0,lon:0}}}function z({addLocation:d,close:g,dialogRef:s,savedLocations:n}){const[o,A]=a.useState(""),[r,u]=a.useState(""),[h,v]=a.useState(void 0),[x,j]=a.useState(!1);return e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Add Location"}),e.jsxs("div",{className:"location-info",children:[n.length>0?e.jsxs(e.Fragment,{children:[" ",e.jsx("h3",{children:"Select from saved locations"}),e.jsxs("select",{name:"",id:"saved-locations",onChange:l=>{v(n.find(f=>f.name==l.target.value))},children:[e.jsx("option",{value:"",selected:!0,children:"Select a location"}),n.map((l,f)=>e.jsxs("option",{value:l.name,children:[l.name," (",l.address,")"]},f))]}),e.jsx("h3",{children:"Or add a new location"})]}):e.jsx("h3",{children:"Add a new location"}),e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:o,onChange:l=>{A(l.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Address: "}),e.jsx("input",{type:"text",value:r,onChange:l=>{u(l.target.value)}}),e.jsx("br",{}),x?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(j(!0),(o==""||r=="")&&h==null){alert("Please fill out all fields"),j(!1);return}if(h){d(h);return}const l=await D(r);console.log(l),d(k.fromBlank(o,r,new I(l.lat,l.lon),!1)),j(!1)},children:"Add Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{g()},children:"Close"})]})]})}function $({addEventType:d,close:g,dialogRef:s,eventTypes:n}){const[o,A]=a.useState(""),[r,u]=a.useState("#000000");return e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Add Event Type"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:o,onChange:h=>{A(h.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:r,onChange:h=>{u(h.target.value)}}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{if(o==""){alert("Please fill out all fields");return}if(n.find(h=>h.name==o)){alert("Event type with that name already exists");return}d(F.fromBlank(o,E(r)))},children:"Add Event Type"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{g()},children:"Close"})]})]})}function Z({editLocation:d,close:g,dialogRef:s,location:n}){const[o,A]=a.useState(""),[r,u]=a.useState(""),[h,v]=a.useState(!1);return a.useEffect(()=>{n&&(A(n.name),u(n.address))},[n]),e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Edit Location"}),e.jsxs("div",{className:"location-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:o,onChange:x=>{A(x.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Address: "}),e.jsx("input",{type:"text",value:r,onChange:x=>{u(x.target.value)}}),e.jsx("br",{}),h?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(v(!0),o==""||r==""){alert("Please fill out all fields"),v(!1);return}let x=n.location;if(r!=n.address){const j=await D(r);x=new I(j.lat,j.lon)}await d(k.fromBlank(o,r,x,n.isSchool)),v(!1)},children:"Edit Location"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{g()},children:"Close"})]})]})}function _({editEventType:d,close:g,dialogRef:s,eventTypes:n,eventType:o}){const[A,r]=a.useState(""),[u,h]=a.useState("#000000"),[v,x]=a.useState(!1);function j(l,f,y,T){return`#${(1<<24|l<<16|f<<8|y).toString(16).slice(1).toUpperCase()}`}return a.useEffect(()=>{o&&(r(o.name),h(j(o.color.red,o.color.green,o.color.blue,o.color.alpha)))},[o]),e.jsxs("dialog",{ref:s,children:[e.jsx("h2",{children:"Edit Event Type"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:A,onChange:l=>{r(l.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Color: "}),e.jsx("input",{type:"color",value:u,onChange:l=>{console.log(l.target.value),h(l.target.value)}}),e.jsx("br",{}),v?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(A==""){alert("Please fill out all fields");return}if(n.find(l=>l.name==A&&l.name!=o.name)){alert("Event type with that name already exists");return}x(!0),await d(F.fromBlank(A,E(u))),x(!1)},children:"Edit Event Type"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{g()},children:"Close"})]})]})}U(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(ee,{})}));function ee(){const[d,g]=a.useState(""),[s,n]=a.useState(null),[o,A]=a.useState("student"),r=a.useRef(null),u=a.useRef(null),h=a.useRef(null),[v,x]=a.useState([]),[j,l]=a.useState([]),[f,y]=a.useState([]),[T,R]=a.useState(!0),[C,O]=a.useState(void 0),[b,G]=a.useState(void 0),L=a.useRef(null),N=a.useRef(null);return a.useEffect(()=>{async function t(){R(!0),V(()=>{});const c=new URLSearchParams(window.location.search).get("activityId");if(c){g(c);const M=await J();y(M)}const m=await X(c);m&&(n(m),m instanceof S&&x(m.rehearsalLocations),l(m.eventTypes));const p=localStorage.getItem("accountType");p&&A(p),R(!1)}t()},[]),e.jsxs(e.Fragment,{children:[T?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"title",children:[e.jsxs("h1",{children:["Activity: ",s==null?void 0:s.name]}),e.jsxs("h3",{children:["Join Code: ",s==null?void 0:s.joinCode]}),e.jsx("h2",{children:"Saved Locations"}),e.jsx("div",{className:"saved-locations",children:s==null?void 0:s.locations.map((t,i)=>(console.log(t),e.jsxs("div",{className:"saved-location",children:[e.jsxs("label",{htmlFor:"",className:"saved-location-name",children:[t.name," (",t.address,")"]}),e.jsx("img",{src:w,alt:"edit",className:"saved-location-edit",onClick:()=>{var c;O(t),(c=L.current)==null||c.showModal()}})]},i)))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var i;(i=u.current)==null||i.showModal()},children:"Add Location"}),s instanceof S&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Rehearsal Locations"}),e.jsx("div",{className:"rehearsal-locations",children:v.map((t,i)=>(console.log(t.color),e.jsxs("div",{className:"rehearsal-location",children:[e.jsx("label",{htmlFor:"",className:"rehearsal-location-name",children:t.name}),e.jsxs("div",{className:"rehearsal-location-right",children:[e.jsx("div",{className:"rehearsal-location-color",style:{backgroundColor:t.color.toRBGAString()}}),e.jsx("img",{src:w,alt:""})]})]})))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var i;(i=r.current)==null||i.showModal()},children:"Add Rehearsal Location"})," "]}),e.jsx("h2",{children:"Event Types"}),e.jsx("div",{className:"event-types",children:j.map((t,i)=>e.jsxs("div",{className:"event-type",children:[e.jsx("label",{htmlFor:"",className:"event-type-name",children:t.name}),e.jsxs("div",{className:"event-type-right",children:[e.jsx("div",{className:"event-type-color",style:{backgroundColor:t.color.toRBGAString()}}),e.jsx("img",{src:w,alt:"",onClick:()=>{var c;G(t),(c=N.current)==null||c.showModal()}})]})]}))}),e.jsx("button",{className:"ActionBtn",onClick:t=>{var i;(i=h.current)==null||i.showModal()},children:"Add Event Type"}),e.jsx("br",{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/Activity/?activityId="+d},children:"Back"})]}),e.jsx(H,{dialogRef:r,addRehearsalLocation:async t=>{var i;if(s instanceof S){const c=[...s.rehearsalLocations];c.push(t),s.rehearsalLocations=c,console.log(c),x(c),await q(d,c),(i=r.current)==null||i.close()}},close:()=>{var t;(t=r.current)==null||t.close()}}),e.jsx(z,{dialogRef:u,close:()=>{var t;(t=u.current)==null||t.close()},addLocation:async function(t){var i,c;if(f.find(m=>m.name==t.name)){await B(d,t),(i=u.current)==null||i.close(),s.locations.push(t),n(s);return}await B(d,t),await K(t),y(m=>[...m,t]),s.locations.push(t),n(s),(c=u.current)==null||c.close()},savedLocations:f.filter(t=>!s.locations.find(i=>t.name==i.name))}),e.jsx($,{dialogRef:h,close:()=>{var t;(t=h.current)==null||t.close()},addEventType:async t=>{var c;const i=[...s.eventTypes];i.push(t),l(i),await Q(d,t),(c=h.current)==null||c.close()},eventTypes:s.eventTypes})]}),e.jsx(Z,{dialogRef:L,close:()=>{var t;(t=L.current)==null||t.close()},location:C,editLocation:async t=>{var m;const c=[...s.locations].findIndex(p=>p.name==C.name);s.locations.splice(c,1),s.locations.push(t),console.log(s),await W(d,t,C),n(s),window.location.reload(),(m=L.current)==null||m.close()}}),e.jsx(_,{eventTypes:(s==null?void 0:s.eventTypes)??[],dialogRef:N,close:()=>{var t;(t=N.current)==null||t.close()},eventType:b,editEventType:async t=>{var m;const c=[...s.eventTypes].findIndex(p=>p.name==b.name);s.eventTypes.splice(c,1),s.eventTypes.push(t),console.log(s),await Y(d,t,b,s instanceof S),n(s),window.location.reload(),(m=N.current)==null||m.close()}})]})}
