import{r as s,j as e,c as C,i as w}from"./index-U3pxML4x.js";import{a as f,C as L}from"./constants-CZ2ZrUdU.js";import{ad as N,ai as h,aj as E}from"./db-9G2sMR9v.js";import{A as D}from"./Add_Location_Dialog-CB7KGoaM.js";import{E as M}from"./Edit_Location_Dialog-BFZlb7Cu.js";function g({location:r,onEdit:m,onDelete:u,canEdit:l,canDelete:t}){const[o,d]=s.useState(!1),[i,c]=s.useState(!1);return e.jsxs("div",{className:"location-tile",children:[e.jsx("label",{htmlFor:"",children:r.name}),e.jsx("label",{htmlFor:"",children:r.address}),l?i?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{c(!0),await m(),c(!1)},children:"Edit"}):e.jsx(e.Fragment,{}),t?o?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{d(!0),await u(),d(!1)},children:"Delete"}):e.jsx(e.Fragment,{})]})}function S({editCompanyName:r,close:m,dialogRef:u,companyName:l}){const[t,o]=s.useState(""),[d,i]=s.useState(!1);return s.useEffect(()=>{l&&o(l)},[l]),e.jsxs("dialog",{ref:u,children:[e.jsx("h2",{children:"Edit Company Name"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:t,onChange:c=>{o(c.target.value)}}),e.jsx("br",{}),d?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(t==""){alert("Please fill out all fields");return}i(!0),await r(t),i(!1)},children:"Save"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{m()},children:"Close"})]})]})}C(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(b,{})}));function b(){const[r,m]=s.useState("student"),[u,l]=s.useState(!0),[t,o]=s.useState(null),[d,i]=s.useState(void 0),c=s.useRef(null),p=s.useRef(null),[v,y]=s.useState(!1),j=s.useRef(null);return s.useEffect(()=>{w(()=>{}),new URLSearchParams(window.location.search);const n=localStorage.getItem("accountType");n&&m(n),N().then(a=>{a||(window.location.href="/"),o(a),l(!1)})},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",children:e.jsx("h1",{children:t==null?"":t.name})}),e.jsxs("div",{className:"center",children:[u?e.jsx("div",{className:"loader"}):t!=null?e.jsxs("div",{className:"companyInfo",children:[e.jsx("button",{className:"ActionBtn",onClick:n=>{j.current.showModal()},children:"Edit Company Name"}),e.jsxs("h2",{children:["Join Code: ",t.joinCode]}),e.jsxs("div",{className:"row",children:[e.jsx("h2",{children:"Company Type:"}),v?e.jsx("div",{className:"loader"}):e.jsx("select",{name:"",id:"",value:t.type,onChange:async n=>{y(!0);const a=f.fromMap(t.toMap());a.type=n.target.value,a.lastUpdated=Date.now(),o(a),await h(a),y(!1)},children:Object.keys(L).map(n=>e.jsx("option",{value:n,children:n}))})]}),e.jsx("h2",{children:"Default Location"}),e.jsx("div",{className:"center-location",children:e.jsx(g,{location:t.location,canEdit:!0,canDelete:!1,onEdit:async()=>{i(t.location),p.current.showModal()},onDelete:async()=>{}})}),e.jsx("h2",{children:"Saved Locations"}),e.jsx("div",{className:"saved-locations",children:t.savedLocations.map(n=>e.jsx(g,{location:n,canEdit:!0,canDelete:!0,onEdit:async()=>{i(n),p.current.showModal()},onDelete:async()=>{const a=f.fromMap(t.toMap());a.savedLocations=t.savedLocations.filter(x=>x.name!=n.name),a.lastUpdated=Date.now(),await h(a),o(a)}}))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{c.current.showModal()},children:"Add Location"})]}):e.jsx(e.Fragment,{}),e.jsx("button",{className:"ActionBtn",onClick:()=>{window.location.href="/"},children:"Back"})]}),t!=null&&e.jsx(D,{dialogRef:c,existingLocations:t.savedLocations,savedLocations:[],close:()=>{c.current.close()},addLocation:async n=>{const a=f.fromMap(t.toMap());a.savedLocations.push(n),a.lastUpdated=Date.now(),await h(a),o(a)}}),e.jsx(M,{dialogRef:p,location:d,close:()=>{p.current.close(),i(void 0)},editLocation:async n=>{const a=f.fromMap(t.toMap());a.savedLocations=t.savedLocations.map(x=>x.name==n.name?n:x),a.lastUpdated=Date.now(),await h(a),o(a),p.current.close(),i(void 0)}}),e.jsx(S,{dialogRef:j,companyName:t==null?void 0:t.name,close:()=>{j.current.close()},editCompanyName:async n=>{const a=f.fromMap(t.toMap());a.name=n,await h(a),await E(a.id,n),o(a),j.current.close()}})]})}
