import{r,j as e,c as Oe,i as Ye}from"./index-U3pxML4x.js";import{k as oe,y as me,j as Pe}from"./constants-b6ADl2C6.js";import{a4 as Ge,a5 as pe,K as He,i as Ke,a6 as Ve,a7 as Je}from"./db-CbK9Qc0o.js";import{B as We,C as Ce}from"./Calendar-BG4YQB9j.js";import{T as Qe}from"./trash-BnpXJPEK.js";import{A as Ue}from"./Add_Location_Dialog-Bt3GjaQv.js";import"./arrow_forward-CHD_SwLW.js";import"./distance-DNOHIura.js";function $e({dialogRef:X,close:ee,addDate:v,eventDate:k}){const[N,B]=r.useState(new Date),[M,J]=r.useState(new Date),[W,P]=r.useState(new Date),[A,R]=r.useState(""),[s,x]=r.useState(""),F=c=>{const l=c.target.value,[f,u]=l.split(":").map(Number),i=new Date(N);i.setHours(f,u,0,0),J(i),R(i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},m=c=>{const l=c.target.value,[f,u]=l.split(":").map(Number),i=new Date(N);i.setHours(f,u,0,0),P(i),x(i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};return r.useEffect(()=>{k&&(B(k.date),J(k.from),P(k.to),R(k.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),x(k.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})))},[k]),e.jsxs("dialog",{ref:X,className:"AddEventDateDialog",children:[e.jsx("h2",{children:"Add Event Date"}),e.jsx("label",{htmlFor:"",children:"Date: "}),e.jsx("input",{type:"date",value:N==null?void 0:N.toISOString().split("T")[0],onChange:c=>{const l=new Date(c.target.value);if(l=="Invalid Date"){B(new Date);return}l.setHours(0,0,0,0),l.setDate(l.getDate()+1),B(l);const f=new Date(l);f.setHours(M.getHours(),M.getMinutes(),0,0),J(f),R(f.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const u=new Date(l);u.setHours(W.getHours(),W.getMinutes(),0,0),P(u),x(u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),e.jsx("input",{type:"time",value:A,onChange:F}),e.jsx("br",{}),e.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),e.jsx("input",{type:"time",value:s,onChange:m}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"ActionBtn",onClick:()=>{ee()},children:"Close"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{v(oe.fromBlank(N,M,W))},children:"Add Date"})]})]})}function Ze({close:X,dialogRef:ee,events:v,activity:k}){const[N,B]=r.useState("schedule"),[M,J]=r.useState(!1),[W,P]=r.useState(!1);function A(m){const c=Object.keys(m[0]),l=m.map(f=>c.map(u=>f[u]).join(","));return[c.join(","),...l].join(`
`)}const R=()=>{const m=[];M&&(v=F(v));for(let i=0;i<v.length;i++){const p=v[i];m.push({Date:p.date.date.getMonth()+1+"/"+p.date.date.getDate()+"/"+p.date.date.getFullYear().toString().slice(2),Start:p.date.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}),End:p.date.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}),Name:p.name,Location:p.location.name==k.defaultLocation.name?"default":p.location.name,"Event Type":p.eventType.name,"Extra Info":p.info,"Invite Type":p.generalTarget,"Custom/Group Targets":p.groupTargets.map(D=>D.groupName).join(", "),"Added to Campus Connect":""})}m.sort((i,p)=>i.Date==p.Date?i.Start==p.Start?i.End>p.End?1:-1:i.Start>p.Start?1:-1:i.Date>p.Date?1:-1);const c=A(m),l=new Blob([c],{type:"text/csv"}),f=window.URL.createObjectURL(l),u=document.createElement("a");u.href=f,u.download=N+".csv",u.click(),window.URL.revokeObjectURL(f)};function s(m,c,l,f){const u=new Date(m,c,1);let i=0;for(;u.getMonth()===c;){if(u.getDay()===l&&(i++,i===f))return u;u.setDate(u.getDate()+1)}return s(m,c+1,l,1)}function x(m){const c=m.getDay(),l=m.getFullYear()+1,f=m.getMonth();let u=1;const i=new Date(m);for(i.setDate(1);i.getMonth()===f;){if(i.getDay()===c){if(i.getDate()===m.getDate())break;u++}i.setDate(i.getDate()+1)}return s(l,f,c,u)}function F(m){return m.map(c=>{const l=x(c.date.date),f=oe.fromBlank(l,c.date.from,c.date.to);return me.fromBlank(c.name,c.info,c.location,f,c.type,c.lastUpdated,c.activityId,c.groupNames,c.targets,c.generalTarget,c.eventType,c.groupTargets,c.hasSchoolEvent,c.schoolEventId,c.conflicts,c.activityName)})}return e.jsxs("dialog",{ref:ee,children:[e.jsx("h2",{children:"Export Schedule"}),e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"Name: "}),e.jsx("input",{type:"text",value:N,onChange:m=>{B(m.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Move Schedule Forward a Year? "}),e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:M,onChange:m=>{J(m.target.checked)}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("br",{}),W?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(N==""){alert("Please fill out all fields");return}P(!0),R(),P(!1)},children:"Export Schedule"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{X()},children:"Close"})]})]})}const ze="data:image/png;base64,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";function Xe({close:X,dialogRef:ee,activity:v,addEvents:k}){const[N,B]=r.useState(!1),[M,J]=r.useState(null),[W,P]=r.useState([]),A=r.useRef(null);function R(x){const F=x.split(`
`),m=[],c=F[0].split(",");for(let l=1;l<F.length;l++){const f={},u=F[l].split(",");for(let i=0;i<c.length;i++)f[c[i]]=u[i];m.push(f)}return JSON.stringify(m)}function s(x){const F=JSON.parse(x),m=[];for(let c=0;c<F.length;c++){const l=F[c];if(l["Added to Campus Connect"].toLowerCase()=="yes")continue;const f=new Date(l.Date),u=new Date(f.toDateString()+" "+l.Start),i=new Date(f.toDateString()+" "+l.End),p=oe.fromBlank(f,u,i),D=l.Name;let I=l.Location;I=="default"?I=v.defaultLocation:I=v.locations.find(T=>T.name==I);const te=v.eventTypes.find(T=>T.name==l["Event Type"]),le=l["Extra Info"],q=l["Invite Type"],ie=[],L=[],b=[];if(q=="groups"){const T=l["Custom/Group Targets"].split(", ");for(let j=0;j<T.length;j++){const U=v.groups.find(E=>E.groupName==T[j]);U&&(ie.push(U),L.push(U.groupName),U.groupMembers.forEach(E=>{b.find(ne=>ne.userId==E.userId)||b.push(E)}))}}else if(q=="custom"){const T=l["Custom/Group Targets"].split(", ");for(let j=0;j<T.length;j++){const U=v.students.find(E=>E.userId==T[j]);if(U)b.push(U);else{const E=v.parents.find(ne=>ne.userId==T[j]);E&&b.push(E)}}}m.push(me.fromBlank(D,le,I,p,"activity-event",Date.now(),v.id,L,b,q,te,ie,!1,"",[],v.name))}return m}return e.jsx("dialog",{ref:ee,children:e.jsxs("div",{className:"import-schedule-dialog",children:[e.jsx("h2",{children:"Import Schedule"}),W.length==0?e.jsxs("div",{className:"event-type-info",children:[e.jsx("label",{htmlFor:"",children:"CSV File: "}),e.jsx("input",{type:"file",accept:".csv",ref:A,onChange:x=>{x.target.files&&J(x.target.files[0])}}),N?e.jsx("div",{className:"center-loader",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{if(M==null){alert("Please select a file");return}B(!0);const x=new FileReader;x.onload=function(F){const m=F.target.result,c=R(m),l=s(c);P(l),console.log(c),console.log(l)},x.readAsText(M),B(!1)},children:"Import Schedule"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{J(null),P([]),X(),A.current.value=""},children:"Close"})]}):e.jsxs("div",{className:"events-view",children:[e.jsx("h3",{children:"Events"}),e.jsx("div",{className:"events",children:W.map((x,F)=>e.jsxs("div",{className:"event",children:[e.jsxs("div",{className:"event-info",children:[e.jsx("p",{children:x.name}),e.jsx("p",{children:x.info}),e.jsx("p",{children:x.location.name})]}),e.jsxs("div",{className:"event-date-add",children:[e.jsx("p",{children:x.date.date.toDateString()}),e.jsxs("p",{children:[x.date.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})," - ",x.date.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})]})]}),e.jsx("div",{children:e.jsx("img",{src:ze,alt:"",className:"removeIcon",onClick:()=>{const m=[...W];m.splice(F,1),P(m)}})})]},F))}),N?e.jsx("div",{className:"center-loader",children:e.jsx("div",{className:"loader"})}):e.jsx("button",{className:"ActionBtn",onClick:async()=>{B(!0),await k(W),P([]),J(null),B(!1),X()},children:"Import Schedule"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{J(null),P([]),X(),A.current.value=""},children:"Close"}),e.jsx("label",{htmlFor:"",className:"hiddenText",children:" s "})]})]})})}Oe(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(qe,{})}));function qe(){const[X,ee]=r.useState("student"),[v,k]=r.useState([]),[N,B]=r.useState([]),[M,J]=r.useState(null),[W,P]=r.useState(!1),[A,R]=r.useState([]),[s,x]=r.useState(),[F,m]=r.useState("students"),[c,l]=r.useState("date"),[f,u]=r.useState(null),[i,p]=r.useState(null),[D,I]=r.useState(null),[te,le]=r.useState(null),[q,ie]=r.useState(null),[L,b]=r.useState(""),[T,j]=r.useState(""),[U,E]=r.useState(""),[ne,K]=r.useState(""),[S,y]=r.useState(void 0),[H,G]=r.useState([]),[C,Q]=r.useState("students"),[fe,_e]=r.useState(!1);r.useState(""),r.useState(""),r.useState(null),r.useState(null);const[ve,et]=r.useState(""),[_,se]=r.useState(!1),[re,we]=r.useState(null),[w,O]=r.useState(void 0),[$,ye]=r.useState(void 0),[ce,Ee]=r.useState([]),[ke,Fe]=r.useState(void 0),he=r.useRef(null),xe=r.useRef(null),je=r.useRef(null),ae=r.useRef(null),[Se,Z]=r.useState(!1),[z,ge]=r.useState([]);r.useEffect(()=>{Ye(()=>{});async function t(){P(!0);const d=new URLSearchParams(window.location.search).get("activityId");if(d){J(d);const h=await Ke(d);x(h),console.log(h),y(h.defaultLocation)}const o=await Ve(d);console.log(o),k(o);const g=[];for(const h of o){console.log(h);const Y=h.date.from;console.log(h.date.date),Y.setDate(h.date.date.getDate()),Y.setMonth(h.date.date.getMonth()),Y.setFullYear(h.date.date.getFullYear());const V=h.date.to;V.setDate(h.date.date.getDate()),V.setMonth(h.date.date.getMonth()),V.setFullYear(h.date.date.getFullYear()),console.log(Y),console.log(V),g.push({title:h.name,start:Y.toISOString(),end:V.toISOString(),isAllDay:!1,interactive:!0,description:h.info,color:h.eventType.color.setAlpha(.8).toRBGAString(),id:h.id,location:h.location.name})}B(g),console.log(o),console.log(g),P(!1)}t();const n=localStorage.getItem("accountType");n&&ee(n)},[]);function Ne(){return v}const Ae=t=>{const n=t.target.value,[a,d]=n.split(":").map(Number),o=new Date(f);o.setHours(a,d,0,0),p(o),E(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))},De=t=>{const n=t.target.value,[a,d]=n.split(":").map(Number),o=new Date(f);o.setHours(a,d,0,0),I(o),K(o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))};Date.prototype.addHours=function(t){return this.setTime(this.getTime()+t*60*60*1e3),this};function Te(){return e.jsxs("div",{className:"custom-invite-view",children:[e.jsx("button",{className:F=="students"?"selected":"",onClick:()=>{m("students")},children:"Students"}),e.jsx("button",{className:F=="parents"?"selected":"",onClick:()=>{m("parents")},children:"Parents"}),e.jsx("div",{className:"current-view",children:F=="students"?e.jsx("div",{className:"students",children:s==null?void 0:s.students.map((t,n)=>e.jsxs("div",{className:"student",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"student",checked:H.find(a=>a.userId==t.userId)!=null,onChange:a=>{a.target.checked?G([...H,t]):G(H.filter(d=>d!=t))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.userId,children:t.name})]},t.userId))}):e.jsx("div",{className:"parents",children:s==null?void 0:s.parents.map((t,n)=>e.jsxs("div",{className:"parent",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"parent",onChange:a=>{a.target.checked?G([...H,t]):G(H.filter(d=>d!=t))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.userId,children:t.name})]},t.userId))})})]})}function Ie(){return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mode",children:"Enter Event Information"}),e.jsx("label",{htmlFor:"Name",children:"Name: "}),e.jsx("input",{type:"text",value:L,onChange:t=>{b(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Description",children:"Description: "}),e.jsx("textarea",{value:T,onChange:t=>{j(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Date: "}),e.jsx("input",{type:"date",value:f==null?void 0:f.toISOString().split("T")[0],onChange:t=>{const n=new Date(t.target.value);if(n=="Invalid Date"){u(null);return}n.setHours(0,0,0,0),n.setDate(n.getDate()+1),u(n);const a=new Date(n);a.setHours(i.getHours(),i.getMinutes(),0,0),p(a),E(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const d=new Date(n);d.setHours(D.getHours(),D.getMinutes(),0,0),I(d),K(d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}))}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),e.jsx("input",{type:"time",value:U,onChange:Ae}),e.jsx("br",{}),e.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),e.jsx("input",{type:"time",value:ne,onChange:De}),e.jsx("br",{}),e.jsx("label",{htmlFor:"location",children:"Location: "}),e.jsx("select",{name:"location",id:"location",onChange:t=>{y(s==null?void 0:s.locations.find(n=>n.name==t.target.value))},children:s==null?void 0:s.locations.map((t,n)=>e.jsx("option",{value:t.name,selected:(S==null?void 0:S.name)==t.name,children:t.name+" ("+t.address+")"},n))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=ae.current)==null||t.showModal()},children:"Add New Location"}),e.jsx("br",{}),e.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),e.jsx("select",{name:"eventType",id:"event-type",onChange:t=>{O(s==null?void 0:s.eventTypes.find(n=>n.name==t.target.value))},children:s==null?void 0:s.eventTypes.map((t,n)=>e.jsx("option",{value:t.name,selected:(w==null?void 0:w.name)==t.name,children:t.name},n))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"inviteType",children:"Invite Type: "}),e.jsxs("select",{name:"inviteType",id:"invite-type",onChange:t=>{Q(t.target.value)},children:[e.jsx("option",{value:"students",selected:C=="students",children:"Students"}),e.jsx("option",{value:"parents",selected:C=="parents",children:"Parents"}),e.jsx("option",{value:"groups",selected:C=="groups",children:"Groups"}),e.jsx("option",{value:"custom",selected:C=="custom",children:"Custom"})]}),C=="groups"?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("label",{htmlFor:"groups",children:"Groups: "}),e.jsx("div",{className:"groups",children:s.groups.map((t,n)=>e.jsxs("div",{className:"group",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:A.find(a=>a.groupName==t.groupName)!=null,onChange:a=>{a.target.checked?(R([...A,t]),G([...H,...t.groupMembers])):(R(A.filter(d=>d.groupName!=t.groupName)),G(H.filter(d=>!t.groupMembers.includes(d))))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.groupName,children:t.groupName})]},t.groupName))})]}):e.jsx(e.Fragment,{}),C=="custom"?Te():e.jsx(e.Fragment,{}),e.jsx("br",{}),Se?e.jsx("div",{className:"loader"}):e.jsx("button",{onClick:async()=>{if(Z(!0),console.log(`Name: ${L}, Description: ${T}, Start Time: ${i}, End Time: ${D}, Selected Location: ${S},Event Type: ${w}`),L==""||i==null||D==null||S==null||w==null){alert("Please fill out all fields"),console.log(`Name: ${L}, Description: ${T}, Start Time: ${i}, End Time: ${D}, Selected Location: ${S},  Event Type: ${w}`),Z(!1);return}console.log("Submit");const t=S??s.locations[0];console.log(i),console.log(D);const n=oe.fromBlank(f,i,D);console.log(n.toMap());const a=[],d=w;d.color.setAlpha(255);const o=me.fromBlank(L,T,t,n,"activity-event",Date.now(),M,A.map(g=>g.groupName),H,C,d,A,fe,ve,[],s.name);if(_){o.id=re.id,re.generalTarget=="groups"&&o.groupTargets.forEach(ue=>{ue.groupMembers.forEach(be=>{a.find(Re=>Re.userId==be.userId)||a.push(be)})}),o.targets=[...a],await Je(o),se(!1);const g=o.date.from,h=o.date.to,Y={title:o.name,start:g.toISOString(),end:h.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.eventType.color.setAlpha(.8).toRBGAString(),id:o.id,location:o.location.name},V=N.filter(ue=>ue.id!=re.id);console.log(V),console.log(re.id),V.push(Y),B([...V]);const de=v.filter(ue=>ue.id!=re.id);de.push(o),console.log(de),k([...de])}else{await pe(o);const g=o.date.from,h=o.date.to;g.setDate(o.date.date.getDate()),g.setMonth(o.date.date.getMonth()),g.setFullYear(o.date.date.getFullYear()),h.setDate(o.date.date.getDate()),h.setMonth(o.date.date.getMonth()),h.setFullYear(o.date.date.getFullYear());const Y={title:o.name,start:g.toISOString(),end:h.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.eventType.color.setAlpha(.8).toRBGAString(),id:o.id,location:o.location.name};B([...N,Y]),k([...v,o])}Z(!1),l("date"),u(null),p(null),I(null),b(""),j(""),E(""),K(""),O(s==null?void 0:s.eventTypes[0]),y(s==null?void 0:s.defaultLocation),G([]),Q("students")},className:"ActionBtn",children:_?"Save":"Submit"}),e.jsx("button",{onClick:()=>{if(_){l("date"),u(null),p(null),I(null),b(""),j(""),E(""),K(""),y(s.defaultLocation),O(s.eventTypes[0]),y(s==null?void 0:s.defaultLocation),se(!1);return}l("date"),j(""),b(""),Q("students")},className:"ActionBtn",children:"Back"})]})}function Be(){return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mode",children:"Enter Event Information"}),e.jsx("label",{htmlFor:"Name",children:"Name: "}),e.jsx("input",{type:"text",value:L,onChange:t=>{b(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Description",children:"Description: "}),e.jsx("textarea",{value:T,onChange:t=>{j(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),e.jsx("input",{type:"time",value:U,onChange:Ae}),e.jsx("br",{}),e.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),e.jsx("input",{type:"time",value:ne,onChange:De}),e.jsx("br",{}),e.jsx("label",{htmlFor:"location",children:"Location: "}),e.jsx("select",{name:"location",id:"location",onChange:t=>{y(s==null?void 0:s.locations.find(n=>n.name==t.target.value))},children:s==null?void 0:s.locations.map((t,n)=>e.jsx("option",{value:t.name,selected:(S==null?void 0:S.name)==t.name,children:t.name+" ("+t.address+")"},n))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=ae.current)==null||t.showModal()},children:"Add New Location"}),e.jsx("br",{}),e.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),e.jsx("select",{name:"eventType",id:"event-type",onChange:t=>{O(s==null?void 0:s.eventTypes.find(n=>n.name==t.target.value))},children:s==null?void 0:s.eventTypes.map((t,n)=>e.jsx("option",{value:t.name,selected:(w==null?void 0:w.name)==t.name,children:t.name},n))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"inviteType",children:"Invite Type: "}),e.jsxs("select",{name:"inviteType",id:"invite-type",onChange:t=>{Q(t.target.value)},children:[e.jsx("option",{value:"students",selected:C=="students",children:"Students"}),e.jsx("option",{value:"parents",selected:C=="parents",children:"Parents"}),e.jsx("option",{value:"groups",selected:C=="groups",children:"Groups"}),e.jsx("option",{value:"custom",selected:C=="custom",children:"Custom"})]}),C=="groups"?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("label",{htmlFor:"groups",children:"Groups: "}),e.jsx("div",{className:"groups",children:s.groups.map((t,n)=>e.jsxs("div",{className:"group",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:A.find(a=>a.groupName==t.groupName)!=null,onChange:a=>{a.target.checked?(R([...A,t]),G([...H,...t.groupMembers])):(R(A.filter(d=>d.groupName!=t.groupName)),G(H.filter(d=>!t.groupMembers.includes(d))))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.groupName,children:t.groupName})]},t.groupName))})]}):e.jsx(e.Fragment,{}),C=="custom"?Te():e.jsx(e.Fragment,{}),e.jsx("br",{}),e.jsx("h2",{children:"Event Dates"}),e.jsx("div",{className:"event-dates",children:ce.map((t,n)=>e.jsxs("div",{className:"event-date",children:[e.jsxs("div",{className:"event-date-title",children:[e.jsx("label",{htmlFor:"",className:"event-date-name",children:t.date.toDateString()}),e.jsx("label",{htmlFor:"",className:"event-date-time",children:t.from.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})+" - "+t.to.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})})]}),e.jsx("img",{src:Qe,className:"event-date-icon",onClick:()=>{Ee(ce.filter(a=>a!=t))}})]},n))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var a;if(i==null||D==null){alert("Please fill out start time and end time");return}const t=new Date;t.setHours(0,0,0,0);const n=oe.fromBlank(t,i,D);Fe(n),(a=he.current)==null||a.showModal()},children:"Add Date"}),e.jsx("br",{}),Se?e.jsx("div",{className:"loader"}):e.jsx("button",{onClick:async()=>{if(Z(!0),console.log(`Name: ${L}, Description: ${T}, Start Time: ${i}, End Time: ${D}, Selected Location: ${S},Event Type: ${w}`),L==""||i==null||D==null||S==null||w==null||ce.length==0){alert("Please fill out all fields"),console.log(`Name: ${L}, Description: ${T}, Start Time: ${i}, End Time: ${D}, Selected Location: ${S},  Event Type: ${w}`),Z(!1);return}console.log("Submit");const t=S??s.locations[0];console.log(i),console.log(D);const n=[];for(const a of ce){const d=w;d.color.setAlpha(255);const o=me.fromBlank(L,T,t,a,"activity-event",Date.now(),M,A.map(V=>V.groupName),H,C,d,A,fe,ve,[],s.name);await pe(o);const g=o.date.from,h=o.date.to;g.setDate(o.date.date.getDate()),g.setMonth(o.date.date.getMonth()),g.setFullYear(o.date.date.getFullYear()),h.setDate(o.date.date.getDate()),h.setMonth(o.date.date.getMonth()),h.setFullYear(o.date.date.getFullYear());const Y={title:o.name,start:g.toISOString(),end:h.toISOString(),isAllDay:!1,interactive:!0,description:o.info,color:o.eventType.color.setAlpha(.8).toRBGAString(),id:o.id,location:o.location.name};n.push(Y),k([...v,o])}B([...N,...n]),Z(!1),l("date"),u(null),p(null),I(null),b(""),j(""),E(""),K(""),O(s==null?void 0:s.eventTypes[0]),y(s==null?void 0:s.defaultLocation),G([]),Q("students")},className:"ActionBtn",children:_?"Save":"Submit"}),e.jsx("button",{onClick:()=>{if(_){l("date"),u(null),p(null),I(null),b(""),j(""),E(""),K(""),y(s.defaultLocation),O(s.eventTypes[0]),y(s==null?void 0:s.defaultLocation),se(!1);return}l("date"),j(""),b(""),Q("students")},className:"ActionBtn",children:"Back"})]})}function Le(){if(z.length==0)return alert("Please select at least one day"),[];if(i==null||D==null)return alert("Please fill out start time and end time"),[];if(te==null||q==null)return alert("Please fill out start date and end date"),[];const t=[],n=new Date(te);n.setHours(0,0,0,0);const a=new Date(q);for(a.setHours(0,0,0,0),console.log(z),console.log(n),console.log(a);n<=a;){if(console.log(n),console.log(n.getDay()),z.includes(n.getDay())){console.log("Adding");const d=oe.fromBlank(new Date(n),i,D);t.push(d)}n.setDate(n.getDate()+1)}return console.log(t),t}function Me(){return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mode",children:"Enter Event Information"}),e.jsx("label",{htmlFor:"Name",children:"Name: "}),e.jsx("input",{type:"text",value:L,onChange:t=>{b(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"Description",children:"Description: "}),e.jsx("textarea",{value:T,onChange:t=>{j(t.target.value)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Repeats Every"}),e.jsx("br",{}),e.jsx("div",{className:"repeating-days",children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((t,n)=>e.jsxs("label",{className:"custom-checkbox",onClick:a=>{console.log(a.target.tagName),!(a.target.tagName=="INPUT"||a.target.tagName=="SPAN")&&(z.includes(n)?ge(z.filter(d=>d!=n)):ge([...z,n]))},children:[e.jsx("input",{type:"checkbox",checked:z.includes(n),onChange:a=>{z.includes(n)?ge(z.filter(d=>d!=n)):ge([...z,n])}}),e.jsx("span",{className:"checkmark"}),e.jsx("span",{className:"spacer",children:" "}),e.jsx("label",{htmlFor:t,children:t})]},n))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"Start Date: "}),e.jsx("input",{type:"date",value:(te==null?void 0:te.toISOString().split("T")[0])??"",onChange:t=>{try{const n=new Date(t.target.value);if(n=="Invalid Date"){le(null);return}n.setHours(0,0,0,0),n.setDate(n.getDate()+1),console.log(n),le(n)}catch(n){le(null),console.log(n)}}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"",children:"End Date: "}),e.jsx("input",{type:"date",value:q==null?void 0:q.toISOString().split("T")[0],onChange:t=>{const n=new Date(t.target.value);if(n=="Invalid Date"){ie(null);return}n.setHours(0,0,0,0),n.setDate(n.getDate()+1),ie(n)}}),e.jsx("br",{}),e.jsx("label",{htmlFor:"StartTime",children:"Start Time: "}),e.jsx("input",{type:"time",value:U,onChange:Ae}),e.jsx("br",{}),e.jsx("label",{htmlFor:"EndTime",children:"End Time: "}),e.jsx("input",{type:"time",value:ne,onChange:De}),e.jsx("br",{}),e.jsx("label",{htmlFor:"location",children:"Location: "}),e.jsx("select",{name:"location",id:"location",onChange:t=>{y(s==null?void 0:s.locations.find(n=>n.name==t.target.value))},children:s==null?void 0:s.locations.map((t,n)=>e.jsx("option",{value:t.name,selected:(S==null?void 0:S.name)==t.name,children:t.name+" ("+t.address+")"},n))}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=ae.current)==null||t.showModal()},children:"Add New Location"}),e.jsx("br",{}),e.jsx("label",{htmlFor:"eventType",children:"Event Type: "}),e.jsx("select",{name:"eventType",id:"event-type",onChange:t=>{O(s==null?void 0:s.eventTypes.find(n=>n.name==t.target.value))},children:s==null?void 0:s.eventTypes.map((t,n)=>e.jsx("option",{value:t.name,selected:(w==null?void 0:w.name)==t.name,children:t.name},n))}),e.jsx("br",{}),e.jsx("label",{htmlFor:"inviteType",children:"Invite Type: "}),e.jsxs("select",{name:"inviteType",id:"invite-type",onChange:t=>{Q(t.target.value)},children:[e.jsx("option",{value:"students",selected:C=="students",children:"Students"}),e.jsx("option",{value:"parents",selected:C=="parents",children:"Parents"}),e.jsx("option",{value:"groups",selected:C=="groups",children:"Groups"}),e.jsx("option",{value:"custom",selected:C=="custom",children:"Custom"})]}),C=="groups"?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("label",{htmlFor:"groups",children:"Groups: "}),e.jsx("div",{className:"groups",children:s.groups.map((t,n)=>e.jsxs("div",{className:"group",children:[e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",id:"ensemble",checked:A.find(a=>a.groupName==t.groupName)!=null,onChange:a=>{a.target.checked?(R([...A,t]),G([...H,...t.groupMembers])):(R(A.filter(d=>d.groupName!=t.groupName)),G(H.filter(d=>!t.groupMembers.includes(d))))}}),e.jsx("span",{className:"checkmark",children:" "})]}),e.jsx("label",{htmlFor:t.groupName,children:t.groupName})]},t.groupName))})]}):e.jsx(e.Fragment,{}),C=="custom"?Te():e.jsx(e.Fragment,{}),e.jsx("br",{}),e.jsx("br",{}),Se?e.jsx("div",{className:"loader"}):e.jsx("button",{onClick:async()=>{if(Z(!0),console.log(`Name: ${L}, Description: ${T}, Start Time: ${i}, End Time: ${D}, Selected Location: ${S},Event Type: ${w}`),L==""||i==null||D==null||S==null||w==null){alert("Please fill out all fields"),console.log(`Name: ${L}, Description: ${T}, Start Time: ${i}, End Time: ${D}, Selected Location: ${S},  Event Type: ${w}`),Z(!1);return}console.log("Submit");const t=S??s.locations[0];console.log(i),console.log(D);const n=[],a=Le();if(a.length==0){Z(!1);return}for(const d of a){const o=w;o.color.setAlpha(255);const g=me.fromBlank(L,T,t,d,"activity-event",Date.now(),M,A.map(de=>de.groupName),H,C,o,A,fe,ve,[],s.name);await pe(g);const h=g.date.from,Y=g.date.to;h.setDate(g.date.date.getDate()),h.setMonth(g.date.date.getMonth()),h.setFullYear(g.date.date.getFullYear()),Y.setDate(g.date.date.getDate()),Y.setMonth(g.date.date.getMonth()),Y.setFullYear(g.date.date.getFullYear());const V={title:g.name,start:h.toISOString(),end:Y.toISOString(),isAllDay:!1,interactive:!0,description:g.info,color:g.eventType.color.setAlpha(.8).toRBGAString(),id:g.id,location:g.location.name};n.push(V),k([...v,g])}B([...N,...n]),Z(!1),l("date"),u(null),p(null),I(null),b(""),j(""),E(""),K(""),O(s==null?void 0:s.eventTypes[0]),y(s==null?void 0:s.defaultLocation),G([]),Q("students")},className:"ActionBtn",children:_?"Save":"Submit"}),e.jsx("button",{onClick:()=>{if(_){l("date"),u(null),p(null),I(null),b(""),j(""),E(""),K(""),y(s.defaultLocation),O(s.eventTypes[0]),y(s==null?void 0:s.defaultLocation),se(!1);return}l("date"),j(""),b(""),Q("students")},className:"ActionBtn",children:"Back"})]})}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"page-title",children:[e.jsx("img",{src:We,alt:"back arrow",onClick:()=>{if(c!="date"){if(l("date"),_){l("date"),u(null),p(null),I(null),b(""),j(""),E(""),K(""),y(s.defaultLocation),O(s.eventTypes[0]),y(s==null?void 0:s.defaultLocation),se(!1);return}l("date"),j(""),b(""),Q("students");return}window.location.href="/Activity/?activityId="+M}}),e.jsx("h1",{children:"Events"})]}),W?e.jsx("div",{className:"center",children:e.jsx("div",{className:"loader"})}):e.jsxs("div",{className:"center",children:[e.jsxs("div",{className:c!="date"?"datePicker hidden":"datePicker",children:[" ",e.jsx(Ce,{canPaste:$!=null,canCopy:!0,copyEvent:t=>{const n=v.find(a=>a.id==t.id);for(const a of v)console.log(a.id);ye(n),console.log(n),console.log(t.id)},pasteEvent:t=>{console.log("PASTE EVENT"),console.log(t);const n=new Date(t);n.setHours(0,0,0,0),u(n),p(new Date($.date.from)),E($.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const a=new Date($.date.to);I(a),console.log(a),K(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),y($.location),O($.eventType),b($.name),j($.info),G($.targets),Q($.generalTarget),R($.groupTargets),l("info")},canViewConflicts:!1,isCreating:!0,canOpenContextMenu:!0,events:N,editEvent:t=>{const n=Ne().find(a=>a.id==t.id);console.log(t.id),n&&(console.log(n),l("info"),b(n.name),j(n.info),u(n.date.date),p(n.date.from),E(n.date.from.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),I(n.date.to),K(n.date.to.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),y(n.location),G(n.targets),console.log("FROM EDIT"),console.log(n.targets),O(n.eventType),se(!0),Q(n.generalTarget),we(n),R(n.groupTargets))},viewEvent:t=>{const n=Ne().find(a=>a.id==t.id);n&&(localStorage.setItem("event",JSON.stringify(n.toMap())),localStorage.setItem("back","/Activity/Events/?activityId="+M),window.location.href="/Calendar/Event/")},viewConflicts:t=>{},deleteEvent:async t=>{console.log(t);const n=v.find(o=>o.id==t.id),a=v.filter(o=>o.id!=t.id);k(a);const d=N.filter(o=>o.id!=t.id);B(d),await Ge(n)},dateClick:t=>{console.log(t.date),u(t.date),new Date(t.date).setHours(0,0,0,0),p(new Date(t.date)),E(t.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const a=new Date(t.date);I(a.addHours(1)),console.log(a),K(t.date.addHours(1).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),y(s.defaultLocation),O(s.eventTypes[0]),l("info")},eventClick:t=>{u(t.event.start),new Date(t.event.start).setHours(0,0,0,0),p(new Date(t.event.start)),E(t.event.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}));const a=new Date(t.event.end);I(a),K(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})),y(s.defaultLocation),O(s.eventTypes[0]),l("info")}}),e.jsx("button",{className:"ActionBtn",onClick:()=>{l("multipleEvents"),O(s.eventTypes[0])},children:"Add Multiple Events"}),e.jsx("button",{className:"ActionBtn",onClick:t=>{l("recurringEvent"),O(s.eventTypes[0])},children:"Add Recurring Event"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{localStorage.setItem("events",JSON.stringify(v.map(t=>t.toMap()))),window.open("/Activity/Events/Print/","_blank")},children:"Print"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=xe.current)==null||t.showModal()},children:"Export to CSV"}),e.jsx("button",{className:"ActionBtn",onClick:()=>{var t;(t=je.current)==null||t.showModal()},children:"Import from CSV"})]}),X=="teacher"?c=="multipleEvents"?Be():c=="date"?e.jsx(e.Fragment,{}):c=="recurringEvent"?Me():Ie():e.jsxs(e.Fragment,{children:[" ",e.jsx(Ce,{canPaste:!1,canCopy:!1,copyEvent:()=>{},pasteEvent:()=>{},viewEvent:t=>{},canViewConflicts:!1,events:N,canOpenContextMenu:!1,dateClick:()=>{},deleteEvent:()=>{},viewConflicts:()=>{},editEvent:()=>{},eventIdClick:t=>{const n=v.find(a=>a.id===t);n&&(localStorage.setItem("event",JSON.stringify(n.toMap())),localStorage.removeItem("back"),window.location.href="/Calendar/Event/")}})," ",e.jsx("button",{className:"ActionBtn",onClick:()=>{localStorage.setItem("events",JSON.stringify(v.map(t=>t.toMap()))),window.open("/Activity/Events/Print/","_blank")},children:"Print"})]})]}),e.jsx($e,{dialogRef:he,addDate:t=>{Ee([...ce,t]),he.current.close()},close:()=>{he.current.close()},eventDate:ke}),s!=null&&e.jsx(Ze,{dialogRef:xe,events:v,close:()=>{xe.current.close()},activity:s}),s!=null&&e.jsx(Xe,{activity:s,dialogRef:je,close:()=>{je.current.close()},addEvents:async t=>{const n=[];for(const a of t){await pe(a);const d=a.date.from,o=a.date.to;d.setDate(a.date.date.getDate()),d.setMonth(a.date.date.getMonth()),d.setFullYear(a.date.date.getFullYear()),o.setDate(a.date.date.getDate()),o.setMonth(a.date.date.getMonth()),o.setFullYear(a.date.date.getFullYear());const g={title:a.name,start:d.toISOString(),end:o.toISOString(),isAllDay:!1,interactive:!0,description:a.info,color:a.eventType.color.setAlpha(.8).toRBGAString(),id:a.id,location:a.location.name};n.push(g),k([...v,a])}B([...N,...n])}}),e.jsx(Ue,{existingLocations:(s==null?void 0:s.locations)??[],dialogRef:ae,addLocation:async t=>{const n=Pe.fromMap(s.toMap());n.locations.push(t),x(n),y(t),await He(M,t),ae.current.close()},close:()=>{ae.current.close()},savedLocations:[]})]})}
