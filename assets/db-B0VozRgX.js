import{w as ut,x as i,y as c,z as T,r as P,g as N,B as A,H as p,d as X,f as F,I as v,J as S,K as D,k as B,N as L,o as $,O as H,S as Y,T as dt,P as J,Q as ht,U as O,u as ft,s as k,V as W,W as Z,M as j,X as nt,Y as gt,Z as R,q as b,p as mt,L as pt}from"./constants-B2y1av-g.js";import{h as yt,C as It,k as tt,_ as vt,d as K,e as wt,f as St,F as Dt,n as at,p as Tt,g as U}from"./index-BrfWEQze.js";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mt="type.googleapis.com/google.protobuf.Int64Value",At="type.googleapis.com/google.protobuf.UInt64Value";function ct(e,t){const o={};for(const s in e)e.hasOwnProperty(s)&&(o[s]=t(e[s]));return o}function V(e){if(e==null)return null;if(e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&isFinite(e)||e===!0||e===!1||Object.prototype.toString.call(e)==="[object String]")return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(t=>V(t));if(typeof e=="function"||typeof e=="object")return ct(e,t=>V(t));throw new Error("Data cannot be encoded in JSON: "+e)}function _(e){if(e==null)return e;if(e["@type"])switch(e["@type"]){case Mt:case At:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(t=>_(t)):typeof e=="function"||typeof e=="object"?ct(e,t=>_(t)):e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const et={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class E extends Dt{constructor(t,o,s){super(`${z}/${t}`,o||""),this.details=s}}function Ct(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function kt(e,t){let o=Ct(e),s=o,n;try{const a=t&&t.error;if(a){const r=a.status;if(typeof r=="string"){if(!et[r])return new E("internal","internal");o=et[r],s=r}const l=a.message;typeof l=="string"&&(s=l),n=a.details,n!==void 0&&(n=_(n))}}catch{}return o==="ok"?null:new E(o,s,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(t,o,s){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=o.getImmediate({optional:!0}),this.auth||t.get().then(n=>this.auth=n,()=>{}),this.messaging||o.get().then(n=>this.messaging=n,()=>{}),this.appCheck||s.get().then(n=>this.appCheck=n,()=>{})}async getAuthToken(){if(this.auth)try{const t=await this.auth.getToken();return t==null?void 0:t.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.appCheck){const o=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return o.error?null:o.token}return null}async getContext(t){const o=await this.getAuthToken(),s=await this.getMessagingToken(),n=await this.getAppCheckToken(t);return{authToken:o,messagingToken:s,appCheckToken:n}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q="us-central1";function Nt(e){let t=null;return{promise:new Promise((o,s)=>{t=setTimeout(()=>{s(new E("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}class Ut{constructor(t,o,s,n,a=q,r){this.app=t,this.fetchImpl=r,this.emulatorOrigin=null,this.contextProvider=new Et(o,s,n),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(a);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=q}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(t){const o=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${o}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${o}.cloudfunctions.net/${t}`}}function bt(e,t,o){e.emulatorOrigin=`http://${t}:${o}`}function Ft(e,t,o){return s=>Pt(e,t,s,{})}async function Rt(e,t,o,s){o["Content-Type"]="application/json";let n;try{n=await s(e,{method:"POST",body:JSON.stringify(t),headers:o})}catch{return{status:0,json:null}}let a=null;try{a=await n.json()}catch{}return{status:n.status,json:a}}function Pt(e,t,o,s){const n=e._url(t);return Ot(e,n,o,s)}async function Ot(e,t,o,s){o=V(o);const n={data:o},a={},r=await e.contextProvider.getContext(s.limitedUseAppCheckTokens);r.authToken&&(a.Authorization="Bearer "+r.authToken),r.messagingToken&&(a["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(a["X-Firebase-AppCheck"]=r.appCheckToken);const l=s.timeout||7e4,d=Nt(l),u=await Promise.race([Rt(t,n,a,e.fetchImpl),d.promise,e.cancelAllRequests]);if(d.cancel(),!u)throw new E("cancelled","Firebase Functions instance was deleted.");const h=kt(u.status,u.json);if(h)throw h;if(!u.json)throw new E("internal","Response is not valid JSON object.");let m=u.json.data;if(typeof m>"u"&&(m=u.json.result),typeof m>"u")throw new E("internal","Response is missing data field.");return{data:_(m)}}const ot="@firebase/functions",st="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _t="auth-internal",Lt="app-check-internal",xt="messaging-internal";function Gt(e,t){const o=(s,{instanceIdentifier:n})=>{const a=s.getProvider("app").getImmediate(),r=s.getProvider(_t),l=s.getProvider(xt),d=s.getProvider(Lt);return new Ut(a,r,l,d,n,e)};yt(new It(z,o,"PUBLIC").setMultipleInstances(!0)),tt(ot,st,t),tt(ot,st,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(e=St(),t=q){const s=vt(K(e),z).getImmediate({identifier:t}),n=wt("functions");return n&&$t(s,...n),s}function $t(e,t,o){bt(K(e),t,o)}function it(e,t,o){return Ft(K(e),t)}Gt(fetch.bind(self));const rt=Bt(at),f=ut(at),Ht=i(f,"schools"),qt=async()=>{const e=await v(Ht),t=[];return e.forEach(o=>{t.push(o.data())}),t},Xt=async()=>{const e=localStorage.getItem("accountType"),t=localStorage.getItem("schoolId");if(!t)return[];const o=c(f,"schools",t);if(e=="student"){const s=S(i(o,"activities"),D("studentUids","array-contains",U())),n=[];return(await v(s)).forEach(r=>{n.push(N.fromMap(r.data()))}),n}else{const s=S(i(o,"activities"),D("teacherUids","array-contains",U())),n=[];return(await v(s)).forEach(r=>{console.log(r.data()),n.push(N.fromMap(r.data()))}),n}};async function Yt(e){const t=localStorage.getItem("schoolId");if(!t)return null;const o=c(f,"schools",t),s=c(i(o,"activities"),e),n=await T(s);return n.exists()?n.data().type=="theater"?P.fromMap(n.data()):N.fromMap(n.data()):null}async function Kt(e){const t=localStorage.getItem("schoolId");if(!t)return"";const o=c(f,"schools",t),s=c(i(o,"activities"),e.activityId),n=i(s,"shows"),a=await A(n,e.toMap());return e.id=a.id,await p(a,{id:a.id}),a.id}async function zt(e){const t=localStorage.getItem("schoolId");if(!t)return;const o=c(f,"schools",t),s=c(i(o,"activities"),e.activityId),n=c(i(s,"shows"),e.id);await p(n,e.toMap())}async function Qt(e){await Tt("cmurphy@gmail.com","123456");const t=i(f,"showTemplates"),o=await A(t,e.toMap());e.id=o.id,await p(o,{id:o.id})}async function Wt(e,t){const o=localStorage.getItem("schoolId");if(!o)return null;const s=c(f,"schools",o),n=c(i(s,"activities"),e),a=c(i(n,"shows"),t),r=await T(a);return r.exists()?(console.log(r.data()),X.fromMap(r.data())):null}async function Zt(e){const t=localStorage.getItem("schoolId");if(!t)return[];console.log("Getting actors for activity "+t);const o=c(f,"schools",t),s=c(i(o,"activities"),e),n=await T(s);if(!n.exists())return[];const a=[];return n.data().students.forEach(r=>{a.push(F.fromMap(r))}),a}async function te(e,t,o){const s=localStorage.getItem("schoolId");if(!s)return;const n=c(f,"schools",s),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t);await L(r,o.toMap())}async function ee(e){const t=localStorage.getItem("schoolId");if(!t)return;const o=c(f,"schools",t),s=c(i(o,"activities"),e.activityId),n=i(s,"events"),a=await A(n,e.toMap());e.id=a.id,await p(a,{id:a.id})}async function oe(e,t){const o=localStorage.getItem("schoolId"),s=localStorage.getItem("accountType");if(!o)return[];const n=c(f,"schools",o),a=c(i(n,"activities"),e),r=i(a,"events");if(s=="student"){const l=await v(S(r,D("showId","==",t),D("targetUids","array-contains",U()))),d=[];return l.forEach(u=>{u.data().deleted||d.push(B.fromMap(u.data()))}),d}else{const l=await v(S(r,D("showId","==",t))),d=[];return l.forEach(u=>{u.data().deleted||d.push(B.fromMap(u.data()))}),d}}async function se(e){const t=localStorage.getItem("schoolId");if(!t)return;const o=c(f,"schools",t),s=c(i(o,"activities"),e.activityId),n=c(i(s,"events"),e.id);await p(n,{deleted:!0}),await it(rt,"startDeleteActivityEvent")({activityId:e.activityId,eventId:e.id,schoolId:t})}async function ne(e){const t=localStorage.getItem("schoolId");if(!t)return[];const o=c(f,"schools",t),s=c(i(o,"activities"),e),n=i(s,"shows"),a=await v(n),r=[];return a.forEach(l=>{r.push(X.fromMap(l.data()))}),r}async function ae(e,t,o){const s=localStorage.getItem("schoolId");if(!s)return;const n=c(f,"schools",s),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t);await p(r,{conflictForm:o.toMap()}),await it(rt,"addConflictFormDeadline")({activityId:e,showId:t,schoolId:s,deadline:o.deadline.toISOString()})}async function ce(){const e=await U(),t=localStorage.getItem("schoolId");if(!t)return null;const o=c(f,"schools",t),s=i(o,"students"),n=c(s,e),a=await T(n);return a.exists()?F.fromMap(a.data()):null}async function ie(e,t,o){const s=localStorage.getItem("schoolId");if(!s)return;const n=c(f,"schools",s),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t),l=c(r,"conflictResponses",o.actor.userId);o.id=o.actor.userId,await L(l,o.toMap())}async function re(e,t){const o=localStorage.getItem("schoolId"),s=localStorage.getItem("accountType");if(!o)return[];const n=c(f,"schools",o),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t),l=i(r,"conflictResponses");if(s=="student"){console.log("Getting conflict responses for student"),console.log(U());const h=await v(S(l,D("submitterId","==",U()))),m=[];return h.forEach(y=>{m.push($.fromMap(y.data()))}),m}const d=await v(l),u=[];return d.forEach(h=>{u.push($.fromMap(h.data()))}),u}async function le(){const e=i(f,"showTemplates"),t=await v(e),o=[];return t.forEach(s=>{o.push(X.fromMap(s.data()))}),o}async function ue(e){const t=localStorage.getItem("schoolId"),o=localStorage.getItem("userId"),s=localStorage.getItem("accountType");if(console.log("SC: "+t+" UID: "+o+" AT: "+s),!t||!o||!s)return null;const n=c(f,"schools",t),a=S(i(n,"activities"),D("joinCode","==",e)),r=await v(a);if(r.empty)return null;const l=r.docs[0],d=c(i(n,s=="student"?"students":"teachers"),o),u=await T(d);if(console.log(u.data()),!u.exists())return null;if(l.data().type=="theater"){if((u.data().gender==null||u.data().gender=="")&&s=="student"&&(console.log("needsGender"),localStorage.setItem("needsGender","true")),u.data().phoneNumber==""&&s=="student"&&localStorage.setItem("needsPhoneNumber","true"),(u.data().phoneNumber==""||u.data().gender==null||u.data().gender=="")&&s=="student")return null;if(s=="student")return await p(l.ref,{studentUids:[...l.data().studentUids,o],students:[...l.data().students,F.fromMap(u.data()).toMap()]}),P.fromMap(l.data());{console.log("Joining as teacher"),console.log(u.data());const h=O.fromBlank(u.data().fullname,u.data().email,u.data().phoneNumber,u.data().uid,u.data().FCMToken);return console.log(h.toMap()),await p(l.ref,{teacherUids:[...l.data().teacherUids,o],teachers:[...l.data().teachers,h.toMap()]}),P.fromMap(l.data())}}else if(s=="student"){const h=F.fromBlank(u.data().fullname,u.data().gender,u.data().email,u.data().phoneNumber,u.data().uid,u.data().FCMToken);return await p(l.ref,{studentUids:[...l.data().studentUids,o],students:[...l.data().students,h.toMap()]}),N.fromMap(l.data())}else{const h=O.fromBlank(u.data().fullname,u.data().email,u.data().phoneNumber,u.data().uid,u.data().FCMToken);return await p(l.ref,{teacherUids:[...l.data().teacherUids,o],teachers:[...l.data().teachers,h.toMap()]}),N.fromMap(l.data())}}async function de(e){const t=localStorage.getItem("schoolId"),o=localStorage.getItem("userId"),s=localStorage.getItem("accountType");if(!t||!o||!s)return;const n=c(f,"schools",t),a=c(i(n,s=="student"?"students":"teachers"),o);await p(a,{gender:e})}async function he(e){const t=localStorage.getItem("schoolId"),o=localStorage.getItem("userId"),s=localStorage.getItem("accountType");if(!t||!o||!s)return;const n=c(f,"schools",t),a=c(i(n,s=="student"?"students":"teachers"),o);await p(a,{phoneNumber:e})}async function fe(e){const t=localStorage.getItem("schoolId");if(!t)return;const o=c(f,"schools",t),s=c(i(o,"activities"),e.activityId),n=c(i(s,"events"),e.id);await p(n,e.toMap())}async function ge(){const e=localStorage.getItem("schoolId"),t=localStorage.getItem("userId"),o=localStorage.getItem("accountType");if(!e||!t)return[];const s=c(f,"schools",e),n=[];let a;o=="student"?a=await v(S(i(s,"activities"),D("studentUids","array-contains",t))):a=await v(S(i(s,"activities"),D("teacherUids","array-contains",t))),console.log(a);for(const r of a.docs){let l;o=="student"?l=await v(S(i(r.ref,"events"),D("targetUids","array-contains",t))):l=await v(i(r.ref,"events"));for(const d of l.docs){const u=d.data();console.log(u),u.type=="activity-theater-event"?n.push(B.fromMap(u)):n.push(ft.fromMap(u))}}return n}async function me(e,t){const o=localStorage.getItem("schoolId"),s=localStorage.getItem("userId");if(!o||!s)return null;const n=c(f,"schools",o),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t),l=i(r,"conflictResponses"),d=await T(c(l,s));return d.exists()?$.fromMap(d.data()):null}async function pe(e,t){const o=localStorage.getItem("schoolId");if(!o)return;const s=c(f,"schools",o),n=c(i(s,"activities"),e);await p(n,{rehearsalLocations:t.map(a=>a.toMap())})}async function ye(e,t){const o=localStorage.getItem("schoolId"),s=localStorage.getItem("userId");if(!o||!s)return[];const n=localStorage.getItem("accountType"),a=c(f,"schools",o),r=c(i(a,"activities"),e);if(n=="teacher")H(i(r,"groupChats"),async l=>{const d=[];for(const u of l.docs){const h=k.fromMap(u.data());if((h.generalTarget=="direct"||h.generalTarget=="custom")&&!h.members.find(w=>w.name==s))continue;if(h.generalTarget=="direct"){const w=h.members.find(I=>I.name!=s);h.name=(w==null?void 0:w.name)||"Unknown"}const m=i(u.ref,"messages"),y=S(m,Z("timeSent","desc"),W(1)),g=await v(y);g.empty||(h.lastMessage=j.fromMap(g.docs[0].data())),d.push(h)}d.sort((u,h)=>u.lastMessage?h.lastMessage?h.lastMessage.timeSent.getTime()-u.lastMessage.timeSent.getTime():-1:1),t(d)});else{const l=c(i(a,"students"),s),d=await T(l);if(!d.exists())return;const u=Y.fromMap(d.data());console.log(u),H(i(r,"groupChats"),async h=>{const m=[];for(const y of h.docs){const g=k.fromMap(y.data());if(!(g.generalTarget=="everyone"||g.generalTarget=="students")&&(g.generalTarget=="parents"||!g.members.find(M=>M.name==s)))continue;if(g.generalTarget=="direct"){const M=g.members.find(x=>x.name!=s);g.name=(M==null?void 0:M.name)||"Unknown"}const w=i(y.ref,"messages"),I=S(w,Z("timeSent","desc"),W(1)),C=await v(I);C.empty||(g.lastMessage=j.fromMap(C.docs[0].data())),m.push(g)}m.sort((y,g)=>y.lastMessage?g.lastMessage?g.lastMessage.timeSent.getTime()-y.lastMessage.timeSent.getTime():-1:1),t(m)})}}async function Ie(e,t,o){const s=localStorage.getItem("schoolId");if(!s)return[];const n=c(f,"schools",s),a=c(i(n,"activities"),e);console.log("Getting messages for "+t);const r=c(i(a,"groupChats"),t),l=i(r,"messages");H(l,d=>{const u=[];d.forEach(h=>{u.push(j.fromMap(h.data()))}),u.sort((h,m)=>h.timeSent.getTime()-m.timeSent.getTime()),o(u)})}async function Q(){const e=localStorage.getItem("schoolId"),t=localStorage.getItem("userId"),o=localStorage.getItem("accountType");if(!e||!t)return null;const s=c(f,"schools",e),n=c(i(s,o=="student"?"students":"teachers"),t),a=await T(n);return a.exists()?o=="student"?Y.fromMap(a.data()):dt.fromMap(a.data()):null}async function ve(e,t,o,s){const n=localStorage.getItem("schoolId"),a=localStorage.getItem("userId");if(!n||!a)return;const r=c(f,"schools",n),l=c(i(r,"activities"),e),d=c(i(l,"groupChats"),t);if(!(await T(d)).exists()){if(s==null)return;const y=await Q();if(!y)return;const g=k.fromBlank("",s.userId,[nt.fromBlank(y.fullname,y.email,y.phoneNumber,y.FCMToken,y.uid),s],"direct",e,Date.now());await L(d,g.toMap());const w=i(d,"messages"),I=await A(w,o.toMap());o.messageId=I.id,await p(I,{messageId:I.id});return}const h=i(d,"messages"),m=await A(h,o.toMap());o.messageId=m.id,await p(m,{messageId:m.id})}async function G(e){const t=localStorage.getItem("schoolId");if(!t)return;const o=c(f,"schools",t),s=c(i(o,"activities"),e.activityId),n=i(s,"groupChats"),a=await Q();if(!a)return;const r=nt.fromBlank(a.fullname,a.email,a.phoneNumber,a.FCMToken,a.uid);e.members.push(r);const l=await A(n,e.toMap());e.id=l.id,await p(l,{id:l.id})}async function we(e,t,o){const s=localStorage.getItem("schoolId");if(!s)return;const n=c(f,"schools",s),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t);p(r,{resources:J(o.toMap())})}async function Se(e,t,o){const s=localStorage.getItem("schoolId");if(!s)return;const n=c(f,"schools",s),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t);p(r,{resources:gt(o.toMap())})}async function De(e,t,o){const s=localStorage.getItem("schoolId");if(!s)return;const n=c(f,"schools",s),a=c(i(n,"activities"),e),r=c(i(a,"shows"),t),l=i(r,"conflictResponses"),d=c(l,o.id);await ht(d)}async function Te(e,t){const o=localStorage.getItem("schoolId");if(!o)return;const s=c(f,"schools",o),n=i(s,e+"s");await L(c(n,t.uid),t.toMap());let a;t instanceof Y?a=F.fromBlank(t.fullname,t.gender,t.email,t.phoneNumber,t.FCMToken,t.uid):a=O.fromBlank(t.fullname,t.email,t.phoneNumber,t.FCMToken,t.uid),await p(s,{[e+"Uids"]:J(t.uid),[e+"s"]:J(a.toMap())})}function Jt(e){const t=new Date,o=t.getTime().toString();return`${e.charCodeAt(0)}${t.getDate()}${o.slice(-2)}`}async function Me(e,t){const o=localStorage.getItem("schoolId");if(!o)return null;const s=c(f,"schools",o),n=await T(s);if(!n.exists())return null;const a=n.data(),r=i(s,"activities"),l=Jt(e),d=[R.fromMap({name:"Rehearsal",color:b("#FF0000")}),R.fromMap({name:"Performance",color:b("#00FF00")})],u=[R.fromMap({name:"Practice",color:b("#FF0000")}),R.fromMap({name:"Game",color:b("#00FF00")})],h=[mt.fromMap({name:"Auditorium",color:b("#0000FF")})],m=pt.fromMap(a.location),y=[m],g=await Q();if(!g)return null;const w=O.fromBlank(g.fullname,g.email,g.phoneNumber,g.FCMToken,g.uid);let I;t=="theater"?I=P.fromBlank(e,"",l,[],[],[],[w],y,d,m,h,"type",Date.now()):I=N.fromBlank(e,"",l,[],[],[],[w],y,u,m,"type",Date.now(),"activity");const C=await A(r,I.toMap());I.id=C.id,await p(C,{id:C.id});const M=k.fromMap({name:"Everyone",members:[],id:"",activityId:I.id,lastUpdated:Date.now(),generalTarget:"everyone"});await G(M);const x=k.fromMap({name:"Parents",members:[],id:"",activityId:I.id,lastUpdated:Date.now(),generalTarget:"parents"});await G(x);const lt=k.fromMap({name:"Students",members:[],id:"",activityId:I.id,lastUpdated:Date.now(),generalTarget:"students"});return await G(lt),I}export{me as A,pe as B,G as C,ve as D,Ie as E,ye as F,Q as G,we as H,Se as I,de as a,Me as b,Te as c,Xt as d,Yt as e,ne as f,qt as g,le as h,Kt as i,ue as j,Qt as k,zt as l,Wt as m,Zt as n,re as o,oe as p,se as q,fe as r,te as s,ee as t,he as u,ae as v,De as w,ce as x,ie as y,ge as z};
